(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-27e89037"],{"012a":function(t,e,a){(t.exports=a("2350")(!1)).push([t.i,".primary-color[data-v-0d5b92f0]{color:#1740dc}.success-color[data-v-0d5b92f0]{color:#52c41a}.warning-color[data-v-0d5b92f0]{color:#faad14}.error-color[data-v-0d5b92f0]{color:#f5222d}.info-color[data-v-0d5b92f0]{color:#909399}.border-color[data-v-0d5b92f0]{border:1px solid #e5e6e9}.dataRelationship[data-v-0d5b92f0]{height:459px;overflow-y:scroll}.dataRelationship .self_for[data-v-0d5b92f0]{background:#1740dc}.dataRelationship .father_for[data-v-0d5b92f0],.dataRelationship .self_for[data-v-0d5b92f0]{width:140px;height:48px;line-height:48px;color:#fff;border-radius:20px}.dataRelationship .father_for[data-v-0d5b92f0]{background:#f56c6c}.dataRelationship .son_for[data-v-0d5b92f0]{background:#e6a23c;width:140px;height:48px;line-height:48px;color:#fff;border-radius:20px}.dataRelationship .path_type[data-v-0d5b92f0]{stroke:#909399;stroke-width:2px;fill:none}.dataRelationship .table_name[data-v-0d5b92f0]{overflow:hidden;text-overflow:ellipsis;padding:0 8px;text-align:center}",""])},"2d2c":function(t,e,a){"use strict";a("7f7f");var i=a("f121"),o=(a("4360"),i.a.apiUrl,{data:function(){return{upLoading:!1,form:{region:"",name:"",file:"",writeType:1},limitNum:2,sites:[],partitions:"",fileList:[],rules:{},flag:this.$route.query.from}},inject:["tableId"],methods:{exceedFile:function(t,e){this.$notify.warning({title:"警告",message:"只能选择 ".concat(this.limitNum," 个文件，当前共选择了 ").concat(t.length+e.length," 个")})},fileChange:function(t,e){!1===this.beforeUploadFile(t,e)&&(e.length>1?e.splice(1,2):e.splice(0,1)),e.length>1&&e.splice(0,1),this.fileList=e,this.form.file=t.raw},handleRemove:function(t,e){this.fileList=e},beforeUploadFile:function(t){var e,a=t.name.substring(t.name.lastIndexOf(".")+1),i=t.size/1024/1024;return null==(null===(e=this.$store.state.old.tableInfo)||void 0===e?void 0:e.format)&&"txt"!==a?(this.$message({message:"只能上传txt文件",type:"warning"}),!1):"txt"!==a&&"parquet"!==a&&"json"!==a&&"csv"!==a?(this.$message({message:"只能上传txt,parquet,csv,json的文件",type:"warning"}),!1):i>100?(this.$message({message:"文件大小不得超过100M",type:"warning"}),!1):void 0},handleSuccess:function(t,e,a){this.$message({message:"上传成功！",type:"success"})},handleError:function(t,e,a){this.$message.error("文件上传失败")},getDataTablePartition:function(){var t=this;this.$API.get(this.$URL.getTableInfoPartitions+this.tableId,{},(function(e){if(0==e.code)for(var a=0;a<e.data.length;a++)t.sites.push({fieldName:e.data[a].fieldName,value:""});else t.$message.error(e.msg)}))},uploadFile:function(){var t=this;if(0==this.fileList.length)return this.$message.error("请选择要上传的文件！"),!1;this.partitions="";for(var e=0;e<this.sites.length;e++){if(!this.sites[e].value)return this.$message.error("数据分区左侧分区值不能为空！"),!1;this.partitions+=this.sites[e].fieldName+"="+this.sites[e].value+"/"}this.upLoading=!0;var a=new FormData;a.append("file",this.form.file),a.append("writeType",this.form.writeType),a.append("partitions",this.partitions),a.append("tableId",this.tableId),a.append("flag","data-warehouse"===this.$route.query.from?1:0);var i=a;this.$API.file(this.$URL.getTableInfoUploadFile,i,(function(e){t.upLoading=!1,t.fileList=[],0==e.code?t.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){}}):t.$message.error(e.msg)}))}},computed:{tableId:function(){return this.$route.query.tableId},format:function(){var t;return(null===(t=this.$store.state.old.tableInfo)||void 0===t?void 0:t.format)||"text"}},mounted:function(){this.getDataTablePartition()}}),s=(a("9667"),a("2877")),l=Object(s.a)(o,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"uploaddata"},[e("el-form",{ref:"form",attrs:{"label-width":"80px","label-position":"left",rules:t.rules}},[t.sites.length?e("el-form-item",{attrs:{label:"数据分区"}},[e("ul",{staticClass:"partition"},t._l(t.sites,(function(a,i){return e("li",{key:i},[e("el-input",{attrs:{disabled:""},model:{value:a.fieldName,callback:function(e){t.$set(a,"fieldName",e)},expression:"site.fieldName"}}),t._v("="),e("el-input",{attrs:{placeholder:"输入分区值"},model:{value:a.value,callback:function(e){t.$set(a,"value",e)},expression:"site.value"}})],1)})),0)]):t._e(),e("el-form-item",{attrs:{label:"上传文件"}},[e("el-upload",{ref:"uploadFile",attrs:{action:"null",limit:t.limitNum,"auto-upload":!1,accept:".txt,.json,.csv,.parquet","before-upload":t.beforeUploadFile,"on-change":t.fileChange,"on-remove":t.handleRemove,"on-exceed":t.exceedFile,"on-success":t.handleSuccess,"on-error":t.handleError,"file-list":t.fileList}},[e("el-button",{attrs:{size:"small",plain:""}},[t._v("选择文件")]),e("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("\n          只能上传"+t._s(t.format)+"格式文件"),e("br"),t._v("且文件格式与数据表格式一致,一条数据占一行\n        ")])],1)],1),e("el-form-item",{attrs:{label:"写入方式"}},[e("el-radio-group",{model:{value:t.form.writeType,callback:function(e){t.$set(t.form,"writeType",e)},expression:"form.writeType"}},[e("el-radio",{attrs:{label:1}},[t._v("覆盖")]),e("el-radio",{attrs:{label:2}},[t._v("追加")])],1)],1),e("el-form-item",[e("el-button",{attrs:{size:"small",type:"primary",loading:t.upLoading},on:{click:t.uploadFile}},[t._v("立即上传")])],1)],1)],1)}),[],!1,null,"7afb9ad6",null);e.a=l.exports},"2ff0":function(t,e,a){"use strict";a("7f7f"),a("ac4d"),a("8a81"),a("5df3"),a("1c4c"),a("6b54");function i(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return o(t,e)}(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var i=0,s=function(){};return{s:s,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,n=!0,r=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return n=t.done,t},e:function(t){r=!0,l=t},f:function(){try{n||null==a.return||a.return()}finally{if(r)throw l}}}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,i=new Array(e);a<e;a++)i[a]=t[a];return i}var s={data:function(){return{fatherTables:[],mySelfTable:[],sonTables:[],tables:0,fatherPositionList:[],sonPositionList:[],selfPosition:{}}},inject:["tableId"],computed:{fatherTopY:function(){var t=this.fatherTables.length-1;return(48*t+12*t)/2},sonTopY:function(){var t=this.sonTables.length-1;return(48*t+12*t)/2}},methods:{getBloodRelationInfo:function(){var t=this;this.$API.get(this.$URL.getTableInfoBloodRelation+(this.$route.query.id||this.tableId),{},(function(e){if(0==e.code){t.fatherTables=[],t.mySelfTable=[],t.sonTables=[];for(var a=e.page,i=0;i<a.length;i++)1==a[i].type?t.fatherTables.push(a[i]):2==a[i].type?t.mySelfTable.push(a[i]):3==a[i].type&&t.sonTables.push(a[i]),t.getFatherPositionList(),t.getSelfPosition(),t.getSonPositionList()}else t.$message.error(e.msg)}))},getFatherPositionList:function(){this.fatherPositionList=[];var t=document.querySelectorAll(".father");if(t&&t.length>0){var e,a=i(t);try{for(a.s();!(e=a.n()).done;){var o=e.value;this.fatherPositionList.push(o.getBoundingClientRect())}}catch(t){a.e(t)}finally{a.f()}}},getSelfPosition:function(){this.selfPosition={};var t=document.querySelector("#self");this.selfPosition=null==t?void 0:t.getBoundingClientRect()},getSonPositionList:function(){this.sonPositionList=[];var t=document.querySelectorAll(".son");if(t&&t.length>0){var e,a=i(t);try{for(a.s();!(e=a.n()).done;){var o=e.value;this.sonPositionList.push(o.getBoundingClientRect())}}catch(t){a.e(t)}finally{a.f()}}}},mounted:function(){this.getBloodRelationInfo()}},l=(a("c014"),a("2877")),n=Object(l.a)(s,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"dataRelationship zt-scrollbar"},[e("svg",{attrs:{id:"job_stream_boar_svg",width:"100%",height:"100%"}},[t.mySelfTable.length>0?e("g",{staticStyle:{transform:"translate(40%,50%)"},attrs:{id:"self"}},[e("foreignObject",{staticClass:"self_for"},[e("div",{staticClass:"self_table"},[e("div",{staticClass:"father_table table_name",attrs:{title:t.mySelfTable[0].name}},[t._v(t._s(t.mySelfTable[0].name))])])])]):t._e(),e("g",{staticStyle:{transform:"translate(15%,50%)"}},t._l(t.fatherTables,(function(a,i){return e("g",{key:"f"+i,staticClass:"father",style:"transform:translate(0,"+(t.fatherTopY-60*i)+"px)"},[e("foreignObject",{staticClass:"father_for"},[e("div",{staticClass:"father_table"},[e("div",{staticClass:"table_name",attrs:{title:a.name}},[t._v(t._s(a.name))])])])])})),0),e("g",{staticStyle:{transform:"translate(65%,50%)"}},t._l(t.sonTables,(function(a,i){return e("g",{key:"s"+i,staticClass:"son",style:"transform:translate(0,"+(t.sonTopY-60*i)+"px)"},[e("foreignObject",{staticClass:"son_for"},[e("div",{staticClass:"son_table"},[e("div",{staticClass:"table_name",attrs:{title:a.name}},[t._v(t._s(a.name))])])])])})),0),t._l(t.fatherPositionList,(function(a,i){return e("g",{key:"fp"+i},[e("path",{staticClass:"path_type",attrs:{d:"M".concat(a.x-95," ").concat(a.y-116+34," L ").concat(t.selfPosition.x-235," ").concat(t.selfPosition.y-116+34)}}),e("polyline",{staticStyle:{stroke:"#006600"},attrs:{points:"".concat(t.selfPosition.x-235-7,",").concat(t.selfPosition.y-116+34+5," ").concat(t.selfPosition.x-235-7,",").concat(t.selfPosition.y-116+34-5," ").concat(t.selfPosition.x-235+3,",").concat(t.selfPosition.y-116+34)}})])})),t._l(t.sonPositionList,(function(a,i){return e("g",{key:"sp"+i},[e("path",{staticClass:"path_type",attrs:{d:"M".concat(a.x-95-140," ").concat(a.y-116+34," L ").concat(t.selfPosition.x-95," ").concat(t.selfPosition.y-116+34)}}),e("polyline",{staticStyle:{stroke:"#006600"},attrs:{points:"".concat(a.x-95-140-6,",").concat(a.y-116+34+5," ").concat(a.x-95-140-6,",").concat(a.y-116+34-5,",").concat(a.x-95-140+4," ").concat(a.y-116+34)}})])})),e("g")],2)])}),[],!1,null,"0d5b92f0",null);e.a=n.exports},"3d1b":function(t,e,a){"use strict";var i=a("2909"),o=(a("6b54"),{"data-search":1,"data-warehouse":0,"data-warehouse-related":1}),s={data:function(){return{pageIndex:1,tableHeight:0,isKey:1,pageSize:20,totalPage:0,isOver:1,isError:0,titTableData:[],titDesc:[],newTableData:[],cols:[],tableInfo:{},loading:!1,show:0,sign:0,flag:this.$route.query.from}},methods:{getAllLists:function(){var t=this;this.titDesc=[],this.$API.get(this.$URL.getTableInfoDataPreview+this.tableId,{},(function(e){0==e.code?(t.totalPage=e.totalCount,t.show=1):(t.show=0,t.$message.error(e.msg))}))},getdataPreview:function(){var t=this;if(0==this.isKey)return!1;this.isKey=0,this.loading=!0,this.$store.commit("old/changdataManagementTableIsClear",!1);this.$API.get(this.$URL.getTableInfoDataPreview+this.tableId+"/"+this.pageIndex+"/"+this.pageSize,{flag:0},(function(e){if(t.tableLoading=0,0==e.code){if(t.isKey=1,t.loading=!1,e.page.list.length>0){var a;for(var o in e.page.list)for(var s in e.page.list[o])!0!==e.page.list[o][s]&&!1!==e.page.list[o][s]||(e.page.list[o][s]=e.page.list[o][s].toString());t.titTableData=e.titleList,t.titTableData.length>9&&(t.sign=1),(a=t.newTableData).push.apply(a,Object(i.a)(e.page.list)),++t.pageIndex,t.tableId&&t.getTableInfo()}e.page.list.length<20&&(t.isOver=0)}else t.isError=1,t.loading=!1,t.$message.error(e.msg)}))},getTableInfo:function(){var t=this,e={flag:o[this.flag]};this.titDesc=[],this.$API.get(this.$URL.getTableInfoInfo+this.tableId,e,(function(e){if(0==e.code){if(e.data.tableFieldInfos.length>0)for(var a in e.data.tableFieldInfos)t.titDesc.push(e.data.tableFieldInfos[a].fieldAlias)}else t.$message.error(e.msg)}))},init:function(){this.getdataPreview()},renderHeader:function(t,e){var a=e.column,i=e.$index;return t("div",{attrs:{title:this.titDesc[i]}},[a.label])}},computed:{tableId:function(){return this.$route.query.tableId}},mounted:function(){var t=this;this.$nextTick((function(){t.tableHeight=400;var e=t;window.onresize=function(){e.tableHeight=400}}))},watch:{"$store.state.old.dataManagementTableIsClear":function(t){!0===t&&this.getdataPreview()}}},l=(a("fc28"),a("2877")),n=Object(l.a)(s,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"table"},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"table",attrs:{data:t.newTableData,height:t.tableHeight}},t._l(t.titTableData,(function(a,i){return e("el-table-column",{key:i,attrs:{label:a,prop:a,width:t.sign?190:"","show-overflow-tooltip":!0,"render-header":t.renderHeader}})})),1),1==t.isOver&&1==t.isKey&&1!=t.isError?e("el-link",{staticClass:"loading",attrs:{underline:!1,type:"primary"},on:{click:t.getdataPreview}},[t._v("点击加载更多"),e("i",{staticClass:"el-icon-arrow-down"})]):t._e(),0==t.isOver&&1!=t.pageIndex&&1!=t.isError?e("el-link",{staticClass:"loading",attrs:{underline:!1,type:"info"}},[t._v("暂无更多数据")]):t._e()],1)}),[],!1,null,null,null);e.a=n.exports},"44f5":function(t,e,a){(t.exports=a("2350")(!1)).push([t.i,".primary-color[data-v-7afb9ad6]{color:#1740dc}.success-color[data-v-7afb9ad6]{color:#52c41a}.warning-color[data-v-7afb9ad6]{color:#faad14}.error-color[data-v-7afb9ad6]{color:#f5222d}.info-color[data-v-7afb9ad6]{color:#909399}.border-color[data-v-7afb9ad6]{border:1px solid #e5e6e9}.uploaddata[data-v-7afb9ad6]{padding:40px;height:459px;overflow-y:scroll;text-align:left}.uploaddata .partition li[data-v-7afb9ad6]{margin-bottom:6px;display:-webkit-box;display:-ms-flexbox;display:flex;width:60%}.uploaddata .el-upload__tip[data-v-7afb9ad6]{line-height:20px}",""])},"46fd":function(t,e,a){var i=a("012a");i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("499e").default)("12545208",i,!0,{sourceMap:!1,shadowMode:!1})},"611f":function(t,e,a){var i=a("44f5");i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("499e").default)("634afe98",i,!0,{sourceMap:!1,shadowMode:!1})},9667:function(t,e,a){"use strict";a("611f")},b8fb:function(t,e,a){var i=a("c96e");i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("499e").default)("47dbdec2",i,!0,{sourceMap:!1,shadowMode:!1})},c014:function(t,e,a){"use strict";a("46fd")},c96e:function(t,e,a){(t.exports=a("2350")(!1)).push([t.i,".primary-color{color:#1740dc}.success-color{color:#52c41a}.warning-color{color:#faad14}.error-color{color:#f5222d}.info-color{color:#909399}.border-color{border:1px solid #e5e6e9}.table{height:100%}.table .el-table .cell{text-align:center}.table .el-table th .cell{text-align:center;line-height:auto}.table .el-table th .cell div{text-align:center;white-space:normal;width:100%;padding:0}.table .el-table__row{min-height:47px}.table .loading{margin:20px 0}.table .el-table__body-wrapper{overflow-y:scroll!important}.table .el-link.el-link--primary{width:100%}",""])},fc28:function(t,e,a){"use strict";a("b8fb")}}]);