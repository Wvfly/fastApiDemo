(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-08f83470"],{"31c6":function(e,t,a){"use strict";a("626d")},"4f40":function(e,t,a){"use strict";a.r(t);var l={name:"realTimeTable",data:function(){return{activeName:"limit",formInline:{userId:"",tableType:"",dbName:"",tableName:void 0,createUser:""},classOptions:[{value:"1",text:"内部表"},{value:"2",text:"外部表"}],options:[],applyUserList:[],createUserList:[],createUserList1:[],dataListLoading:!1,dataList:[],pageIndex:1,pageSize:10,totalPage:0}},components:{filterTBHeader:a("50f0").a},methods:{renderHeader:function(e,t){var a=t.column,l=(t.$index,this);return[a.label,e("el-tooltip",{props:{content:function(){switch(l.activeName){case"approve":return"申请授权时，我给予申请人的权限有效期";default:return"申请授权时，审批人给予的权限有效期"}}(),placement:"top"}},[e("span",{class:{"icon icon-ic_remind":!0}})])]},getTableInfoUserList:function(){var e=this;this.$API.get(this.$URL.getTableInfoUserListForRealTimeTable,{},(function(t){0==t.code?e.createUserList=e.createUserList.concat(t.data):e.$message.error(t.msg)}))},getRealTimeApproveUserList:function(){var e=this;this.$API.get(this.$URL.getRealTimeApproveUserList,{},(function(t){0==t.code?e.createUserList1=e.createUserList1.concat(t.data):e.$message.error(t.msg)}))},getRealTimeApplyUserList:function(){var e=this;this.$API.get(this.$URL.getRealTimeApplyUserList,{},(function(t){0==t.code?e.applyUserList=e.applyUserList.concat(t.data):e.$message.error(t.msg)}))},getlistDbs:function(){var e=this;this.$API.post(this.$URL.getListDbShare,{dateType:2},(function(t){if(0==t.code)for(var a=0;a<t.data.length;a++)e.options.push({value:t.data[a],text:t.data[a]});else e.options=[]}))},handleClick:function(e){this.$refs.table.doLayout(),this.formInline={userId:"",tableType:"",dbName:"",tableName:void 0,createUser:""},this.pageIndex=1,this.pageSize=10,this.totalPage=0,this.getDataTableListAll()},getDataTableListAll:function(){var e=this;this.dataListLoading=!0;var t={page:this.pageIndex,limit:this.pageSize,tableName:this.formInline.tableName,dbName:this.formInline.dbName},a="";"limit"==this.activeName?(t.tableType=this.formInline.tableType,t.createUser=this.formInline.createUser,a=this.$URL.getRealTimeTableList):"approve"==this.activeName?(t.current=t.page,t.size=t.limit,t.userId=this.formInline.userId,a=this.$URL.getRealTimeOwnApproveList):(t.current=t.page,t.size=t.limit,t.createUser=this.formInline.createUser,a=this.$URL.getRealTimeOwnApplyList),this.$API.post(a,t,(function(t){if(0==t.code){e.dataListLoading=!1;var a=t.data;e.dataList=a.list,e.totalPage=a.totalCount}else e.$message.error("获取数据失败！"),e.dataListLoading=!1,e.dataList=[],e.totalPage=0}))},reset:function(){this.formInline={userId:"",tableType:"",dbName:"",tableName:void 0,createUser:""},this.do_search()},do_search:function(){this.pageIndex=1,this.getDataTableListAll()},sizeChangeHandle:function(e){this.pageSize=e,this.pageIndex=1,this.getDataTableListAll()},currentChangeHandle:function(e){this.pageIndex=e,this.getDataTableListAll()},tableAddOrEditHandle:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.$router.push({path:"/addOrEditRealTable",query:{tableId:t,type:e}})},deleteHandle:function(e){var t=this;this.$confirm("确定进行删除操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a={id:e};t.$API.post(t.$URL.delRealTimeTable,a,(function(e){0==e.code?t.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){t.getDataTableListAll()}}):t.$message.error(e.msg)}))})).catch((function(){}))}},mounted:function(){this.getRealTimeApplyUserList(),this.getRealTimeApproveUserList(),this.getTableInfoUserList(),this.getlistDbs(),this.getDataTableListAll()}},r=(a("31c6"),a("2877")),i=Object(r.a)(l,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"realTimeTable"},[t("div",{staticClass:"zt-head noBorder"},[e._v("实时数仓")]),t("div",{staticClass:"zt-bg-content zt-scrollbar",staticStyle:{"border-top":"0","border-bottom":"0",height:"calc(100% - 112px)",overflow:"auto"}},[t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"realTimeTable_createTable",expression:"'realTimeTable_createTable'"}],attrs:{type:"primary"},on:{click:function(t){return e.tableAddOrEditHandle("add")}}},[e._v("创建实时表")]),t("el-form",{staticClass:"fr zt-form",attrs:{inline:!0,model:e.formInline}},["approve"==e.activeName?t("el-form-item",{attrs:{label:""}},[t("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择申请人"},model:{value:e.formInline.userId,callback:function(t){e.$set(e.formInline,"userId",t)},expression:"formInline.userId"}},e._l(e.applyUserList,(function(e){return t("el-option",{key:e.userId,attrs:{label:e.userName,value:e.userId}})})),1)],1):"limit"==e.activeName?t("el-form-item",{attrs:{label:""}},[t("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择创建人"},model:{value:e.formInline.createUser,callback:function(t){e.$set(e.formInline,"createUser",t)},expression:"formInline.createUser"}},e._l(e.createUserList,(function(e){return t("el-option",{key:e.userId,attrs:{label:e.userName,value:e.userId}})})),1)],1):t("el-form-item",{attrs:{label:""}},[t("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择创建人"},model:{value:e.formInline.createUser,callback:function(t){e.$set(e.formInline,"createUser",t)},expression:"formInline.createUser"}},e._l(e.createUserList1,(function(e){return t("el-option",{key:e.userId,attrs:{label:e.userName,value:e.userId}})})),1)],1),t("el-form-item",{attrs:{label:""}},[t("el-input",{staticStyle:{width:"193px"},attrs:{placeholder:"请输入表名"},model:{value:e.formInline.tableName,callback:function(t){e.$set(e.formInline,"tableName","string"==typeof t?t.trim():t)},expression:"formInline.tableName"}})],1),t("el-form-item",{staticStyle:{"margin-right":"0"}},[t("el-button",{attrs:{type:"primary"},on:{click:e.do_search}},[e._v("查询")]),t("el-button",{on:{click:e.reset}},[e._v("重置")])],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.dataListLoading,expression:"dataListLoading"}],ref:"table",staticStyle:{width:"100%"},attrs:{data:e.dataList}},[t("el-table-column",{key:"id",attrs:{prop:"id",width:"80",fixed:"",label:"ID"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",width:"150",fixed:"",label:"表名"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("router-link",{attrs:{to:"/onlineTableDetail?tableId="+a.row.id+"&from=list&tableType=2&offline=0"}},[e._v("\n            "+e._s(a.row.tableName)+"\n          ")])]}}])}),"limit"==e.activeName?t("el-table-column",{key:"tableType",attrs:{prop:"tableType",fixed:"",width:"80","show-overflow-tooltip":""},scopedSlots:e._u([{key:"header",fn:function(a){return[t("filter-t-b-header",{attrs:{label:"表类型",filter:e.classOptions,value:e.formInline.tableType},on:{"update:value":function(t){return e.$set(e.formInline,"tableType",t)},comfirm:e.do_search}})]}},{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(1===a.tableType?"内部表":2===a.tableType?"外部表":"")+"\n        ")]}}],null,!1,861303360)}):e._e(),t("el-table-column",{key:"dbName",attrs:{prop:"dbName",width:"90",fixed:"","show-overflow-tooltip":"",label:"所属库"},scopedSlots:e._u([{key:"header",fn:function(a){return[t("filter-t-b-header",{attrs:{label:"所属库",filter:e.options,value:e.formInline.dbName},on:{"update:value":function(t){return e.$set(e.formInline,"dbName",t)},comfirm:e.do_search}})]}}])}),t("el-table-column",{key:"projectName",attrs:{fixed:"",prop:"projectName","show-overflow-tooltip":"",label:"已关联项目"}}),t("el-table-column",{attrs:{fixed:"",prop:"roleNames","show-overflow-tooltip":"",label:"已授权角色"}}),"approve"==e.activeName?t("div",[t("el-table-column",{key:"applyStatus1",attrs:{prop:"applyStatus",width:"100","show-overflow-tooltip":"",label:"权限是否过期"},scopedSlots:e._u([{key:"default",fn:function(a){var l=a.row;return[t("span",[e._v(e._s(5==l.applyStatus?"是":"否"))])]}}],null,!1,1491452797)}),t("el-table-column",{key:"tableDesc1",attrs:{prop:"tableDesc","show-overflow-tooltip":"",label:"描述"}}),t("el-table-column",{key:"applyUser",attrs:{prop:"applyUser",width:"90","show-overflow-tooltip":"",label:"申请人"}})],1):e._e(),"apply"==e.activeName?t("div",[t("el-table-column",{key:"applyStatus2",attrs:{prop:"applyStatus",width:"100","show-overflow-tooltip":"",label:"权限是否回收"},scopedSlots:e._u([{key:"default",fn:function(a){var l=a.row;return[t("span",[e._v(e._s(4==l.applyStatus?"是":"否"))])]}}],null,!1,3390227772)}),t("el-table-column",{key:"applyStatus3",attrs:{prop:"applyStatus",width:"100","show-overflow-tooltip":"",label:"权限是否过期"},scopedSlots:e._u([{key:"default",fn:function(a){var l=a.row;return[t("span",[e._v(e._s(5==l.applyStatus?"是":"否"))])]}}],null,!1,1491452797)}),t("el-table-column",{key:"rollbackReason",attrs:{prop:"rollbackReason",width:"180","show-overflow-tooltip":"",label:"权限回收意见"}}),t("el-table-column",{key:"createPerName",attrs:{prop:"createPerName",width:"90","show-overflow-tooltip":"",label:"创建人"}}),t("el-table-column",{key:"tableDesc2",attrs:{prop:"tableDesc","show-overflow-tooltip":"",label:"描述"}})],1):e._e(),"limit"==e.activeName?t("el-table-column",{key:"createPerName1",attrs:{prop:"createPerName",width:"90","show-overflow-tooltip":"",label:"创建人"}}):e._e(),"limit"==e.activeName?t("el-table-column",{key:"updateTime",attrs:{prop:"updateTime",width:"140","show-overflow-tooltip":"",label:"更新时间"}}):e._e(),"limit"==e.activeName?t("el-table-column",{key:"tableDesc3",attrs:{prop:"tableDesc","show-overflow-tooltip":"",label:"描述"}}):e._e(),t("el-table-column",{key:"action",attrs:{"header-align":"right",align:"right",fixed:"right",width:"120",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"realtime-table-operate"},[t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"realTimeTable_edit",expression:"'realTimeTable_edit'"}],staticStyle:{"margin-right":"10px"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.tableAddOrEditHandle("edit",a.row.id)}}},[e._v("编辑")]),e.$checkPermission("realTimeTable_delete")||e.$checkPermission("realTimeTable_copy")?t("el-dropdown",[t("span",{staticClass:"el-dropdown-link"},[e._v("\n                更多"),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",[t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"realTimeTable_delete",expression:"'realTimeTable_delete'"}],staticClass:"delete",attrs:{type:"text",size:"small"},on:{click:function(t){return e.deleteHandle(a.row.id)}}},[e._v("删除\n                  ")])],1),t("el-dropdown-item",[t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"realTimeTable_copy",expression:"'realTimeTable_copy'"}],attrs:{type:"text",size:"small"},on:{click:function(t){return e.tableAddOrEditHandle("copy",a.row.id)}}},[e._v("复制")])],1)],1)],1):e._e()],1)]}}])})],1),t("el-pagination",{attrs:{"current-page":e.pageIndex,"page-sizes":[10,20,50,100],"page-size":e.pageSize,total:e.totalPage,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.sizeChangeHandle,"current-change":e.currentChangeHandle}})],1)])}),[],!1,null,"60fac252",null);t.default=i.exports},5364:function(e,t,a){(e.exports=a("2350")(!1)).push([e.i,".primary-color[data-v-60fac252]{color:#1740dc}.success-color[data-v-60fac252]{color:#52c41a}.warning-color[data-v-60fac252]{color:#faad14}.error-color[data-v-60fac252]{color:#f5222d}.info-color[data-v-60fac252]{color:#909399}.border-color[data-v-60fac252]{border:1px solid #e5e6e9}.realTimeTable[data-v-60fac252]{height:100%}.realTimeTable .top-type[data-v-60fac252]{padding:0 20px}.realTimeTable .zt-bg-content[data-v-60fac252]{border:none;padding-top:20px}.realTimeTable .realtime-table-operate[data-v-60fac252]{color:#1740dc}.realTimeTable .realtime-table-operate>span[data-v-60fac252]{cursor:pointer}.realTimeTable .delete[data-v-60fac252]{color:#f5222d}.realTimeTable .truncate[data-v-60fac252]{color:#e6a23c}.realTimeTable .el-button--text[data-v-60fac252]{padding-left:0!important;padding-right:0!important}.realTimeTable[data-v-60fac252] .el-dropdown-link{margin-left:10px;cursor:pointer}.realTimeTable[data-v-60fac252] .el-dropdown-link:hover{color:#1740dc}[data-v-60fac252] .el-dropdown-menu__item{padding:0 5px;margin:0 5px}",""])},"626d":function(e,t,a){var l=a("5364");l.__esModule&&(l=l.default),"string"==typeof l&&(l=[[e.i,l,""]]),l.locals&&(e.exports=l.locals);(0,a("499e").default)("c0118184",l,!0,{sourceMap:!1,shadowMode:!1})}}]);