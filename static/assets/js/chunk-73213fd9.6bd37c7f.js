(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-73213fd9","chunk-74af32dc"],{"002e":function(e,t,a){"use strict";a("bdb5")},"0053":function(e,t,a){"use strict";a.d(t,"B",(function(){return n})),a.d(t,"b",(function(){return s})),a.d(t,"u",(function(){return l})),a.d(t,"A",(function(){return o})),a.d(t,"s",(function(){return c})),a.d(t,"E",(function(){return u})),a.d(t,"a",(function(){return d})),a.d(t,"J",(function(){return p})),a.d(t,"I",(function(){return m})),a.d(t,"H",(function(){return f})),a.d(t,"G",(function(){return b})),a.d(t,"M",(function(){return v})),a.d(t,"z",(function(){return h})),a.d(t,"t",(function(){return g})),a.d(t,"r",(function(){return y})),a.d(t,"f",(function(){return w})),a.d(t,"l",(function(){return x})),a.d(t,"d",(function(){return T})),a.d(t,"i",(function(){return L})),a.d(t,"p",(function(){return S})),a.d(t,"m",(function(){return k})),a.d(t,"g",(function(){return _})),a.d(t,"C",(function(){return R})),a.d(t,"o",(function(){return N})),a.d(t,"h",(function(){return D})),a.d(t,"y",(function(){return I})),a.d(t,"x",(function(){return q})),a.d(t,"e",(function(){return P})),a.d(t,"n",(function(){return C})),a.d(t,"D",(function(){return $})),a.d(t,"k",(function(){return O})),a.d(t,"j",(function(){return V})),a.d(t,"F",(function(){return F})),a.d(t,"q",(function(){return A})),a.d(t,"L",(function(){return E})),a.d(t,"v",(function(){return M})),a.d(t,"w",(function(){return z})),a.d(t,"c",(function(){return j})),a.d(t,"K",(function(){return B}));var r=a("2b0e"),i=a("fedb"),n=function(e){return r.default.http.post(i.a.getDataServiceGroupList,e)},s=function(e){return r.default.http.post(i.a.addDataServiceGroup,e)},l=function(e){return r.default.http.post(i.a.editDataServiceGroup,e)},o=function(e){return r.default.http.get(i.a.getDataServiceGroupDetailById+"/".concat(e))},c=function(e){return r.default.http.get(i.a.deleteDataServiceGroupById+"/".concat(e))},u=function(e){return r.default.http.post(i.a.getDataServiceListPage,e)},d=function(e){return r.default.http.post(i.a.addDataService,e)},p=function(e){return r.default.http.get(i.a.getGroupServiceUrl+e)},m=function(e){var t=e.conId;return r.default.http.get(i.a.getDataserviceDataBase+"/".concat(t))},f=function(e){var t=e.dbName,a=e.conId;return r.default.http.get(i.a.getDataServiceTables+"?dbName=".concat(t,"&conId=").concat(a))},b=function(e){var t=e.conId,a=e.dbName,n=e.tableName;return r.default.http.get(i.a.getDataServiceTableStructure+"?conId=".concat(t,"&dbName=").concat(a,"&tableName=").concat(n))},v=function(e){return r.default.http.get(i.a.getTableInfoListDataTypes+"?type="+e)},h=function(e){var t=e.id;return r.default.http.get(i.a.getDataServiceDetailById+"/".concat(t))},g=function(e){return r.default.http.post(i.a.editDataService,e)},y=function(e){var t=e.limit,a=e.page,n=e.serviceId;return r.default.http.get(i.a.dataServiceUserAuthorizationList+"?limit=".concat(t,"&page=").concat(a,"&serviceId=").concat(n))},w=function(e){var t=e.applyId;return r.default.http.get(i.a.dataServiceApprove+"?applyId=".concat(t))},x=function(e){var t=e.applyId;return r.default.http.get(i.a.dataServiceReject+"?applyId=".concat(t))},T=function(e){return r.default.http.post(i.a.dataServiceActiveApprove,e)},L=function(e){var t=e.serviceId;return r.default.http.get(i.a.dataServiceGetParams+"?serviceId=".concat(t))},S=function(e){return r.default.http.post(i.a.dataServiceTest,e,{timeout:18e4})},k=function(e){var t=e.serviceId;return r.default.http.get(i.a.dataServiceRelease+"?serviceId=".concat(t))},_=function(e){return r.default.http.post(i.a.dataServiceCopy,e)},R=function(){return r.default.http.get(i.a.getDataServiceGroupListWithoutPagination)},N=function(e){var t=e.serviceId;return r.default.http.get(i.a.dataServiceRevoke+"?serviceId=".concat(t))},D=function(e){var t=e.serviceId;return r.default.http.get(i.a.dataServiceDelete+"?serviceId=".concat(t))},I=function(e){return r.default.http.post(i.a.getDataServiceAuthList,e)},q=function(e){return r.default.http.post(i.a.getDataServiceApplyList,e)},P=function(e){var t=e.applyId;return r.default.http.get(i.a.dataServiceApplyDelete+"?applyId=".concat(t))},C=function(e){return r.default.http.post(i.a.dataServiceRenewal,e)},$=function(e){return r.default.http.post(i.a.getDataServiceListGroupPage,e)},O=function(e){return r.default.http.post(i.a.dataServiceNewApply,e)},V=function(e){var t=e.serviceId;return r.default.http.get(i.a.dataServiceInfo+"?serviceId=".concat(t))},F=function(e){var t=e.serviceId,a=e.type;return r.default.http.get(i.a.getDataServiceMonitorInfo+"/".concat(t,"/").concat(a))},A=function(e){var t=e.serviceId;return r.default.http.get(i.a.dataServiceUser+"?serviceId=".concat(t))},E=function(e){return r.default.http.post(i.a.getServiceLogList,e)},M=function(){return r.default.http.post(i.a.getCallUserList)},z=function(){return r.default.http.post(i.a.getCreateUserListOfService)},j=function(e){return r.default.http.get(i.a.checkServiceName,{params:e})},B=function(){return r.default.http.get(i.a.getServeLimitDictionary)}},"0a49":function(e,t,a){var r=a("9b43"),i=a("626a"),n=a("4bf8"),s=a("9def"),l=a("cd1c");e.exports=function(e,t){var a=1==e,o=2==e,c=3==e,u=4==e,d=6==e,p=5==e||d,m=t||l;return function(t,l,f){for(var b,v,h=n(t),g=i(h),y=r(l,f,3),w=s(g.length),x=0,T=a?m(t,w):o?m(t,0):void 0;w>x;x++)if((p||x in g)&&(v=y(b=g[x],x,h),e))if(a)T[x]=v;else if(v)switch(e){case 3:return!0;case 5:return b;case 6:return x;case 2:T.push(b)}else if(u)return!1;return d?-1:c||u?u:T}}},"181c":function(e,t,a){"use strict";a("96cf");var r,i,n,s=a("1da1"),l=a("ade3"),o=(a("ac6a"),a("c5f6"),a("0053")),c={name:"TestAndPublish",props:{isShowTest:{type:Boolean,default:!1},mode:{type:String,default:"test"},serviceId:{type:Number},typeId:{type:String,default:""}},data:function(){return{testLoading:!1,publicLoading:!1,form:{paramsList:[]},serviceName:"",serviceUrl:"",requestType:null,appId:null,token:null,testResult:null,testCode:null,responseTime:null,dataTypeListRegExp:{INT:/^-?\d+$/,BIGINT:/^-?\d+$/,FLOAT:/^(-?\d+)(\.\d+)?$/,DOUBLE:/^(-?\d+)(\.\d+)?$/,BOOLEAN:/true|false/,STRING:/.*/,DATE:/^[1-9]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])$/,DATETIME:/^[1-9]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])\s+(20|21|22|23|[0-1]\d):[0-5]\d:[0-5]\d$/,TIMESTAMP:/\d{13}/}}},computed:{requestBody:function(){var e,t=[];return this.form.paramsList&&null!==(e=this.form.paramsList)&&void 0!==e&&e.length&&this.form.paramsList.forEach((function(e){t.push(Object(l.a)({},e.paramName,e.value))})),t}},methods:{handleDialogClose:function(){this.testCode=null,this.testResult=[],this.$refs.form.resetFields(),this.$emit("close")},handleTest:function(){var e=this;this.testLoading=!0,this.$refs.form.validate((function(t){if(!t)return!1;e.dataServiceTest()}))},handlePublish:function(){this.publicLoading=!0,this.dataServiceRelease()},handleCancel:function(){this.testCode=null,this.testResult=[],this.$emit("close")},handleDialogOpen:function(){this.dataServiceGetParams()},dataServiceGetParams:(n=Object(s.a)(regeneratorRuntime.mark((function e(){var t,a,r,i,n,s,l,c,u,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(o.i)({serviceId:this.serviceId});case 2:t=e.sent,a=t.data,r=a.code,i=a.data,n=i.params,s=i.requestType,l=i.serviceName,c=i.serviceUrl,u=i.appId,d=i.token,0===r&&(this.form.paramsList=n,this.requestType=s,this.serviceName=l,this.serviceUrl=c,this.appId=u,this.token=d);case 13:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)}),dataServiceTest:(i=Object(s.a)(regeneratorRuntime.mark((function e(){var t,a,r,i,n,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(o.p)({serviceId:this.serviceId,params:this.form.paramsList});case 3:t=e.sent,a=t.data,r=a.code,i=a.data,n=i.jsonData,s=i.responseTime,this.testLoading=!1,this.testCode=r,this.testResult=n,this.responseTime=s,e.next=19;break;case 15:e.prev=15,e.t0=e.catch(0),this.testLoading=!1,this.testCode=-1;case 19:case"end":return e.stop()}}),e,this,[[0,15]])}))),function(){return i.apply(this,arguments)}),dataServiceRelease:(r=Object(s.a)(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(o.m)({serviceId:this.serviceId});case 2:t=e.sent,a=t.data.code,this.publicLoading=!1,0===a&&(this.$message.success("服务发布成功"),this.handleDialogClose(),this.$emit("refresh"));case 6:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})}},u=(a("002e"),a("2877")),d=Object(u.a)(c,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"test-and-publish"},[t("el-dialog",{attrs:{visible:e.isShowTest,title:"test"===e.mode?"测试服务":"发布到服务中心"},on:{close:e.handleDialogClose,open:e.handleDialogOpen}},["-3"!=e.typeId?t("el-alert",{attrs:{title:"提示：发布"+e.serviceName+"到服务中心之前，请先测试",type:"info",closable:!1}}):e._e(),t("div",{staticClass:"basic-info"},[t("div",{staticClass:"title"},[e._v("基本信息")]),t("div",{staticClass:"content"},[t("div",{staticClass:"item"},[e._v("数据服务名称： "+e._s(e.serviceName))]),t("div",{staticClass:"item"},[e._v("数据服务路径： "+e._s(e.serviceUrl))]),t("div",{staticClass:"item"},[e._v("请求方式："+e._s(0===e.requestType?"GET":"POST"))])])]),t("div",{staticClass:"params-list"},[t("div",{staticClass:"title"},[e._v(e._s(0===e.requestType?"GET":"POST")+"请求")]),t("el-form",{ref:"form",attrs:{model:e.form,size:"mini"}},[t("el-table",{attrs:{"max-height":"200px",data:e.form.paramsList}},[t("el-table-column",{attrs:{prop:"paramName",label:"参数名称"}}),t("el-table-column",{attrs:{prop:"paramType",label:"参数类型"}}),t("el-table-column",{attrs:{label:"是否必填"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(1===t.row.isRequired?"必填":"非必填")+"\n            ")]}}])}),t("el-table-column",{attrs:{label:"值",prop:"value"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-form-item",{attrs:{prop:"paramsList."+a.$index+".value",rules:a.row.isRequired?[{required:!0,message:"请输入参数值",trigger:"blur"},{pattern:e.dataTypeListRegExp[a.row.paramType],message:"请输入正确的参数类型",trigger:"blur"}]:[{pattern:e.dataTypeListRegExp[a.row.paramType],message:"请输入正确的参数类型",trigger:"blur"}]}},[t("el-input",{model:{value:a.row.value,callback:function(t){e.$set(a.row,"value",t)},expression:"scope.row.value"}})],1)]}}])})],1)],1)],1),null!==e.testCode?t("div",{staticClass:"test-result"},[0===e.testCode?t("div",{staticClass:"success"},[e._v("已通过测试")]):e._e(),0!==e.testCode?t("div",{staticClass:"error"},[e._v("测试失败")]):e._e()]):e._e(),t("div",{staticClass:"request-detail"},[t("div",{staticClass:"title"},[t("span",[e._v("请求详情："),null!==e.testCode?t("span",[e._v(e._s(0===e.testCode?"成功":"失败"))]):e._e()]),t("el-divider",{attrs:{direction:"vertical"}}),t("span",[e._v("响应时间："+e._s(e.responseTime)+"ms")])],1),t("div",{staticClass:"content"},[t("div",{staticClass:"item"},[e._v(e._s(0===e.requestType?"GET":"POST")+"  "+e._s(e.serviceUrl))]),t("div",{staticClass:"item"},[e._v(e._s("header: {appid="+e.appId+",timestamp="+(new Date).getTime()+",token="+e.token+"}"))]),t("div",{staticClass:"item"},[e._v(e._s("body: "+JSON.stringify(e.requestBody)))])])]),t("div",{staticClass:"response-detail"},[t("div",{staticClass:"title"},[e._v("返回内容")]),t("div",{staticClass:"content"},e._l(e.testResult,(function(a,r){return t("div",{key:r,staticClass:"item"},[e._v(e._s(a))])})),0)]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},["-3"==e.typeId?t("div",[t("el-button",{attrs:{type:"primary",loading:e.publicLoading},on:{click:e.handlePublish}},[e._v("发 布")]),t("el-button",{on:{click:e.handleCancel}},[e._v("取 消")])],1):t("div",["publish"===e.mode?t("el-button",{attrs:{type:"primary",disabled:0!==e.testCode,loading:e.publicLoading},on:{click:e.handlePublish}},[e._v("发 布")]):e._e(),t("el-button",{attrs:{type:"primary",loading:e.testLoading},on:{click:e.handleTest}},[e._v("测 试")]),t("el-button",{on:{click:e.handleCancel}},[e._v("取 消")])],1)])],1)],1)}),[],!1,null,"efa3c94c",null);t.a=d.exports},"20d6":function(e,t,a){"use strict";var r=a("5ca1"),i=a("0a49")(6),n="findIndex",s=!0;n in[]&&Array(1)[n]((function(){s=!1})),r(r.P+r.F*s,"Array",{findIndex:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),a("9c6c")(n)},"2ed7":function(e,t,a){(e.exports=a("2350")(!1)).push([e.i,'.primary-color[data-v-bc8ae102]{color:#1740dc}.success-color[data-v-bc8ae102]{color:#52c41a}.warning-color[data-v-bc8ae102]{color:#faad14}.error-color[data-v-bc8ae102]{color:#f5222d}.info-color[data-v-bc8ae102]{color:#909399}.border-color[data-v-bc8ae102]{border:1px solid #e5e6e9}.new-service-container[data-v-bc8ae102]{position:relative;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;background:#f0f2f5}.new-service-container[data-v-bc8ae102] .el-step__icon-inner,.new-service-container[data-v-bc8ae102] .el-step__title.is-process{font-weight:400!important}.new-service-container[data-v-bc8ae102] .el-table:before{background:transparent!important}.new-service-container[data-v-bc8ae102] .el-form-item__error{position:unset!important}.new-service-container[data-v-bc8ae102] .el-table__fixed-right:before{background-color:transparent!important}.new-service-container[data-v-bc8ae102] .form-title{font-size:14px;font-weight:500;margin-bottom:20px;margin-left:-30px}.new-service-container[data-v-bc8ae102] .form-title:before{content:"";height:14px;width:3px;background-color:#00f;display:inline-block;vertical-align:-3px;margin-right:10px;padding-top:2px}.new-service-container[data-v-bc8ae102] .el-input-number .el-input__inner{text-align:left}.new-service-container .new-service[data-v-bc8ae102]{height:93%;overflow-y:scroll;background:#fff;padding:20px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.new-service-container .new-service .ident2[data-v-bc8ae102]{margin-left:25px;line-height:35px}.new-service-container .new-service .new-service-top[data-v-bc8ae102]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center;font-size:16px;color:#000;padding-bottom:20px;border-bottom:1px solid #e8e8ea;margin-bottom:20px}.new-service-container .new-service .new-service-top .top-right[data-v-bc8ae102]{color:#000;width:140px}.new-service-container .new-service .new-service-top .top-left[data-v-bc8ae102]{-webkit-box-flex:1;-ms-flex:1;flex:1;text-align:center}.new-service-container .new-service .new-service-content[data-v-bc8ae102]{-webkit-box-flex:1;-ms-flex:1;flex:1;position:relative}.new-service-container .new-service .new-service-content .steps[data-v-bc8ae102]{padding:0 190px;margin-left:35px}.new-service-container .new-service .new-service-content .api-detail .form1[data-v-bc8ae102]{margin-top:20px;margin-left:27.5%}.new-service-container .new-service .new-service-content .api-detail .form1[data-v-bc8ae102] .el-input,.new-service-container .new-service .new-service-content .api-detail .form1[data-v-bc8ae102] .el-textarea{width:400px}.new-service-container .new-service .new-service-content .data-params .service-type.el-select[data-v-bc8ae102]{width:410px!important}.new-service-container .new-service .new-service-content .data-params .guide-mode[data-v-bc8ae102]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;width:100%}.new-service-container .new-service .new-service-content .data-params .guide-mode .content-title[data-v-bc8ae102]{width:100%;height:40px;background:#f2f2f2;font-weight:700;line-height:40px;padding-left:10px}.new-service-container .new-service .new-service-content .data-params .guide-mode .guide-left[data-v-bc8ae102]{width:29%;min-height:400px;border:1px solid #e5e6e9}.new-service-container .new-service .new-service-content .data-params .guide-mode .guide-left .content-title[data-v-bc8ae102]{background:#fff!important}.new-service-container .new-service .new-service-content .data-params .guide-mode .guide-left .source-content[data-v-bc8ae102]{padding:20px 10px}.new-service-container .new-service .new-service-content .data-params .guide-mode .guide-left .source-content[data-v-bc8ae102] .el-input,.new-service-container .new-service .new-service-content .data-params .guide-mode .guide-left .source-content[data-v-bc8ae102] .el-select{width:90%}.new-service-container .new-service .new-service-content .data-params .guide-mode .guide-left .params-content[data-v-bc8ae102]{padding:10px}.new-service-container .new-service .new-service-content .data-params .guide-mode .guide-left .params-content .title[data-v-bc8ae102]{padding-bottom:10px}.new-service-container .new-service .new-service-content .data-params .guide-mode .guide-right[data-v-bc8ae102]{width:70%;min-height:400px;border:1px solid #e5e6e9}.new-service-container .new-service .new-service-content .data-params .guide-mode .guide-right .guild-right-content[data-v-bc8ae102]{padding:10px 10px}.new-service-container .new-service .new-service-content .data-params .guide-mode .guide-right .guild-right-content .back-params[data-v-bc8ae102]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;margin-bottom:10px}.new-service-container .new-service .new-service-content .data-params .guide-mode .guide-right .guild-right-content .back-params div[data-v-bc8ae102]{margin-bottom:10px;font-size:12px;color:rgba(4,12,44,.85)}.new-service-container .new-service .new-service-content .data-params .guide-mode .guide-right .guild-right-content .request-params[data-v-bc8ae102]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;margin-bottom:10px}.new-service-container .new-service .new-service-content .data-params .guide-mode .guide-right .guild-right-content .request-params div[data-v-bc8ae102]{margin-bottom:10px;font-size:12px;color:rgba(4,12,44,.85)}.new-service-container .new-service .new-service-content .data-params .guide-mode .guide-right .guild-right-content .range-params[data-v-bc8ae102]{margin-top:10px}.new-service-container .new-service .new-service-content .data-params .sql-mode .plus-1[data-v-bc8ae102]{margin-left:110px;margin-top:10px;margin-bottom:10px;line-height:30px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;color:#040c2c;border:1px dashed #cdced5;cursor:pointer}.new-service-container .new-service .new-service-content .data-params .sql-mode .plus-1[data-v-bc8ae102]:hover{color:#1740dc;border-color:#1740dc}.new-service-container .new-service .new-service-content .data-params .sql-mode .sql-mode-top[data-v-bc8ae102] .el-select,.new-service-container .new-service .new-service-content .data-params .sql-mode .sql-type[data-v-bc8ae102] .el-select{width:400px!important}.new-service-container .new-service .new-service-content .data-params .sql-mode .request-params[data-v-bc8ae102]{display:-webkit-box;display:-ms-flexbox;display:flex}.new-service-container .new-service .new-service-content .data-params .sql-mode .request-params[data-v-bc8ae102] .el-form-item__content{margin-left:0!important}.new-service-container .buttons[data-v-bc8ae102]{position:fixed;height:6.3%;background:#fff;left:208px;right:0;bottom:0;text-align:right;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;padding-right:30px;z-index:10}.new-service-container[data-v-bc8ae102] .tooltip{top:0;position:relative;left:-76px}.new-service-container .plus-1[data-v-bc8ae102]{margin-top:10px;margin-bottom:10px;line-height:30px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;color:#040c2c;border:1px dashed #cdced5;cursor:pointer}.new-service-container .plus-1[data-v-bc8ae102]:hover{color:#1740dc;border-color:#1740dc}[data-v-bc8ae102] .el-icon-warning:before{content:"\\E7A3";color:#1740dc;font-size:16px;margin-right:10px}',""])},7514:function(e,t,a){"use strict";var r=a("5ca1"),i=a("0a49")(5),n=!0;"find"in[]&&Array(1).find((function(){n=!1})),r(r.P+r.F*n,"Array",{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),a("9c6c")("find")},"7ced":function(e,t,a){(e.exports=a("2350")(!1)).push([e.i,".primary-color[data-v-efa3c94c]{color:#1740dc}.success-color[data-v-efa3c94c]{color:#52c41a}.warning-color[data-v-efa3c94c]{color:#faad14}.error-color[data-v-efa3c94c]{color:#f5222d}.info-color[data-v-efa3c94c]{color:#909399}.border-color[data-v-efa3c94c]{border:1px solid #e5e6e9}.test-and-publish[data-v-efa3c94c] .el-form-item__error{position:relative!important}.test-and-publish .basic-info .title[data-v-efa3c94c]{font-size:14px;font-weight:700;margin:15px 0}.test-and-publish .basic-info .content[data-v-efa3c94c]{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}.test-and-publish .basic-info .content .item[data-v-efa3c94c]{padding-left:30px;margin-bottom:15px}.test-and-publish .basic-info .content .item[data-v-efa3c94c]:first-child{width:30%}.test-and-publish .basic-info .content .item[data-v-efa3c94c]:nth-child(2){width:50%}.test-and-publish .basic-info .content .item[data-v-efa3c94c]:nth-child(3){width:20%}.test-and-publish .params-list .title[data-v-efa3c94c]{font-size:14px;font-weight:700;margin-bottom:15px}.test-and-publish .test-result[data-v-efa3c94c]{margin:15px;font-size:12px}.test-and-publish .test-result .success[data-v-efa3c94c]{color:#1740dc;text-align:right;line-height:25px}.test-and-publish .test-result .error[data-v-efa3c94c]{color:#f5222d;text-align:right;line-height:25px}.test-and-publish .request-detail[data-v-efa3c94c],.test-and-publish .response-detail[data-v-efa3c94c]{margin-top:10px}.test-and-publish .request-detail .title[data-v-efa3c94c],.test-and-publish .response-detail .title[data-v-efa3c94c]{font-size:14px;font-weight:700;margin-bottom:15px}.test-and-publish .request-detail .content[data-v-efa3c94c],.test-and-publish .response-detail .content[data-v-efa3c94c]{max-height:200px;border:1px solid #d7d7d7;background:#f2f2f2;overflow:auto;padding:15px;margin-bottom:15px}.test-and-publish .request-detail .content .item[data-v-efa3c94c],.test-and-publish .response-detail .content .item[data-v-efa3c94c]{font-size:12px;line-height:30px}",""])},"85b7":function(e,t,a){var r=a("2ed7");r.__esModule&&(r=r.default),"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);(0,a("499e").default)("0cfc65e0",r,!0,{sourceMap:!1,shadowMode:!1})},"97fc":function(e,t,a){"use strict";a("85b7")},bdb5:function(e,t,a){var r=a("7ced");r.__esModule&&(r=r.default),"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);(0,a("499e").default)("70ee8477",r,!0,{sourceMap:!1,shadowMode:!1})},cd1c:function(e,t,a){var r=a("e853");e.exports=function(e,t){return new(r(e))(t)}},df2d:function(e,t,a){"use strict";a.r(t);a("6762"),a("2fdb"),a("7f7f"),a("8e6e"),a("456d"),a("ac4d"),a("8a81"),a("5df3"),a("1c4c"),a("6b54");var r=a("ade3"),i=(a("20d6"),a("ac6a"),a("7514"),a("c5f6"),a("96cf"),a("1da1")),n=a("0053");function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){Object(r.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return c(e,t)}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,s=!0,l=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return s=e.done,e},e:function(e){l=!0,n=e},f:function(){try{s||null==a.return||a.return()}finally{if(l)throw n}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var u,d,p,m,f,b,v,h,g,y,w,x,T,L,S,k,_={name:"NewService",components:{TestAndPublish:a("181c").a},data:function(){return{dicDetail:null,loading:!1,list:[],showFieldType:"",fieldType:"",isShowTest:!1,options:[],ShowOptionsList:[],getOptions:[],value:"",showTableName:!1,mode:"test",serviceId:null,activeIndex:0,btnState:!1,form1:{serviceName:"",servicePath:"",requestWay:"http",requestType:0,serviceTimeOut:3e3,isExtendToken:2,serviceDescription:"",tenantId:[],serveType:0,serviceDetailType:1,reTry:"",reTrySec:""},serviceType:1,form2:{connectId:null,dbName:null,tableName:null},form3:{conditionsList:[{label:"且条件",value:"and"},{label:"或条件",value:"or"}],backParmasList:[],enableRule:0,actionModeRule:1,newList:[],dataServiceRuleList:[{permissionRule:"",fieldName:"",ruleCondition:"",ruleValueList:"",ruleValue:"",intValue1:"",intValue2:"",intValue3:"",intValue4:""}],requestParamsList:[{paramName:"page_size",bindingField:"page_size",paramPosition:"1",isCondition:1,isFuzzy:0,isMultiple:0,isRequired:1,paramType:"INT",computerValue:"",isConditionSelect:1,defaultValue:"",paramDesc:"",regular:""},{paramName:"page_num",bindingField:"page_num",paramPosition:"1",isRequired:1,isFuzzy:0,isMultiple:0,paramType:"INT",isConditionSelect:1,isCondition:1,defaultValue:"",paramDesc:"",regular:""}],valueRangType:2,valueRang:"",isConditionList:[{label:"是",value:1},{label:"否",value:0}]},form4:{dbType:"",connectId:null,requestParamsList:[],responseParmasList:[],requestSql:""},tableFieldList:[],paramTypeList:[{label:"请求参数",value:1},{label:"返回参数",value:2},{label:"共同参数",value:3}],requestTypeList:[{label:"http",value:"http"}],serviceTypeList:[{label:"向导模式",value:1},{label:"SQL模式",value:2}],dataTypeList:{},dataTypeList1:{},dataDbtypeList:[],tenantList:[],dataSourceList:[],dataBaseList:[],dataTableList:[],paramsTypeList:["INT","BIGINT","FLOAT","DOUBLE","BOOLEAN","STRING","DATE","DATETIME","TIMESTAMP"]||!1,paramsTypeList1:[],paramPositionList:[{label:"query",value:"1"},{label:"body",value:"2"}],isRequiredList:[{label:"是",value:1},{label:"否",value:0}],GetinquireList:[{label:"是",value:0},{label:"否",value:1}],multiSelectionRows:[],isShowDialog:!1,fieldTypeName:"",operatorList:["属于","不属于","包含","不包含","为空","非空","开头是","开头不是","结尾是","结尾不是"],operatorList1:["属于","不属于","大于","小于","大于等于","小于等于","等于","不等于","为空","非空"],operatorValue:"",placeholderContentSql:"在SQL语句中调用请求参数时请使用{{参数名}}格式，例如：select * from db.table_name where id = {{param1}}",placeholderContentMongoDB:'请在查询语句中调用请求参数时使用{{参数名}}格式，例如：db.collection.find("user":{{name}}).limit(1)',placeholderContent:" 请在此处配置请求参数表达式，eg：id={{请求参数}} or name>{{请求参数}} and (number NOT LIKE {{请求参数}} or table_id < {{请求参数}})",editDetail:null,status:localStorage.dataServiceNewOrEdit,dataTypeListRegExp:{INT:/^-?\d+$/,BIGINT:/^-?\d+$/,FLOAT:/^(-?\d+)(\.\d+)?$/,DOUBLE:/^(-?\d+)(\.\d+)?$/,BOOLEAN:/true|false/,STRING:/.*/,DATE:/^[1-9]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])$/,DATETIME:/^[1-9]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])\s+(20|21|22|23|[0-1]\d):[0-5]\d:[0-5]\d$/,TIMESTAMP:/\d{13}/}}},computed:{paramPosition:function(){return 0===this.form1.requestType?"1":"2"}},mounted:function(){this.getTableInfoListDataTypes(),this.getServiceRuleList(),this.form3.dataServiceRuleList=[],-4==this.$route.query.connectId&&(this.form1.serviceDetailType=2,this.form4.connectId=""),this.init()},activated:function(){this.init()},methods:{getServeLimitDictionary:(k=Object(i.a)(regeneratorRuntime.mark((function e(){var t,a,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(n.K)();case 2:t=e.sent,a=t.data,r=a.code,i=a.data,0===r&&(this.dicDetail=i,"new"===this.status&&(this.form1.reTry=this.dicDetail.retryCall,this.form1.reTrySec=this.dicDetail.retryInterval));case 7:case"end":return e.stop()}}),e,this)}))),function(){return k.apply(this,arguments)}),changAvalue:function(e,t){if(1==t)return this.$set(e,"intValue1",Number(e.intValue1));this.$set(e,"intValue4",Number(e.intValue4)),e.intValue1&&e.intValue2&&e.intValue3&&e.intValue4?e.ruleValueList="".concat(e.intValue1).concat(e.intValue2).concat(e.fieldName).concat(e.intValue3).concat(e.intValue4):e.ruleValueList=""},dealWithValid:function(e,t,a,r){t>=r.intValue4?a(new Error("最小值必须小于最大值")):a()},dealWithValid2:function(e,t,a,r){t<=r.intValue1?a(new Error("最大值必须大于最小值")):a()},changeFieldType:function(e,t){var a;t.row.fieldName!==this.fieldTypeName||t.row.fieldType||(t.row.fieldType=this.showFieldType);var r=null===(a=this.tableFieldList.find((function(t){return t.fieldName===e})))||void 0===a?void 0:a.fieldType;["INT","BIGINT","FLOAT","DOUBLE","BOOLEAN","DECIMAL","DATE","DATETIME","TIMESTAMP","TINYINT","SMALLINT","MEDIUMINT"].includes(r?r.toLocaleUpperCase():r)?this.$set(t.row,"operatorList",this.operatorList1):this.$set(t.row,"operatorList",this.operatorList),this.$set(t.row,"fieldType",r),t.row.ruleCondition=null,t.row.ruleValueList=[]},handleRuleConditionChange:function(e,t){["非空","为空","属于","不属于"].includes(e)?["属于","不属于"].includes(t.row.ruleCondition)&&["int","float","double","bigint","INT","FLOAT","DOUBLE","BIGINT"].includes(t.row.fieldType)?(t.row.ruleValueList=[],this.$set(t.row,"intValue1",""),this.$set(t.row,"intValue2",""),this.$set(t.row,"intValue3",""),this.$set(t.row,"intValue4","")):t.row.ruleValueList=[]:t.row.ruleValueList=""},getdataServiceDetailList:function(e,t){var a=this;""==t?this.ShowOptionsList=[]:(this.loading=!0,this.$API.get(this.$URL.getdataServiceDetailValue+"?conId="+this.form2.connectId+"&dbName="+this.form2.dbName+"&tableName="+this.form2.tableName+"&tablefield="+e.row.fieldName+"&tableValue="+t,{},(function(e){a.loading=!1,a.ShowOptionsList=e.data.map((function(e){return{label:e,value:e}}))})))},getServiceRuleList:function(){this.$API.get(this.$URL.getServiceRuleList,{},(function(e){if(0==e.code)for(var t in e.data);}))},validatorOfTimeOut:function(e,t,a){t>12e5?a(new Error("超时时间不能超过1200000ms")):t<3e3?a(new Error("最小时间不能小于3000ms")):a()},getTableInfoListDataTypesFocus:function(){this.getTableInfoListDataTypes(3)},changeRequestType:function(e,t){"string"==t.paramType&&"STRING"==t.paramType&&"VARCHAR"==t.paramType&&"varchar"==t.paramType||(this.form4.requestParamsList[t.$index].isMultiple=0)},init:function(){this.getServeLimitDictionary(),this.getGroupServiceUrl(),this.getTenantListOther(),"edit"===localStorage.dataServiceNewOrEdit&&(this.getDataServiceDetailById(),this.getTableInfoListDataTypes(3))},getTenantListOther:(S=Object(i.a)(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.$API.get(this.$URL.getTenantListOther,{},(function(e){0==e.code?t.tenantList=e.data:t.$message.error(e.msg)}));case 1:case"end":return e.stop()}}),e,this)}))),function(){return S.apply(this,arguments)}),getDataServiceDetailById:(L=Object(i.a)(regeneratorRuntime.mark((function e(){var t,a,r,i,s,l=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=localStorage.dataServiceId,e.next=3,Object(n.z)({id:t});case 3:a=e.sent,r=a.data,i=r.code,s=r.data,0===i&&(this.editDetail=s,null==this.editDetail.dataServiceRuleList&&(this.editDetail.dataServiceRuleList=[]),this.editDetail.dataServiceRuleList.forEach((function(e){if(e.ruleValueList&&e.ruleValueList.length)if(["属于","不属于"].includes(e.ruleCondition)&&!["INT","FLOAT","DOUBLE","BIGINT"].includes(e.fieldType?e.fieldType.toLocaleUpperCase():e.fieldType))e.ruleValueList.push(e.ruleValue)&&e.ruleValueList.splice(e.ruleValueList.length-1,1);else if(["属于","不属于"].includes(e.ruleCondition)){var t=e.ruleValue,a=t.indexOf("<"),r=t.lastIndexOf("<");l.$set(e,"intValue1",Number(t.slice(0,a))),t.indexOf("=")==a+1?l.$set(e,"intValue2","<="):l.$set(e,"intValue2","<"),t.lastIndexOf("=")==r+1?(l.$set(e,"intValue3","<="),l.$set(e,"intValue4",Number(t.slice(r+2)))):(l.$set(e,"intValue3","<"),l.$set(e,"intValue4",Number(t.slice(r+1))))}else e.ruleValueList=e.ruleValue}))&&this.getTableInfoListDataTypes(this.editDetail.dataType||3),this.initForm());case 8:case"end":return e.stop()}}),e,this)}))),function(){return L.apply(this,arguments)}),initForm:(T=Object(i.a)(regeneratorRuntime.mark((function e(){var t,a,r,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.form1.isExtendToken=this.editDetail.isExtendToken,this.form1.requestType=this.editDetail.requestType,this.form1.serviceDescription=this.editDetail.serviceDescription,this.form1.serviceName=this.editDetail.serviceName,this.form1.serviceTimeOut=this.editDetail.serviceTimeOut,this.form1.tenantId=this.editDetail.tenantId,this.form1.reTry=null===this.editDetail.reTry?void 0:this.editDetail.reTry,this.form1.reTrySec=null===this.editDetail.reTrySec?void 0:this.editDetail.reTrySec,this.serviceType=this.editDetail.serviceType,1!==this.serviceType){e.next=33;break}return this.form2.connectId=this.editDetail.connectId,e.next=13,this.getDataserviceDataBase();case 13:return this.form2.dbName=this.editDetail.dbName,e.next=16,this.getDataServiceTables();case 16:return this.form2.tableName=this.editDetail.fieldDTO.tableName,e.next=19,this.getDataServiceTableStructure();case 19:this.editDetail.fieldDTO.tableFieldList.forEach((function(e){i.tableFieldList.find((function(t){return t.fieldName===e.fieldName})).paramType=e.paramType})),this.multiSelectionRows=this.tableFieldList.filter((function(e){return-1!==i.editDetail.fieldDTO.tableFieldList.map((function(e){return e.fieldName})).indexOf(e.fieldName)})),this.multiSelectionRows.forEach((function(e){i.$refs.multipleTable.toggleRowSelection(e)})),this.form3.backParmasList=this.editDetail.returnParams,this.form3.requestParamsList=this.editDetail.params,this.form3.valueRangType=this.editDetail.valueRangType,this.form3.valueRang=this.editDetail.valueRang,this.form3.dataServiceRuleList=this.editDetail.dataServiceRuleList,t=o(this.form3.dataServiceRuleList);try{for(r=function(){var e,t=a.value,r=null===(e=i.tableFieldList.find((function(e){return e.fieldName===t.fieldName})))||void 0===e?void 0:e.fieldType;["INT","BIGINT","FLOAT","DOUBLE","BOOLEAN","DECIMAL","DATE","DATETIME","TIMESTAMP","TINYINT","SMALLINT","MEDIUMINT"].includes(r?r.toLocaleUpperCase():r)?i.$set(t,"operatorList",i.operatorList1):i.$set(t,"operatorList",i.operatorList)},t.s();!(a=t.n()).done;)r()}catch(e){t.e(e)}finally{t.f()}this.form3.enableRule=this.editDetail.dataServiceRuleList[0].enableRule,this.form3.actionModeRule=this.editDetail.dataServiceRuleList[0].actionModeRule,e.next=34;break;case 33:2===this.serviceType&&(this.form4.dbType=this.editDetail.dataSourceTypeId,this.form4.connectId=this.editDetail.connectId,this.form4.requestParamsList=this.editDetail.params,this.form4.responseParmasList=this.editDetail.returnParams,this.form4.requestSql=this.editDetail.requestSql);case 34:case"end":return e.stop()}}),e,this)}))),function(){return T.apply(this,arguments)}),backToServiceList:function(){this.$refs.form1&&this.$refs.form1.resetFields(),this.$refs.form2&&this.$refs.form2.resetFields(),this.$refs.form3&&this.$refs.form3.resetFields(),this.$refs.form4&&this.$refs.form4.resetFields(),this.$router.push("/dataServiceList")},closeFun:function(){this.isShowTest=!1,this.backToServiceList()},nextStep:(x=Object(i.a)(regeneratorRuntime.mark((function e(){var t,a,r,i,s,l,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.activeIndex){e.next=24;break}if("new"!==localStorage.dataServiceNewOrEdit){e.next=14;break}return e.next=5,Object(n.c)({serviceName:this.form1.serviceName});case 5:if(t=e.sent,a=t.data,r=a.msg,0===a.code){e.next=12;break}return this.$message.error(r),e.abrupt("return");case 12:e.next=23;break;case 14:return e.next=16,Object(n.c)({serviceName:this.form1.serviceName,id:localStorage.dataServiceId});case 16:if(i=e.sent,s=i.data,l=s.msg,0===s.code){e.next=23;break}return this.$message.error(l),e.abrupt("return");case 23:this.$refs.form1.validate((function(e){if(!e)return!1;2==o.form1.serviceDetailType?(o.serviceType=2,o.$message.success("操作成功"),o.activeIndex++):1==o.form1.serviceDetailType&&(o.activeIndex++,o.getDataServiceDataSourceType(),o.getDataServiceDataSource())}));case 24:case"end":return e.stop()}}),e,this)}))),function(){return x.apply(this,arguments)}),preStep:function(){this.activeIndex--},handleSelectionChange:function(e){var t=this;e.map((function(e){t.showFieldType=e.fieldType,t.fieldTypeName=e.fieldName})),this.multiSelectionRows=e,this.handleRowChange(e)},indexMethod:function(e){return e+1},handleSelectedRowChange:function(e){if(this.fieldType=e.fieldType,this.multiSelectionRows.find((function(t){return t.fieldName===e.fieldName})))switch(e.paramType){case 1:this.form3.requestParamsList.find((function(t){return t.bindingField===e.fieldName}))||this.form3.requestParamsList.push({paramName:"",bindingField:e.fieldName,paramPosition:this.paramPosition,isRequired:1,isFuzzy:0,regular:"",paramType:e.fieldType,defaultValue:"",paramDesc:""}),this.form3.backParmasList.find((function(t){return t.bindingField===e.fieldName}))&&this.form3.backParmasList.splice(this.form3.backParmasList.findIndex((function(t){return t.bindingField===e.fieldName})),1);break;case 2:this.form3.requestParamsList.find((function(t){return t.bindingField===e.fieldName}))&&this.form3.requestParamsList.splice(this.form3.requestParamsList.findIndex((function(t){return t.bindingField===e.fieldName})),1),this.form3.backParmasList.find((function(t){return t.bindingField===e.fieldName}))||this.form3.backParmasList.push({paramName:"",bindingField:e.fieldName,paramType:e.fieldType,defaultValue:"",paramDesc:""});break;case 3:this.form3.backParmasList.find((function(t){return t.bindingField===e.fieldName}))||this.form3.backParmasList.push({paramName:"",bindingField:e.fieldName,paramType:e.fieldType,defaultValue:"",paramDesc:""}),this.form3.requestParamsList.find((function(t){return t.bindingField===e.fieldName}))||this.form3.requestParamsList.push({paramName:"",bindingField:e.fieldName,paramPosition:this.paramPosition,isRequired:1,isFuzzy:0,regular:"",isMultiple:0,paramType:e.fieldType,defaultValue:"",paramDesc:""})}},handleRowChange:function(e){var t=this;e.forEach((function(e){switch(e.paramType){case 2:t.form3.backParmasList.find((function(t){return t.bindingField===e.fieldName}))||t.form3.backParmasList.push({paramName:"",bindingField:e.fieldName,paramType:e.fieldType,defaultValue:"",paramDesc:""});break;case 1:t.form3.requestParamsList.find((function(t){return t.bindingField===e.fieldName}))||t.form3.requestParamsList.push({paramName:"",bindingField:e.fieldName,paramPosition:t.paramPosition,isRequired:1,isFuzzy:0,isMultiple:0,regular:"",paramType:e.fieldType,defaultValue:"",paramDesc:""});break;case 3:t.form3.requestParamsList.find((function(t){return t.bindingField===e.fieldName}))||t.form3.requestParamsList.push({paramName:"",bindingField:e.fieldName,paramPosition:t.paramPosition,isRequired:1,isFuzzy:0,isMultiple:0,regular:"",paramType:e.fieldType,defaultValue:"",paramDesc:""}),t.form3.backParmasList.find((function(t){return t.bindingField===e.fieldName}))||t.form3.backParmasList.push({paramName:"",bindingField:e.fieldName,paramType:e.fieldType,defaultValue:"",paramDesc:""})}}));for(var a=function(e){var a=t.form3.requestParamsList[e];t.multiSelectionRows.find((function(e){return e.fieldName===a.bindingField}))||"page_size"===a.paramName||"page_num"===a.paramName||t.form3.requestParamsList.splice(t.form3.requestParamsList.findIndex((function(e){return e.bindingField===a.bindingField})),1)},r=this.form3.requestParamsList.length-1;r>=0;r--)a(r);for(var i=function(e){var a=t.form3.backParmasList[e];t.multiSelectionRows.find((function(e){return e.fieldName===a.bindingField}))||t.form3.backParmasList.splice(t.form3.backParmasList.findIndex((function(e){return e.bindingField===a.bindingField})),1)},n=this.form3.backParmasList.length-1;n>=0;n--)i(n)},upwards:function(e){0!==e.$index&&(this.form3.backParmasList.splice(e.$index,1),this.form3.backParmasList.splice(e.$index-1,0,e.row))},downwards:function(e){e.$index!==this.form3.backParmasList.length-1&&(this.form3.backParmasList.splice(e.$index,1),this.form3.backParmasList.splice(e.$index+1,0,e.row))},deleteBackParams:function(e){this.form3.backParmasList.splice(e.$index,1);var t=this.tableFieldList.find((function(t){return t.fieldName===e.row.bindingField}));this.form3.requestParamsList.find((function(t){return t.bindingField===e.row.bindingField}))?t.paramType=1:this.$refs.multipleTable.toggleRowSelection(t)},deleteRequestParams:function(e){this.form3.requestParamsList.splice(e.$index,1);var t=this.tableFieldList.find((function(t){return t.fieldName===e.row.bindingField}));this.form3.backParmasList.find((function(t){return t.bindingField===e.row.bindingField}))?t.paramType=2:this.$refs.multipleTable.toggleRowSelection(t)},addRequestParams1:function(){this.form3.dataServiceRuleList.push({permissionRule:"",fieldName:"",ruleCondition:"",ruleValueList:[]})},deleteForm3Params:function(e){this.form3.dataServiceRuleList.splice(e.$index,1)},addRequestParams:function(){this.form4.requestParamsList.push({paramName:"",paramPosition:this.paramPosition,isRequired:17==this.form4.dbType?1:null,paramType:null,defaultValue:"",regular:"",isFuzzy:0,isMultiple:0})},addResponseParams:function(){this.form4.responseParmasList.push({paramName:"",paramType:null,defaultValue:"",paramDesc:""})},deleteRequestParamsSql:function(e){this.form4.requestParamsList.splice(e.$index,1)},deleteResponseParams:function(e){this.form4.responseParmasList.splice(e.$index,1)},clearRequestSQL:function(){this.form4.requestSql=""},handleSave:function(){var e=this,t=localStorage.dataServiceNewOrEdit,a=!1,r=!1;1===this.serviceType?(this.$refs.form2.validate((function(e){if(!e)return!1;a=!0})),this.$refs.form3.validate((function(e){if(!e)return!1;r=!0})),this.$nextTick((function(){a&&r&&("new"===t?e.addDataService():"edit"===t&&e.editDataService())}))):2===this.serviceType&&this.$refs.form4.validate((function(a){if(!a)return!1;"new"===t?e.addDataService():"edit"===t&&e.editDataService()}))},editDataService:(w=Object(i.a)(regeneratorRuntime.mark((function e(){var t,a,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=localStorage.dataServiceId,a=localStorage.dataServiceGroupId,0!==this.form3.backParmasList.length||1!==this.serviceType){e.next=5;break}return this.$message.error("请选择字段作为返回参数"),e.abrupt("return");case 5:return this.btnState=!0,this.form3.dataServiceRuleList.forEach((function(e){["属于","不属于"].includes(e.ruleCondition)&&["INT","FLOAT","DOUBLE","BIGINT"].includes(e.fieldType?e.fieldType.toLocaleUpperCase():e.fieldType)?e.ruleValueList=["".concat(e.intValue1).concat(e.intValue2).concat(e.fieldName).concat(e.intValue3).concat(e.intValue4)]:["属于","不属于"].includes(e.ruleCondition)&&!["INT","FLOAT","DOUBLE","BIGINT"].includes(e.fieldType?e.fieldType.toLocaleUpperCase():e.fieldType)?e.ruleValueList=e.ruleValueList:e.ruleValueList=Array.isArray(e.ruleValueList)?e.ruleValueList:[e.ruleValueList]})),e.prev=7,e.next=10,Object(n.t)(l(l({id:t,groupId:a},this.form1),{},{enableRule:this.form3.enableRule,actionModeRule:this.form3.actionModeRule,requestSql:this.form4.requestSql,params:1===this.serviceType?this.form3.requestParamsList:this.form4.requestParamsList,returnParams:1===this.serviceType?this.form3.backParmasList:this.form4.responseParmasList,fieldDTO:{tableName:this.form2.tableName,tableFieldList:this.multiSelectionRows},dataServiceRuleList:this.form3.dataServiceRuleList||[],tableName:this.form3.dataServiceRuleList?this.form3.dataServiceRuleList.forEach((function(e){e.tableName=r.form2.tableName||""})):"",serviceType:this.serviceType,connectId:1===this.serviceType?this.form2.connectId:this.form4.connectId,valueRangType:this.form3.valueRangType,valueRang:this.form3.valueRang,dbName:1===this.serviceType?this.form2.dbName:null}));case 10:0===e.sent.data.code&&this.$confirm("保存成功，是否进行测试?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"success"}).then((function(){r.isShowTest=!0,r.serviceId=parseInt(t)})).catch((function(){r.backToServiceList()}));case 13:return e.prev=13,this.btnState=!1,e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[7,,13,16]])}))),function(){return w.apply(this,arguments)}),addDataService:(y=Object(i.a)(regeneratorRuntime.mark((function e(){var t,a,r,i,s,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=localStorage.dataServiceGroupId,0!==this.form3.backParmasList.length||1!==this.serviceType){e.next=4;break}return this.$message.error("请选择字段作为返回参数"),e.abrupt("return");case 4:return this.btnState=!0,this.form3.dataServiceRuleList.forEach((function(e){["属于","不属于"].includes(e.ruleCondition)&&["INT","FLOAT","DOUBLE","BIGINT"].includes(e.fieldType?e.fieldType.toLocaleUpperCase():e.fieldType)?e.ruleValueList=["".concat(e.intValue1).concat(e.intValue2).concat(e.fieldName).concat(e.intValue3).concat(e.intValue4)]:["属于","不属于"].includes(e.ruleCondition)&&!["INT","FLOAT","DOUBLE","BIGINT"].includes(e.fieldType?e.fieldType.toLocaleUpperCase():e.fieldType)?e.ruleValueList=e.ruleValueList:e.ruleValueList=Array.isArray(e.ruleValueList)?e.ruleValueList:[e.ruleValueList]})),e.prev=6,e.next=9,Object(n.a)(l(l({groupId:t},this.form1),{},{enableRule:this.form3.enableRule,actionModeRule:this.form3.actionModeRule,requestSql:this.form4.requestSql,params:1===this.serviceType?this.form3.requestParamsList:this.form4.requestParamsList,returnParams:1===this.serviceType?this.form3.backParmasList:this.form4.responseParmasList,fieldDTO:{tableName:this.form2.tableName,tableFieldList:this.multiSelectionRows},dataServiceRuleList:this.form3.dataServiceRuleList||[],tableName:this.form3.dataServiceRuleList.forEach((function(e){e.tableName=o.form2.tableName})),serviceType:this.serviceType,connectId:1===this.serviceType?this.form2.connectId:this.form4.connectId,valueRangType:this.form3.valueRangType,valueRang:this.form3.valueRang,dbName:1===this.serviceType?this.form2.dbName:null}));case 9:a=e.sent,r=a.data,i=r.code,s=r.data,0===i&&this.$confirm("保存成功，是否进行测试?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"success"}).then((function(){o.isShowTest=!0,o.serviceId=parseInt(s)})).catch((function(){o.backToServiceList()}));case 14:return e.prev=14,this.btnState=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[6,,14,17]])}))),function(){return y.apply(this,arguments)}),handleServiceTypeChange:function(e){this.form4.dbType="",this.dataBaseList=[],this.dataTableList=[],this.getDataServiceDataSourceType(),this.getDataServiceDataSource()},getGroupServiceUrl:(g=Object(i.a)(regeneratorRuntime.mark((function e(){var t,a,r,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=localStorage.dataServiceGroupId,e.next=3,Object(n.J)(t);case 3:a=e.sent,r=a.data,i=r.code,s=r.data,0===i&&(this.form1.servicePath="/"+s);case 8:case"end":return e.stop()}}),e,this)}))),function(){return g.apply(this,arguments)}),getDataServiceDataSourceType:(h=Object(i.a)(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.$API.get(this.$URL.getDataServiceDataSourceType,{},(function(e){0==e.code?(t.dataDbtypeList=[],t.dataTypeList1={},e.data.forEach((function(e){t.dataTypeList1[e.id]=e.dataType,t.dataDbtypeList.push({label:e.type,value:e.id})}))):t.$message.error(e.msg)}));case 1:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)}),dbTypeChang:function(e){0==e?this.getTableInfoListDataTypes(1):(this.getTableInfoListDataTypes(3),this.form4.requestParamsList.map((function(e){"DECIMAL"==e.paramType&&(e.paramType="")})),this.form4.responseParmasList.map((function(e){"DECIMAL"!=e.paramType&&"ARRAY<STRING>"!=e.paramType&&"MAP<STRING,STRING>"!=e.paramType||(e.paramType="")}))),this.form4.connectId=null,17==this.form4.dbType&&this.form4.requestParamsList.map((function(e){e.isRequired=1})),this.getDataServiceDataSource()},getDataServiceDataSource:(v=Object(i.a)(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(2!=this.serviceType||""!==this.form4.dbType){e.next=3;break}return this.dataSourceList=[],e.abrupt("return");case 3:this.$API.get(this.$URL.getDataServiceDataSource+"?serverType="+this.serviceType+"&dbType="+this.form4.dbType,{},(function(e){0==e.code?(t.dataTypeList={},t.dataSourceList=[],e.data.forEach((function(e){t.dataTypeList[e.id]=e.dataType,t.dataSourceList.push({label:e.name,value:e.id})}))):t.$message.error(e.msg)}));case 4:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)}),changeForm4Connect:function(){},getDataserviceDataBase:(b=Object(i.a)(regeneratorRuntime.mark((function e(){var t,a,r,i,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.getTableInfoListDataTypes(this.dataTypeList[this.form2.connectId]),e.next=3,Object(n.I)({conId:this.form2.connectId});case 3:t=e.sent,a=t.data,r=a.code,i=a.data,0===r&&(this.dataBaseList=[],this.form2.dbName=null,this.form2.tableName=null,this.tableFieldList=[],i.forEach((function(e){s.dataBaseList.push({label:e,value:e})})));case 8:case"end":return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)}),getSQLmodeDataBase:(f=Object(i.a)(regeneratorRuntime.mark((function e(){var t,a,r,i,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(n.I)({conId:this.form4.connectId});case 2:t=e.sent,a=t.data,r=a.code,i=a.data,0===r&&(this.dataBaseList=[],this.form4.dbName=null,i.forEach((function(e){s.dataBaseList.push({label:e,value:e})})));case 7:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)}),getDataServiceTables:(m=Object(i.a)(regeneratorRuntime.mark((function e(){var t,a,r,i,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(n.H)({dbName:this.form2.dbName,conId:this.form2.connectId});case 2:t=e.sent,a=t.data,r=a.code,i=a.data,0===r&&(this.dataTableList=[],this.form2.tableName=null,this.tableFieldList=[],i.forEach((function(e){s.dataTableList.push({label:e,value:e})})));case 7:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)}),getSQLmodeTables:(p=Object(i.a)(regeneratorRuntime.mark((function e(){var t,a,r,i,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(n.H)({dbName:this.form4.dbName,conId:this.form4.connectId});case 2:t=e.sent,a=t.data,r=a.code,i=a.data,0===r&&(this.dataTableList=[],this.form4.tableNames=[],i.forEach((function(e){s.dataTableList.push({label:e,value:e})})));case 7:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)}),getDataServiceTableStructure:(d=Object(i.a)(regeneratorRuntime.mark((function e(){var t,a,r,i,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(n.G)({dbName:this.form2.dbName,conId:this.form2.connectId,tableName:this.form2.tableName});case 2:t=e.sent,a=t.data,r=a.code,i=a.data,0===r&&(this.tableFieldList=[],i.forEach((function(e){s.tableFieldList.push(l(l({},e),{},{paramType:3}))})));case 7:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)}),getTableInfoListDataTypes:(u=Object(i.a)(regeneratorRuntime.mark((function e(t){var a,r,i,s,l=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Object(n.M)(t);case 4:a=e.sent,r=a.data,i=r.code,s=r.data,0===i&&(this.paramsTypeList=[],this.paramsTypeList1=[],s.forEach((function(e){l.paramsTypeList.push({label:e,value:e}),e.toLocaleUpperCase().includes("ARRAY")||e.toLocaleUpperCase().includes("MAP")||l.paramsTypeList1.push({label:e,value:e})})),this.paramsTypeList=this.paramsTypeList.filter((function(e){return"SQLINJECT"!=e.value})));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)}),handleIsRequiredChange:function(e,t){"page_size"===t.paramName?this.form3.requestParamsList.find((function(e){return"page_num"===e.paramName})).isRequired=e:"page_num"===t.paramName&&(this.form3.requestParamsList.find((function(e){return"page_size"===e.paramName})).isRequired=e)}},watch:{"form1.serviceDetailType":{handler:function(e,t){2==e&&(this.form1.tenantId=[])},deep:!0},"form2.tableName":{handler:function(e,t){this.form3.dataServiceRuleList=[]},deep:!0},"form1.requestType":function(){var e=this;this.form3.requestParamsList.forEach((function(t){t.paramPosition=e.paramPosition})),this.form4.requestParamsList.forEach((function(t){t.paramPosition=e.paramPosition}))}}},R=(a("97fc"),a("2877")),N=Object(R.a)(_,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"new-service-container"},[t("div",{staticClass:"new-service zt-scrollbar"},[t("div",{staticClass:"new-service-top"},[t("div",{staticClass:"top-right"},[e._v("\n        "+e._s("edit"===e.status?"编辑服务":"新建服务")+"\n      ")])]),t("div",{staticClass:"new-service-content"},[t("el-steps",{staticClass:"steps",attrs:{active:e.activeIndex,"finish-status":"success"}},[t("el-step",{attrs:{title:"配置API信息"}}),t("el-step",{attrs:{title:"配置数据和参数"}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:0===e.activeIndex,expression:"activeIndex === 0"}],staticClass:"api-detail"},[t("el-form",{ref:"form1",staticClass:"form1",attrs:{model:e.form1,"label-position":"left","label-width":"140px"}},[t("div",{staticClass:"form-title"},[e._v("基本信息")]),t("el-form-item",{attrs:{label:"服务类型：",prop:"serveType",required:""}},[t("el-tooltip",{staticClass:"tooltip",attrs:{placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n                            公共：公共服务不需要授权，默认对外开放，创建完成后可直接在服务集市查询并调用"),t("br"),e._v("\n                            定制：定制服务需要服务创建者发布后才能在集市中查询到，用户申请授权，通过后才能使用"),t("br")]),t("i",{staticClass:"el-icon-question"})]),t("el-radio-group",{model:{value:e.form1.serviceDetailType,callback:function(t){e.$set(e.form1,"serviceDetailType",t)},expression:"form1.serviceDetailType"}},[t("el-radio",{attrs:{label:1,disabled:-4==e.$route.query.connectId}},[e._v("定制")]),t("el-radio",{attrs:{label:2,disabled:-1==e.$route.query.connectId}},[e._v("公共")])],1)],1),t("el-form-item",{attrs:{prop:"serviceName",label:"数据服务名称：",rules:[{required:!0,message:"请输入数据服务名称",trigger:"blur"},{max:20,min:2,message:"请输入2-20字符串",trigger:"blur"},{pattern:/^[\u4E00-\u9FA5a-zA-Z0-9_]*$/,message:"请输入中英文，数字，或下划线",trigger:"blur"}]}},[t("el-input",{attrs:{placeholder:"请输入中英文，数字，或下划线"},model:{value:e.form1.serviceName,callback:function(t){e.$set(e.form1,"serviceName",t)},expression:"form1.serviceName"}})],1),t("el-form-item",{attrs:{prop:"servicePath",label:"服务组路径：",rules:[{required:!0,message:"请输入服务组路径",trigger:"blur"}]}},[t("el-input",{attrs:{disabled:""},model:{value:e.form1.servicePath,callback:function(t){e.$set(e.form1,"servicePath",t)},expression:"form1.servicePath"}})],1),t("el-form-item",{attrs:{prop:"serviceDescription",label:"描述：",rules:[{required:!0,message:"请输入描述",trigger:"blur"},{max:200,min:1,message:"请输入1-200字符",trigger:"blur"}]}},[t("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入描述，1-200字符"},model:{value:e.form1.serviceDescription,callback:function(t){e.$set(e.form1,"serviceDescription",t)},expression:"form1.serviceDescription"}})],1),t("div",{staticClass:"form-title"},[e._v("API参数")]),t("el-form-item",{attrs:{prop:"requestWay",label:"请求类型：",rules:[{required:!0,message:"请选择请求类型",trigger:"blur"}]}},[t("el-select",{attrs:{placeholder:"请选择请求类型："},model:{value:e.form1.requestWay,callback:function(t){e.$set(e.form1,"requestWay",t)},expression:"form1.requestWay"}},e._l(e.requestTypeList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"请求方式：",prop:"requestType",required:""}},[t("el-radio-group",{model:{value:e.form1.requestType,callback:function(t){e.$set(e.form1,"requestType",t)},expression:"form1.requestType"}},[t("el-radio",{attrs:{label:0}},[e._v("GET")]),t("el-radio",{attrs:{label:1}},[e._v("POST")])],1)],1),t("el-form-item",{attrs:{label:"返回类型："}},[t("div",[e._v("JSON")])]),t("el-form-item",{attrs:{prop:"serviceTimeOut",label:"超时时间：",rules:[{required:!0,message:"请输入超时时间",trigger:"blur"},{pattern:/^[1-9]{1}[0-9]*$/,message:"请输入正整数"},{validator:e.validatorOfTimeOut,trigger:"change"}]}},[t("el-input",{attrs:{placeholder:"默认3000"},model:{value:e.form1.serviceTimeOut,callback:function(t){e.$set(e.form1,"serviceTimeOut",t)},expression:"form1.serviceTimeOut"}},[t("template",{slot:"append"},[e._v("ms")])],2)],1),t("div",{staticClass:"form-title"},[e._v("权限配置")]),t("el-form-item",{attrs:{prop:"isExtendToken",label:"继承服务组token:",required:""}},[t("el-radio-group",{model:{value:e.form1.isExtendToken,callback:function(t){e.$set(e.form1,"isExtendToken",t)},expression:"form1.isExtendToken"}},[t("el-radio",{attrs:{label:1}},[e._v("是")]),t("el-radio",{attrs:{label:2}},[e._v("否")])],1)],1),t("el-form-item",{attrs:{label:"授权租户：",prop:"roleName"}},[t("el-select",{attrs:{disabled:2==e.form1.serviceDetailType,multiple:""},model:{value:e.form1.tenantId,callback:function(t){e.$set(e.form1,"tenantId",t)},expression:"form1.tenantId"}},e._l(e.tenantList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("div",{staticClass:"form-title"},[e._v("后端重试策略")]),t("el-form-item",{attrs:{label:"失败重新请求次数：",prop:"reTry"}},[t("el-tooltip",{staticClass:"tooltip",staticStyle:{"margin-left":"40px"},attrs:{placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n                            1、失败重试的默认次数为"+e._s(e.dicDetail?e.dicDetail.retryCall:3)),t("br"),e._v("\n                            2、失败重试的最大次数为"+e._s(e.dicDetail?e.dicDetail.retryCallMax:10)),t("br")]),t("i",{staticClass:"el-icon-question"})]),t("el-input-number",{staticStyle:{width:"400px","margin-left":"-50px"},attrs:{step:1,"controls-position":"right",max:e.dicDetail?e.dicDetail.retryCallMax:10,min:0},model:{value:e.form1.reTry,callback:function(t){e.$set(e.form1,"reTry",t)},expression:"form1.reTry"}})],1),t("el-form-item",{attrs:{label:"重试间隔：",prop:"reTrySec"}},[t("el-tooltip",{staticClass:"tooltip",staticStyle:{"margin-left":"0"},attrs:{placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n                            1、重试间隔默认为"+e._s(e.dicDetail?e.dicDetail.retryInterval:3)+"秒"),t("br"),e._v("\n                            2、重试间隔最大为"+e._s(e.dicDetail?e.dicDetail.retryIntervalMax:360)+"秒"),t("br")]),t("i",{staticClass:"el-icon-question"})]),t("el-input-number",{staticClass:"dicdeta",staticStyle:{width:"400px","margin-left":"-10px"},attrs:{step:1,"controls-position":"right",max:e.dicDetail?e.dicDetail.retryIntervalMax:360,min:1},model:{value:e.form1.reTrySec,callback:function(t){e.$set(e.form1,"reTrySec",t)},expression:"form1.reTrySec"}}),t("span",{staticStyle:{"margin-left":"5px"}},[e._v("秒")])],1)],1)],1),t("div",{directives:[{name:"show",rawName:"v-show",value:1===e.activeIndex,expression:"activeIndex === 1"}],staticClass:"data-params"},[2==e.form1.serviceDetailType&&0!=e.$route.query.connectId?t("div",[t("i",{staticClass:"el-icon-warning"}),t("span",[e._v("公共API默认生成方式为SQL模式，默认使用东智平台的数据库表，请根据实际库表指定其请求参数和返回参数")])]):e._e(),t("label",{staticStyle:{width:"100px",display:"inline-block","margin-bottom":"30px"}},[e._v("生成方式：")]),t("el-select",{ref:"mySelect",staticClass:"service-type",staticStyle:{padding:"10px 0 10px 10px"},attrs:{disabled:2==e.form1.serviceDetailType,placeholder:"请选择生成方式："},on:{change:e.handleServiceTypeChange},model:{value:e.serviceType,callback:function(t){e.serviceType=t},expression:"serviceType"}},e._l(e.serviceTypeList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1),1===e.serviceType?t("div",{staticClass:"guide-mode"},[t("div",{staticClass:"guide-left"},[t("div",{staticClass:"data-source-set"},[t("div",{staticClass:"content-title"},[e._v("数据源配置")]),t("div",{staticClass:"source-content"},[t("el-form",{ref:"form2",staticClass:"form2",attrs:{model:e.form2,"label-position":"left","label-width":"80px"}},[t("el-form-item",{attrs:{prop:"connectId",label:"数据源：",rules:[{required:!0,message:"请选择数据源",trigger:"change"}]}},[t("el-select",{attrs:{filterable:"",placeholder:"请选择数据源，仅支持单选"},on:{change:e.getDataserviceDataBase},model:{value:e.form2.connectId,callback:function(t){e.$set(e.form2,"connectId",t)},expression:"form2.connectId"}},e._l(e.dataSourceList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1),t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"支持的数据源类型：默认hive、默认implala、MySQL、Oracle、SQL Server、ClickHouse、mongoDB",placement:"top-start"}},[t("i",{staticClass:"icon icon-ic_remind",staticStyle:{position:"relative",left:"-12px","line-height":"32px"}})])],1),t("el-form-item",{attrs:{prop:"dbName",label:"数据库：",rules:[{required:!0,message:"请选择数据库",trigger:"change"}]}},[t("el-select",{attrs:{filterable:"",placeholder:"请选择数据库，仅支持单选"},on:{change:e.getDataServiceTables},model:{value:e.form2.dbName,callback:function(t){e.$set(e.form2,"dbName",t)},expression:"form2.dbName"}},e._l(e.dataBaseList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{prop:"tableName",label:"数据表：",rules:[{required:!0,message:"请选择数据表",trigger:"change"}]}},[t("el-select",{attrs:{filterable:"",placeholder:"请选择数据表，仅支持单选"},on:{change:e.getDataServiceTableStructure},model:{value:e.form2.tableName,callback:function(t){e.$set(e.form2,"tableName",t)},expression:"form2.tableName"}},e._l(e.dataTableList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1)]),t("div",{staticClass:"data-params-set"},[t("div",{staticClass:"content-title"},[e._v("数据字段配置")]),t("div",{staticClass:"params-content"},[t("div",{staticClass:"title"},[e._v("已选择表："+e._s(this.form2.tableName))]),t("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{size:"mini","max-height":"400px",data:e.tableFieldList,width:"100%"},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection"}}),t("el-table-column",{attrs:{label:"字段名称",prop:"fieldName"}}),t("el-table-column",{attrs:{label:"字段类型",prop:"fieldType","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{label:"业务含义",prop:"fieldDesc"}}),t("el-table-column",{attrs:{label:"参数类型",prop:"paramType",width:"120px",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){var r=a.row;return[t("el-select",{attrs:{size:"mini"},on:{change:function(t){return e.handleSelectedRowChange(r)}},model:{value:r.paramType,callback:function(t){e.$set(r,"paramType",t)},expression:"row.paramType"}},e._l(e.paramTypeList,(function(e,a){return t("el-option",{key:a,attrs:{disabled:("ARRAY"==r.fieldType||"MAP"==r.fieldType)&&1==e.value,label:e.label,value:e.value}})})),1)]}}],null,!1,3578704623)})],1)],1)])]),t("div",{staticClass:"guide-right"},[t("el-form",{ref:"form3",attrs:{model:e.form3}},[t("div",{staticClass:"content-title"},[e._v("参数配置")]),t("div",{staticClass:"guild-right-content"},[t("div",{staticClass:"back-params"},[t("div",[e._v("返回参数：")]),t("el-table",{attrs:{data:e.form3.backParmasList,size:"mini","max-height":"200px"}},[t("el-table-column",{attrs:{type:"index",label:"序号",index:e.indexMethod}}),t("el-table-column",{attrs:{label:"参数名称",prop:"paramName"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-form-item",{attrs:{prop:"backParmasList."+a.$index+".paramName",rules:[{pattern:/^[a-zA-Z]{1}[a-zA-Z0-9_]*$/,message:"英文开头，数字，下划线组合",trigger:"blur"},{max:20,min:2,message:"2-20个字符",trigger:"blur"},{required:!0,message:"请输入字段名称",trigger:"blur"}]}},[t("el-input",{model:{value:a.row.paramName,callback:function(t){e.$set(a.row,"paramName",t)},expression:"scope.row.paramName"}})],1)]}}],null,!1,2452327260)}),t("el-table-column",{attrs:{label:"绑定字段",prop:"bindingField"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(t.row.bindingField)+"\n                      ")]}}],null,!1,772442430)}),t("el-table-column",{attrs:{label:"参数类型",prop:"paramType"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(t.row.paramType)+"\n                        ")]}}],null,!1,1897413034)}),t("el-table-column",{attrs:{prop:"defaultValue",label:"示例值"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-form-item",{attrs:{prop:"backParmasList."+a.$index+".defaultValue",rules:[{max:20,min:1,message:"1-20个字符",trigger:"blur"},{pattern:e.dataTypeListRegExp[a.row.paramType],message:"类型错误",trigger:"blur"}]}},[t("el-input",{attrs:{placeholder:"请输入示例值"},model:{value:a.row.defaultValue,callback:function(t){e.$set(a.row,"defaultValue",t)},expression:"scope.row.defaultValue"}})],1)]}}],null,!1,991953323)},[t("template",{slot:"header"},[t("span",[e._v("示例值")]),e._v(" \n                        "),t("el-tooltip",{attrs:{effect:"dark",content:"API提供给别人时的参考值",placement:"top-start"}},[t("span",{staticClass:"icon"},[e._v("")])])],1)],2),t("el-table-column",{attrs:{label:"描述",prop:"paramDesc"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-form-item",{attrs:{prop:"backParmasList."+a.$index+".paramDesc",rules:[{max:20,min:2,message:"2-20个字符",trigger:"blur"}]}},[t("el-input",{attrs:{placeholder:"选填，2-20个字符"},model:{value:a.row.paramDesc,callback:function(t){e.$set(a.row,"paramDesc",t)},expression:"scope.row.paramDesc"}})],1)]}}],null,!1,1211069031)}),t("el-table-column",{attrs:{label:"操作",align:"right",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{disabled:1===e.form3.backParmasList.length||0===a.$index,type:"text"},on:{click:function(t){return e.upwards(a)}}},[e._v("上移")]),t("el-button",{attrs:{disabled:a.$index===e.form3.backParmasList.length-1||1===e.form3.backParmasList.length,type:"text"},on:{click:function(t){return e.downwards(a)}}},[e._v("下移")]),t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.deleteBackParams(a)}}},[e._v("删除")])]}}],null,!1,3695323273)})],1)],1),t("div",{staticClass:"request-params"},[t("div",[t("span",[e._v("请求参数：")]),t("el-tooltip",{attrs:{effect:"dark",content:"配置数据请求时body和query中的参数，get请求仅支持query，post请求仅支持body。",placement:"top-start"}},[t("span",{staticClass:"icon"},[e._v("")])])],1),t("el-table",{attrs:{data:e.form3.requestParamsList,size:"mini","max-height":"250px"}},[t("el-table-column",{attrs:{label:"参数名称",prop:"paramName",fixed:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-form-item",{attrs:{prop:"requestParamsList."+a.$index+".paramName",rules:[{pattern:/^[a-zA-Z]{1}[a-zA-Z0-9_]*$/,message:"英文开头，数字，下划线组合",trigger:"blur"},{max:20,min:2,message:"2-20个字符",trigger:"blur"},{required:!0,message:"请输入字段名称",trigger:"blur"}]}},[0!==a.$index&&1!==a.$index?t("el-input",{model:{value:a.row.paramName,callback:function(t){e.$set(a.row,"paramName",t)},expression:"scope.row.paramName"}}):t("span",{staticStyle:{"white-space":"nowrap"}},[e._v(e._s(a.row.paramName))])],1)]}}],null,!1,969770605)}),t("el-table-column",{attrs:{label:"绑定字段",prop:"bindingField"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{staticStyle:{"margin-bottom":"10px",display:"inline-block"}},[e._v(e._s(a.row.bindingField))])]}}],null,!1,2506841874)}),t("el-table-column",{attrs:{label:"参数位置",prop:"paramPosition",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-form-item",{attrs:{prop:"requestParamsList."+a.$index+".paramPosition",rules:[{required:!0,message:"请选择参数位置",trigger:"change"}]}},[t("el-select",{model:{value:a.row.paramPosition,callback:function(t){e.$set(a.row,"paramPosition",t)},expression:"scope.row.paramPosition"}},e._l(e.paramPositionList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1)],1)]}}],null,!1,2887324903)}),t("el-table-column",{attrs:{label:"参数类型",prop:"paramType",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(t.row.paramType)+"\n                        ")]}}],null,!1,1897413034)}),t("el-table-column",{attrs:{label:"是否必填",prop:"isRequired"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-form-item",{attrs:{prop:"requestParamsList."+a.$index+".isRequired",rules:[{required:!0,message:"请选择是否必填",trigger:"change"}]}},[t("el-select",{attrs:{disabled:"page_size"==a.row.paramName||"page_num"==a.row.paramName},on:{change:function(t){return e.handleIsRequiredChange(t,a.row)}},model:{value:a.row.isRequired,callback:function(t){e.$set(a.row,"isRequired",t)},expression:"scope.row.isRequired"}},e._l(e.isRequiredList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1)],1)]}}],null,!1,1442517839)}),t("el-table-column",{attrs:{label:"是否模糊查询",prop:"isFuzzy",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-form-item",{attrs:{prop:"requestParamsList."+a.$index+".isFuzzy",rules:[{required:!0,message:"是否模糊查询",trigger:"change"}]}},[t("el-select",{model:{value:a.row.isFuzzy,callback:function(t){e.$set(a.row,"isFuzzy",t)},expression:"scope.row.isFuzzy"}},e._l(e.form3.isConditionList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1)],1)]}}],null,!1,1835961424)}),t("el-table-column",{attrs:{label:"参数校验",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-form-item",{attrs:{rules:[{required:!0,message:"请求参数、字段不符合传参规范，请按传参要求使用",trigger:"blur"},{max:50,min:1,message:"1-50个字符",trigger:"blur"},{pattern:e.dataTypeListRegExp[a.row.regular],message:"输入".concat(a.row.regular,"类型"),trigger:"blur"}]}},[t("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入正则表达式"},model:{value:a.row.regular,callback:function(t){e.$set(a.row,"regular",t)},expression:"scope.row.regular"}})],1)]}}],null,!1,73742754)},[t("template",{slot:"header"},[t("span",[e._v("参数校验")]),e._v(" \n                      ")])],2),t("el-table-column",{attrs:{label:"是否批量传参",prop:"isMultiple",width:"130"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-form-item",{attrs:{prop:"requestParamsList."+a.$index+".isMultiple",rules:[{required:!0,message:"请选择是否必填",trigger:"change"}]}},[t("el-select",{attrs:{disabled:"varchar"!=a.row.paramType&&"string"!=a.row.paramType&&"STRING"!=a.row.paramType&&"VARCHAR"!=a.row.paramType||17==e.form4.dbType},model:{value:a.row.isMultiple,callback:function(t){e.$set(a.row,"isMultiple",t)},expression:"scope.row.isMultiple"}},e._l(e.isRequiredList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1)],1)]}}],null,!1,1480456603)},[t("template",{slot:"header"},[t("span",[e._v("是否批量传参")]),e._v(" \n                    "),t("el-tooltip",{attrs:{effect:"dark",content:"批量传参默认传递格式为JSON字符串",placement:"top-start"}},[t("span",{staticClass:"icon"},[e._v("")])])],1)],2),t("el-table-column",{attrs:{prop:"defaultValue",label:"默认值",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-form-item",{attrs:{prop:"requestParamsList."+a.$index+".defaultValue",rules:a.row.isRequired?[{required:!0,message:"输入默认值",trigger:"blur"},{max:50,min:1,message:"1-50个字符",trigger:"blur"},{pattern:e.dataTypeListRegExp[a.row.paramType],message:"输入".concat(a.row.paramType,"类型"),trigger:"blur"}]:[{max:50,min:1,message:"1-50个字符",trigger:"blur"},{pattern:e.dataTypeListRegExp[a.row.paramType],message:"输入".concat(a.row.paramType,"类型"),trigger:"blur"}]}},[t("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入默认值"},model:{value:a.row.defaultValue,callback:function(t){e.$set(a.row,"defaultValue",t)},expression:"scope.row.defaultValue"}})],1)]}}],null,!1,1120381292)},[t("template",{slot:"header"},[t("span",[e._v("默认值")]),e._v(" \n                      ")])],2),t("el-table-column",{attrs:{label:"描述",prop:"paramDesc",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-form-item",{attrs:{prop:"requestParamsList."+a.$index+".paramDesc",rules:[{max:20,min:1,message:"1-20个字符",trigger:"blur"}]}},[t("el-input",{staticStyle:{width:"90%"},attrs:{type:"textarea",rows:2,placeholder:"选填，2-20个字符"},model:{value:a.row.paramDesc,callback:function(t){e.$set(a.row,"paramDesc",t)},expression:"scope.row.paramDesc"}})],1)]}}],null,!1,1560584427)}),t("el-table-column",{attrs:{label:"操作",align:"right",width:"80px",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{disabled:0===a.$index||1===a.$index,type:"text"},on:{click:function(t){return e.deleteRequestParams(a)}}},[e._v("删除")])]}}],null,!1,202560066)})],1)],1),t("div",{staticClass:"range-params"},[t("el-form-item",{attrs:{label:"取值范围:"}},[t("el-row",[t("el-tooltip",{attrs:{effect:"dark",content:"默认请求参数为and.此处可配置数据服务的过滤条件，如where后的a=100 and (b>100 or c<100),PS:",placement:"top-start"}},[t("span",{staticClass:"icon",staticStyle:{"margin-right":"10px"}},[e._v("")])]),t("el-checkbox",{attrs:{"true-label":1,"false-label":2},model:{value:e.form3.valueRangType,callback:function(t){e.$set(e.form3,"valueRangType",t)},expression:"form3.valueRangType"}},[e._v("取值范围")])],1)],1),t("el-form-item",{attrs:{prop:"valueRang","label-width":"80"}},[t("el-input",{attrs:{disabled:2===e.form3.valueRangType,type:"textarea",rows:4,placeholder:e.placeholderContent},model:{value:e.form3.valueRang,callback:function(t){e.$set(e.form3,"valueRang",t)},expression:"form3.valueRang"}})],1),t("el-form-item",{staticStyle:{"margin-top":"20px","margin-bottom":"5px"},attrs:{label:"行规则配置:"}},[t("el-row",[t("el-tooltip",{attrs:{effect:"dark",content:"配置的行规则默认以(ADN)且条件拼接请求参数去查询数据，以返回参数的字段进行数据返回",placement:"top-start"}},[t("span",{staticClass:"icon",staticStyle:{"margin-right":"10px"}},[e._v("")])]),t("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:e.form3.enableRule,callback:function(t){e.$set(e.form3,"enableRule",t)},expression:"form3.enableRule"}},[e._v(" 使用行规则取数")])],1)],1),t("el-form-item",{attrs:{label:"行规则作用方式:"}},[t("el-row",[t("el-radio-group",{model:{value:e.form3.actionModeRule,callback:function(t){e.$set(e.form3,"actionModeRule",t)},expression:"form3.actionModeRule"}},[t("el-radio",{attrs:{label:1,disabled:0==e.form3.enableRule}},[e._v("在请求参数基础上使用行规则取数")]),t("el-radio",{attrs:{label:2,disabled:0==e.form3.enableRule}},[e._v("仅使用行规则取数")])],1)],1),t("el-table",{attrs:{data:e.form3.dataServiceRuleList,size:"mini","max-height":"250px"}},[t("el-table-column",{attrs:{label:"条件",prop:"permissionRule"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-form-item",{attrs:{prop:"dataServiceRuleList."+a.$index+".permissionRule",rules:[{required:0!=e.form3.enableRule,message:"请选择条件",trigger:"change"}]}},[t("el-select",{attrs:{disabled:0==e.form3.enableRule,placeholder:"请选择条件"},model:{value:a.row.permissionRule,callback:function(t){e.$set(a.row,"permissionRule",t)},expression:"scope.row.permissionRule"}},e._l(e.form3.conditionsList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1)],1)]}}],null,!1,2999809367)}),t("el-table-column",{attrs:{label:"字段",prop:"fieldName"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-form-item",{attrs:{prop:"dataServiceRuleList."+a.$index+".fieldName",rules:[{required:0!=e.form3.enableRule,message:"请选择字段",trigger:"change"}]}},[t("el-select",{attrs:{"allow-create":"",filterable:"",disabled:0==e.form3.enableRule,placeholder:"请选择字段","default-first-option":""},on:{change:function(t){return e.changeFieldType(t,a)}},model:{value:a.row.fieldName,callback:function(t){e.$set(a.row,"fieldName",t)},expression:"scope.row.fieldName"}},e._l(e.tableFieldList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.fieldName,value:e.fieldName}})})),1)],1)]}}],null,!1,2705493638)}),t("el-table-column",{attrs:{label:"操作符",prop:"ruleCondition"},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.fieldName||e.showFieldType?t("el-form-item",{ref:"ruleCondition",attrs:{prop:"dataServiceRuleList."+a.$index+".ruleCondition",rules:[{required:0!=e.form3.enableRule,message:"请选择操作符",trigger:"change"}]}},[t("el-select",{attrs:{"allow-create":"",filterable:"",disabled:0==e.form3.enableRule,"default-first-option":""},on:{change:function(t){return e.handleRuleConditionChange(t,a)}},model:{value:a.row.ruleCondition,callback:function(t){e.$set(a.row,"ruleCondition",t)},expression:"scope.row.ruleCondition"}},e._l(a.row.operatorList,(function(e,a){return t("el-option",{key:a,attrs:{label:e,value:e}})})),1)],1):e._e()]}}],null,!1,3687127483)}),t("el-table-column",{attrs:{label:"值",prop:"ruleValueList",width:"365px"},scopedSlots:e._u([{key:"default",fn:function(a){return[["非空","为空","属于","不属于"].includes(a.row.ruleCondition)?e._e():t("el-form-item",{attrs:{prop:"dataServiceRuleList."+a.$index+".ruleValueList",rules:[{required:!0,message:"请输入",trigger:"change"}]}},[t("el-input",{attrs:{disabled:0==e.form3.enableRule},model:{value:a.row.ruleValueList,callback:function(t){e.$set(a.row,"ruleValueList",t)},expression:"scope.row.ruleValueList"}})],1),["属于","不属于"].includes(a.row.ruleCondition)&&!["int","float","double","bigint","INT","FLOAT","DOUBLE","BIGINT"].includes(a.row.fieldType)?t("el-form-item",{attrs:{prop:"dataServiceRuleList."+a.$index+".ruleValueList",rules:[{required:!0,message:"请输入",trigger:"change"}]}},[t("el-select",{attrs:{multiple:"",filterable:"",remote:"",placeholder:"请输入值","remote-method":function(t){return e.getdataServiceDetailList(a,t)},loading:e.loading,"collapse-tags":"",disabled:0==e.form3.enableRule},model:{value:a.row.ruleValueList,callback:function(t){e.$set(a.row,"ruleValueList",t)},expression:"scope.row.ruleValueList"}},e._l(e.ShowOptionsList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),["属于","不属于"].includes(a.row.ruleCondition)&&["int","float","double","bigint","INT","FLOAT","DOUBLE","BIGINT"].includes(a.row.fieldType)?t("div",{staticStyle:{display:"flex","align-items":"center"}},[t("el-form-item",{staticStyle:{"margin-right":"3px"},attrs:{prop:"dataServiceRuleList."+a.$index+".intValue1",rules:[{required:!0,message:"请输入",trigger:"change"},{type:"number",message:"必须输入数字类型",trigger:"change"},{validator:function(t,r,i){e.dealWithValid(t,r,i,a.row)},trigger:["change","blur"]}]}},[t("el-input",{attrs:{disabled:0==e.form3.enableRule,placeholder:"请输入"},on:{blur:function(t){return e.changAvalue(a.row,1)}},model:{value:a.row.intValue1,callback:function(t){e.$set(a.row,"intValue1",e._n(t))},expression:"scope.row.intValue1"}})],1),t("el-form-item",{staticStyle:{"margin-right":"3px"},attrs:{prop:"dataServiceRuleList."+a.$index+".intValue2",rules:[{required:!0,message:"请选择",trigger:"change"}]}},[t("el-select",{staticStyle:{width:"60px"},model:{value:a.row.intValue2,callback:function(t){e.$set(a.row,"intValue2",t)},expression:"scope.row.intValue2"}},e._l(["<","<="],(function(e,a){return t("el-option",{key:a+"intValue2",attrs:{label:e,value:e}})})),1)],1),t("span",{staticStyle:{position:"relative",bottom:"6px","margin-right":"3px"}},[e._v(e._s("值"))]),t("el-form-item",{staticStyle:{"margin-right":"3px"},attrs:{prop:"dataServiceRuleList."+a.$index+".intValue3",rules:[{required:!0,message:"请选择",trigger:"change"}]}},[t("el-select",{staticStyle:{width:"60px"},model:{value:a.row.intValue3,callback:function(t){e.$set(a.row,"intValue3",t)},expression:"scope.row.intValue3"}},e._l(["<","<="],(function(e,a){return t("el-option",{key:a+"intValue3",attrs:{label:e,value:e}})})),1)],1),t("el-form-item",{staticStyle:{"margin-right":"3px"},attrs:{prop:"dataServiceRuleList."+a.$index+".intValue4",rules:[{required:!0,message:"请输入",trigger:"change"},{type:"number",message:"必须输入数字类型",trigger:"change"},{validator:function(t,r,i){e.dealWithValid2(t,r,i,a.row)},trigger:["change","blur"]}]}},[t("el-input",{attrs:{disabled:0==e.form3.enableRule,placeholder:""},on:{blur:function(t){return e.changAvalue(a.row,4)}},model:{value:a.row.intValue4,callback:function(t){e.$set(a.row,"intValue4",e._n(t))},expression:"scope.row.intValue4"}})],1)],1):e._e()]}}],null,!1,3470172137)}),e.showTableName?t("el-form-item",{attrs:{prop:"tableName",label:"数据表：",rules:[{required:!0,message:"请选择数据表",trigger:"change"}]}},[t("el-select",{attrs:{filterable:"",placeholder:"请选择数据表，仅支持单选"},on:{change:e.getDataServiceTableStructure},model:{value:e.form2.tableName,callback:function(t){e.$set(e.form2,"tableName",t)},expression:"form2.tableName"}},e._l(e.dataTableList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),t("el-table-column",{attrs:{label:"操作",width:"80",align:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.deleteForm3Params(a)}}},[e._v("删除\n                          ")])]}}],null,!1,792859171)})],1),t("div",{staticClass:"plus-1",on:{click:e.addRequestParams1}},[e._v("+ 添加")])],1)],1)])])],1)]):e._e(),2===e.serviceType?t("div",{staticClass:"sql-mode"},[t("el-form",{ref:"form4",attrs:{model:e.form4,"label-width":"110px","label-position":"left"}},[t("div",{staticClass:"sql-type"},[t("el-form-item",{attrs:{prop:"dbType",label:"数据源类型：",rules:[{required:2!=e.form1.serviceDetailType,message:"请选择数据源类型",trigger:"change"}]}},[t("el-select",{attrs:{placeholder:"请选择数据源类型",filterable:"",disabled:2==e.form1.serviceDetailType},on:{change:e.dbTypeChang},model:{value:e.form4.dbType,callback:function(t){e.$set(e.form4,"dbType",t)},expression:"form4.dbType"}},e._l(e.dataDbtypeList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("div",{staticClass:"sql-mode-top"},[-4!=e.$route.query.connectId?t("el-form-item",{attrs:{prop:"connectId",label:"数据源：",rules:[{required:2!=e.form1.serviceDetailType,message:"请选择数据源",trigger:"change"}]}},[t("el-select",{attrs:{filterable:"",disabled:2==e.form1.serviceDetailType,placeholder:"请选择数据源"},on:{change:e.changeForm4Connect},model:{value:e.form4.connectId,callback:function(t){e.$set(e.form4,"connectId",t)},expression:"form4.connectId"}},e._l(e.dataSourceList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1),t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"支持的数据源类型：默认hive、默认impala、MySQL、Oracle、SQL Server、ClickHouse、MongoDB",placement:"top-start"}},[t("i",{staticClass:"icon icon-ic_remind",staticStyle:{"margin-left":"10px"}})])],1):t("el-form-item",{attrs:{prop:"connectId",label:"数据源："}},[t("el-select",{attrs:{disabled:2==e.form1.serviceDetailType,placeholder:"请选择数据源"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.getOptions,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label}})})),1),t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"支持的数据源类型：默认hive、默认impala、MySQL、Oracle、SQL Server、ClickHouse、MongoDB",placement:"top-start"}},[t("i",{staticClass:"icon icon-ic_remind",staticStyle:{"margin-left":"10px"}})])],1)],1),t("div",{staticClass:"request-params"},[t("div",[t("span",[e._v("请求参数：")]),t("el-tooltip",{attrs:{effect:"dark",content:"配置数据请求时body和query中的参数，get请求仅支持query，post请求仅支持body。",placement:"top-start"}},[t("span",{staticClass:"icon",staticStyle:{margin:"0 10px",cursor:"pointer"}},[e._v("")])])],1),t("el-table",{attrs:{data:e.form4.requestParamsList,size:"mini","max-height":"250px"}},[t("el-table-column",{attrs:{label:"参数名称",prop:"paramName"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-form-item",{attrs:{prop:"requestParamsList."+a.$index+".paramName",rules:[{pattern:/^[a-zA-Z]{1}[a-zA-Z0-9_]*$/,message:"英文开头，数字，下划线组合",trigger:"blur"},{max:20,min:2,message:"2-20个字符",trigger:"blur"},{required:!0,message:"请输入字段名称",trigger:"blur"}]}},[t("el-input",{model:{value:a.row.paramName,callback:function(t){e.$set(a.row,"paramName",t)},expression:"scope.row.paramName"}})],1)]}}],null,!1,1003660966)}),t("el-table-column",{attrs:{label:"参数位置",prop:"paramPosition"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-form-item",{attrs:{prop:"requestParamsList."+a.$index+".paramPosition",rules:[{required:!0,message:"请选择参数位置",trigger:"blur"}]}},[t("el-select",{model:{value:a.row.paramPosition,callback:function(t){e.$set(a.row,"paramPosition",t)},expression:"scope.row.paramPosition"}},e._l(e.paramPositionList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1)],1)]}}],null,!1,7125768)}),t("el-table-column",{attrs:{label:"参数类型",prop:"paramType"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-form-item",{attrs:{prop:"requestParamsList."+a.$index+".paramType",rules:[{required:!0,message:"请选择参数类型",trigger:"blur"}]}},[t("el-select",{attrs:{"allow-create":"",filterable:"","default-first-option":""},on:{focus:e.getTableInfoListDataTypesFocus,change:function(t){return e.changeRequestType(t,a)}},model:{value:a.row.paramType,callback:function(t){e.$set(a.row,"paramType",t)},expression:"scope.row.paramType"}},e._l(e.paramsTypeList1,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1)],1)]}}],null,!1,66662420)}),t("el-table-column",{attrs:{label:"是否必填",prop:"isRequired"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-form-item",{attrs:{prop:"requestParamsList."+a.$index+".isRequired",rules:[{required:!0,message:"请选择是否必填",trigger:"change"}]}},[t("el-select",{attrs:{disabled:17==e.form4.dbType},model:{value:a.row.isRequired,callback:function(t){e.$set(a.row,"isRequired",t)},expression:"scope.row.isRequired"}},e._l(e.isRequiredList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1)],1)]}}],null,!1,1740529946)}),t("el-table-column",{attrs:{label:"是否模糊查询",prop:"isFuzzy",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-form-item",{attrs:{prop:"requestParamsList."+a.$index+".isFuzzy",rules:[{required:!0,message:"是否模糊查询",trigger:"change"}]}},[t("el-select",{model:{value:a.row.isFuzzy,callback:function(t){e.$set(a.row,"isFuzzy",t)},expression:"scope.row.isFuzzy"}},e._l(e.form3.isConditionList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1)],1)]}}],null,!1,1675569200)}),t("el-table-column",{attrs:{label:"参数校验",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-form-item",{attrs:{rules:[{required:!0,message:"请求参数、字段不符合传参规范，请按传参要求使用",trigger:"blur"},{max:50,min:1,message:"1-50个字符",trigger:"blur"},{pattern:e.dataTypeListRegExp[a.row.regular],message:"输入".concat(a.row.regular,"类型"),trigger:"blur"}]}},[t("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入正则表达式"},model:{value:a.row.regular,callback:function(t){e.$set(a.row,"regular",t)},expression:"scope.row.regular"}})],1)]}}],null,!1,73742754)},[t("template",{slot:"header"},[t("span",[e._v("参数校验")]),e._v(" \n                      ")])],2),t("el-table-column",{attrs:{label:"是否批量传参",prop:"isMultiple"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-form-item",{attrs:{prop:"requestParamsList."+a.$index+".isMultiple",rules:[{required:!0,message:"请选择是否必填",trigger:"change"}]}},[t("el-select",{attrs:{disabled:"varchar"!=a.row.paramType&&"string"!=a.row.paramType&&"STRING"!=a.row.paramType&&"VARCHAR"!=a.row.paramType||17==e.form4.dbType},model:{value:a.row.isMultiple,callback:function(t){e.$set(a.row,"isMultiple",t)},expression:"scope.row.isMultiple"}},e._l(e.isRequiredList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1)],1)]}}],null,!1,1480456603)},[t("template",{slot:"header"},[t("span",[e._v("是否批量传参")]),e._v(" \n                    "),t("el-tooltip",{attrs:{effect:"dark",content:"批量传参默认传递格式为JSON字符串",placement:"top-start"}},[t("span",{staticClass:"icon"},[e._v("")])])],1)],2),t("el-table-column",{attrs:{prop:"defaultValue",label:"默认值"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-form-item",{attrs:{prop:"requestParamsList."+a.$index+".defaultValue",rules:a.row.isRequired?[{required:!0,message:"请输入默认值",trigger:"blur"},{max:50,min:1,message:"1-50个字符",trigger:"blur"},{pattern:e.dataTypeListRegExp[a.row.paramType],message:"输入".concat(a.row.paramType,"类型"),trigger:"blur"}]:[{max:50,min:1,message:"1-50个字符",trigger:"blur"},{pattern:e.dataTypeListRegExp[a.row.paramType],message:"输入".concat(a.row.paramType,"类型"),trigger:"blur"}]}},[t("el-input",{attrs:{placeholder:"请输入默认值"},model:{value:a.row.defaultValue,callback:function(t){e.$set(a.row,"defaultValue",t)},expression:"scope.row.defaultValue"}})],1)]}}],null,!1,3224581506)},[t("template",{slot:"header"},[t("span",[e._v("默认值")]),e._v(" \n                  ")])],2),t("el-table-column",{attrs:{label:"操作",align:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.deleteRequestParamsSql(a)}}},[e._v("删除\n                    ")])]}}],null,!1,1125525337)})],1)],1),t("div",{staticClass:"plus-1",on:{click:e.addRequestParams}},[e._v("+ 添加")]),t("div",{staticClass:"request-params"},[t("div",{staticStyle:{width:"106px"}},[t("span",[e._v("返回参数：")])]),t("el-table",{attrs:{data:e.form4.responseParmasList,size:"mini","max-height":"200px"}},[t("el-table-column",{attrs:{label:"参数名称",prop:"paramName"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-form-item",{attrs:{prop:"responseParmasList."+a.$index+".paramName",rules:[{pattern:/^[a-zA-Z]{1}[a-zA-Z0-9_]*$/,message:"英文开头，数字，下划线组合",trigger:"blur"},{max:20,min:2,message:"2-20个字符",trigger:"blur"},{required:!0,message:"请输入参数名称",trigger:"blur"}]}},[t("el-input",{model:{value:a.row.paramName,callback:function(t){e.$set(a.row,"paramName",t)},expression:"scope.row.paramName"}})],1)]}}],null,!1,3974849892)}),t("el-table-column",{attrs:{label:"参数类型",prop:"paramType"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-form-item",{attrs:{prop:"responseParmasList."+a.$index+".paramType",rules:[{required:!0,message:"请选择参数类型",trigger:"blur"}]}},[t("el-select",{attrs:{"allow-create":"",filterable:"","default-first-option":""},model:{value:a.row.paramType,callback:function(t){e.$set(a.row,"paramType",t)},expression:"scope.row.paramType"}},e._l(e.paramsTypeList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label||e,value:e.value||e}})})),1)],1)]}}],null,!1,1035026937)}),t("el-table-column",{attrs:{prop:"defaultValue",label:"示例值"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-form-item",{attrs:{prop:"responseParmasList."+a.$index+".defaultValue",rules:[{max:20,min:1,message:"1-20个字符",trigger:"blur"},{pattern:e.dataTypeListRegExp[a.row.paramType],message:"类型错误",trigger:"blur"}]}},[t("el-input",{attrs:{placeholder:"请输入示例值"},model:{value:a.row.defaultValue,callback:function(t){e.$set(a.row,"defaultValue",t)},expression:"scope.row.defaultValue"}})],1)]}}],null,!1,2045620131)},[t("template",{slot:"header"},[t("span",[e._v("示例值")]),e._v(" \n                    "),t("el-tooltip",{attrs:{effect:"dark",content:"API提供给别人时的参考值",placement:"top-start"}},[t("span",{staticClass:"icon"},[e._v("")])])],1)],2),t("el-table-column",{attrs:{label:"描述",prop:"paramDesc"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-form-item",{attrs:{prop:"responseParmasList."+a.$index+".paramDesc",rules:[{max:20,min:2,message:"2-20个字符",trigger:"blur"}]}},[t("el-input",{attrs:{placeholder:"选填，2-20个字符"},model:{value:a.row.paramDesc,callback:function(t){e.$set(a.row,"paramDesc",t)},expression:"scope.row.paramDesc"}})],1)]}}],null,!1,3672287855)}),t("el-table-column",{attrs:{label:"操作",align:"right",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.deleteResponseParams(a)}}},[e._v("删除")])]}}],null,!1,1748508311)})],1)],1),t("div",{staticClass:"plus-1",on:{click:function(t){return e.addResponseParams()}}},[e._v("+ 添加")]),t("el-form-item",{staticStyle:{margin:"30px 0 10px 0"},attrs:{label:17==e.form4.dbType?"查询语句：":"查询SQL：",required:""}},[t("el-row",{attrs:{type:"flex",justify:"space-between"}},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.isShowDialog=!0}}},[e._v(e._s(17==e.form4.dbType?"MongoDB示例与注意事项":"SQL示例与注意事项"))]),t("el-button",{attrs:{type:"primary"},on:{click:e.clearRequestSQL}},[e._v("清空")])],1)],1),t("el-form-item",{attrs:{prop:"requestSql",rules:[{required:!0,message:"请输入语句",trigger:"blur"}]}},[t("el-input",{attrs:{type:"textarea",rows:6,placeholder:17==e.form4.dbType?e.placeholderContentMongoDB:e.placeholderContentSql},model:{value:e.form4.requestSql,callback:function(t){e.$set(e.form4,"requestSql",t)},expression:"form4.requestSql"}})],1)],1)],1):e._e()],1)],1),t("el-dialog",{attrs:{title:17==e.form4.dbType?"MongoDB示例":"SQL示例",visible:e.isShowDialog},on:{close:function(t){e.isShowDialog=!1}}},[17==e.form4.dbType?t("div",[t("pre",[e._v('  MongoDB示例：\n\n  db.col.find({"by":"演示", "title":"演示"}).pretty()\n\n  {\n\n          "_id" : ObjectId("56063f17ade2f21f36b03133"),\n\n          "title" : "案例",\n\n          "description" : "MongoDB 是一个 Nosql 数据库",\n\n          "by" : "案例",\n\n          "url" : "http://www.xxx.com",\n\n          "tags" : [\n\n                  "mongodb",\n\n                  "database",\n\n                  "NoSQL"\n\n          ],\n\n          "likes" : 100\n\n  }\n\n\n  注意事项：\n\n      1. 仅支持db.collection.find(query，projection).limit(NUMBER)语法格式\n\n      2. 查询语句中请包含limit语句，且limit不可超过1000条，若无limit，默认\n\n      最多返回500W条，请根据服务器性能酌情考虑\n\n      3. 请对参数描述等信息进行设置，以方便API调用者\n        ')])]):t("div",[t("p",[e._v("SQL示例：")]),t("p",{staticClass:"ident2"},[e._v("SELECT")]),t("p",{staticClass:"ident2"},[e._v("id,name, //select查询的字段即为API返回参数，需指定具体字段")]),t("p",{staticClass:"ident2"},[e._v("price as my_price, //可使用as别名来指定api返回的字段名")]),t("p",{staticClass:"ident2"},[e._v("'data', //特殊关键字需要加反引号`")]),t("p",{staticClass:"ident2"},[e._v("sum(num) as total_num //聚合函数需要使用别名")]),t("p",{staticClass:"ident2"},[e._v("FROM")]),t("p",{staticClass:"ident2"},[e._v("table_name")]),t("p",{staticClass:"ident2"},[e._v("WHERE")]),t("p",{staticClass:"ident2"},[e._v("id="),t("span",{domProps:{innerHTML:e._s("{{id}}")}}),e._v(" and name="),t("span",{domProps:{innerHTML:e._s("{{name}}")}}),e._v("//where条件中的参数即为API请求参数，参数格式为"),t("span",{domProps:{innerHTML:e._s("{{参数名称}}")}})]),t("p",{staticClass:"ident2"},[e._v("limit 500; //包含limit语句，且不可超过1000，若无limit，默认返回200条数据")]),t("p",[e._v("注意事项：")]),t("p",{staticClass:"ident2"},[e._v("1. 不支持select *的查询，需要指定具体的查询列，可使用as别名指定返回字段，且只支持填写一条完整的SQL语句")]),t("p",{staticClass:"ident2"},[e._v("2. 查询语句中请包含limit语句，且limit不可超过1000条，若无limit，默认返回200条数据")]),t("p",{staticClass:"ident2"},[e._v("3. 特殊关键字需要加反引号，可见上述SQL示例")])])])],1),t("div",{staticClass:"buttons"},[t("el-button",{on:{click:e.backToServiceList}},[e._v("取消")]),1===e.activeIndex?t("el-button",{on:{click:e.preStep}},[e._v("上一步")]):e._e(),0===e.activeIndex?t("el-button",{attrs:{type:"primary"},on:{click:e.nextStep}},[e._v("下一步")]):e._e(),1===e.activeIndex?t("el-button",{attrs:{type:"primary",loading:e.btnState},on:{click:e.handleSave}},[e._v("保存")]):e._e()],1),t("test-and-publish",{attrs:{serviceId:e.serviceId,isShowTest:e.isShowTest,mode:e.mode},on:{close:e.closeFun}})],1)}),[],!1,null,"bc8ae102",null);t.default=N.exports},e853:function(e,t,a){var r=a("d3f4"),i=a("1169"),n=a("2b4c")("species");e.exports=function(e){var t;return i(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!i(t.prototype)||(t=void 0),r(t)&&null===(t=t[n])&&(t=void 0)),void 0===t?Array:t}}}]);