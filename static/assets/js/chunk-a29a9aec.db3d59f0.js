(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-a29a9aec"],{"354d":function(e,t,a){(e.exports=a("2350")(!1)).push([e.i,".primary-color[data-v-408814da]{color:#1740dc}.success-color[data-v-408814da]{color:#52c41a}.warning-color[data-v-408814da]{color:#faad14}.error-color[data-v-408814da]{color:#f5222d}.info-color[data-v-408814da]{color:#909399}.border-color[data-v-408814da]{border:1px solid #e5e6e9}.wareHouse[data-v-408814da]{text-align:left;height:100%}.wareHouse .right .el-form-item[data-v-408814da]:last-child{margin-right:0}.wareHouse .delete[data-v-408814da]{color:#f5222d}.wareHouse .truncate[data-v-408814da]{color:#e6a23c}.wareHouse .el-button--text[data-v-408814da]{padding-left:0!important;padding-right:0!important}.wareHouse[data-v-408814da] .el-dropdown-link{cursor:pointer;font-size:12px;margin-left:10px}.wareHouse[data-v-408814da] .el-dropdown-link:hover{color:#1740dc}[data-v-408814da] .el-dropdown-menu__item{padding:0 3px}",""])},a942:function(e,t,a){var o=a("354d");o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);(0,a("499e").default)("2bb71ab6",o,!0,{sourceMap:!1,shadowMode:!1})},af06:function(e,t,a){var o=a("ed62");o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);(0,a("499e").default)("466dbcb4",o,!0,{sourceMap:!1,shadowMode:!1})},b056:function(e,t,a){"use strict";a.d(t,"c",(function(){return r})),a.d(t,"d",(function(){return l})),a.d(t,"e",(function(){return i})),a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return c}));var o=a("fedb"),n=a("83fe"),r=function(e){return n.a.post(o.a.getLevelList,e)},l=function(){return n.a.get(o.a.getRoleSelectNew)},i=function(e){return n.a.post(o.a.sqlSearchLimitSave,e)},s=function(){return n.a.get(o.a.getExploreDownLoadLimit)},c=function(e){var t=e.id;return n.a.get(o.a.getConnExtInfo+"?id=".concat(t))}},be31:function(e,t,a){"use strict";a("af06")},ec1b:function(e,t,a){"use strict";a.r(t);a("7f7f"),a("ac6a"),a("96cf");var o,n=a("1da1"),r=a("9306f"),l=a("2b0e"),i=a("fedb"),s=function(e){return l.default.http.post(i.a.getTableInfoListAll,e)},c=function(e){return l.default.http.post(i.a.getOwnAuthList,e)},d=function(e){return l.default.http.post(i.a.getPassiveList,e)},u=a("50f0"),p={props:["type"],data:function(e){return{selectIdarrys:[],formInline:{table_name:this.$store.state.old.warehouseName||"",db_name:this.$store.state.old.warehouseType||"",userId:null},dataListLoading:!1,options:[],create_options:[],create_options1:[],apply_options:[],dataList:[],pageIndex:1,pageSize:10,totalPage:0,activeName:"application",createList:[],createType:""}},components:{TableAddOrEdit:r.a,filterTBHeader:u.a},methods:{refreshRanger:function(e){var t=this;this.$API.post(this.$URL.refreshRanger+"?id=".concat(e),{},(function(e){0==e.code?(t.$message.success("刷新成功"),t.do_search()):t.$message.error(e.msg)}))},getCreateList:function(){var e=this;this.$API.get(this.$URL.getTableInfoUserList,{},(function(t){0==t.code?e.create_options=e.create_options.concat(t.data):e.$message.error(t.msg)}))},getCreateList1:function(){var e=this;this.$API.get(this.$URL.getTableInfoUserList1,{},(function(t){0==t.code?e.create_options1=e.create_options1.concat(t.data):e.$message.error(t.msg)}))},getTableApplyUserList:function(){var e=this;this.$API.get(this.$URL.getTableApplyUserList,{},(function(t){0==t.code?e.apply_options=e.apply_options.concat(t.data):e.$message.error(t.msg)}))},toDataSecurity:function(e){this.$router.push("/dataSecurity1?id="+e)},getlistDbs:function(){var e=this;this.$API.post(this.$URL.getListDbShare,{dateType:1},(function(t){if(0==t.code)for(var a=0;a<t.data.length;a++)e.options.push({value:t.data[a],text:t.data[a]});else e.ruleForm.options=[]}))},getDataTableListAll:(o=Object(n.a)(regeneratorRuntime.mark((function e(){var t,a,o,n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={auth:s,approve:c,recycle:d},a={page:this.pageIndex,limit:this.pageSize,table_name:this.formInline.table_name,db_name:this.formInline.db_name,userId:this.formInline.userId||null},this.dataListLoading=!0,e.prev=3,e.next=6,t[this.type](a);case 6:o=e.sent,this.dataListLoading=!1,n=o.data.page||o.data.data,this.dataList=n&&n.list,this.$store.commit("old/changWarehouseName",this.formInline.table_name),this.$store.commit("old/changWarehouseType",this.formInline.db_name),this.totalPage=n&&n.totalCount,this.dataList.forEach((function(e){r.$set(e,"delLoading",!1)})),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(3);case 20:case"end":return e.stop()}}),e,this,[[3,17]])}))),function(){return o.apply(this,arguments)}),reset:function(){this.formInline={table_name:"",db_name:"",userId:null},this.do_search()},do_search:function(){this.pageIndex=1,this.getDataTableListAll()},sizeChangeHandle:function(e){this.pageSize=e,this.pageIndex=1,this.getDataTableListAll()},currentChangeHandle:function(e){this.pageIndex=e,this.getDataTableListAll()},tableAddOrEditHandle:function(e,t){var a=this;this.$nextTick((function(){a.createType=e?2==t?"copy":"edit":"add",a.$router.push({path:"/createTable?id=".concat(e,"&type=").concat(t)})}))},downflie:function(){var e,t=[];this.selectIdarrys.forEach((function(e){t.push(e.id)})),(e={ids:t},l.default.http.post(i.a.exportTableField,e,{responseType:"blob"})).then((function(e){var t=new Blob([e.data],{type:"text/json;charset=utf-8"}),a=document.createElement("a"),o=window.URL.createObjectURL(t);a.href=o,a.download="模板.xlsx",document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(o)}))},handleSelectionChange:function(e){this.selectIdarrys=e},truncateHandle:function(e){var t=this;this.$confirm("确定进行清空表操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a={id:e};t.dataListLoading=!0,t.$API.post(t.$URL.getTableInfoTruncate,a,(function(e){0==e.code?t.$message({message:"清空成功",type:"success",duration:1500,onClose:function(){t.getDataTableListAll()}}):t.$message.error(e.msg)}))})).catch((function(){}))},deleteHandle:function(e){var t=this;this.$confirm("确定进行删除操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$set(e,"delLoading",!0);var a={id:e.id};t.$API.post(t.$URL.getTableInfoDrop,a,(function(a){0==a.code?t.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){t.$set(e,"delLoading",!1),t.dataListLoading=!1,t.getDataTableListAll()}}):(t.$set(e,"delLoading",!1),t.$message.error(a.msg))}))})).catch((function(){}))}},mounted:function(){this.getlistDbs(),this.getTableApplyUserList(),this.getCreateList(),this.getCreateList1(),this.getDataTableListAll()}},f=(a("f30a"),a("2877")),h={data:function(){return{activeName:"auth",cur:{}}},beforeRouteLeave:function(e,t,a){"createTable"==e.name&&"add"==this.cur.createType?e.meta.title="新建离线表":"createTable"==e.name&&"edit"==this.cur.createType?e.meta.title="修改离线表":"createTable"==e.name&&"copy"==this.cur.createType&&(e.meta.title="复制离线表"),a()},methods:{handleClick:function(){this.$refs[this.activeName].formInline={table_name:"",userId:null},this.$refs[this.activeName].do_search(),this.cur=this.$refs[this.activeName]}},mounted:function(){this.$refs[this.activeName].formInline={table_name:"",userId:null},this.$refs[this.activeName].do_search(),this.cur=this.$refs[this.activeName]},components:{Content:Object(f.a)(p,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"wareHouse"},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline}},[t("el-form-item",[t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"dataFactory_createTable",expression:"'dataFactory_createTable'"}],attrs:{type:"primary"},on:{click:function(t){return e.tableAddOrEditHandle("","")}}},[e._v("创建离线表")])],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.downflie()}}},[e._v("批量下载表结构")])],1),t("div",{staticClass:"fr right"},["approve"===e.type?t("el-form-item",{attrs:{label:""}},[t("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择申请人"},on:{change:e.do_search},model:{value:e.formInline.userId,callback:function(t){e.$set(e.formInline,"userId",t)},expression:"formInline.userId"}},e._l(e.apply_options,(function(e){return t("el-option",{key:e.userId,attrs:{label:e.userName,value:e.userId}})})),1)],1):"auth"===e.type?t("el-form-item",{attrs:{label:""}},[t("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择创建人"},on:{change:e.do_search},model:{value:e.formInline.userId,callback:function(t){e.$set(e.formInline,"userId",t)},expression:"formInline.userId"}},e._l(e.create_options,(function(e){return t("el-option",{key:e.userId,attrs:{label:e.userName,value:e.userId}})})),1)],1):t("el-form-item",{attrs:{label:""}},[t("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择创建人"},on:{change:e.do_search},model:{value:e.formInline.userId,callback:function(t){e.$set(e.formInline,"userId",t)},expression:"formInline.userId"}},e._l(e.create_options1,(function(e){return t("el-option",{key:e.userId,attrs:{label:e.userName,value:e.userId}})})),1)],1),t("el-form-item",{attrs:{label:""}},[t("el-input",{attrs:{placeholder:"请输入表名"},model:{value:e.formInline.table_name,callback:function(t){e.$set(e.formInline,"table_name","string"==typeof t?t.trim():t)},expression:"formInline.table_name"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.do_search}},[e._v("查询")]),t("el-button",{on:{click:e.reset}},[e._v("重置")])],1)],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.dataListLoading,expression:"dataListLoading"}],staticStyle:{width:"100%"},attrs:{data:e.dataList},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{fixed:"recycle"===e.type,prop:"id",width:"80",label:"ID",type:"selection"}}),t("el-table-column",{attrs:{fixed:"recycle"===e.type,prop:"tableName","show-overflow-tooltip":"",label:"英文名称"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("router-link",{attrs:{to:"/offlineTableDetail?tableId=".concat(a.row.id,"&from=list&tableType=1&offline=0")}},[e._v("\n          "+e._s(a.row.tableName)+"\n        ")])]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",fixed:"recycle"===e.type,prop:"tableAlias",label:"中文名称"}}),t("el-table-column",{attrs:{fixed:"recycle"===e.type,prop:"storeEngine",label:"存储引擎"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n        "+e._s(1===a.storeEngine?"hive":2===a.storeEngine?"kudu":"--")+"\n      ")]}}])}),t("el-table-column",{attrs:{fixed:"recycle"===e.type,prop:"dbName",label:"所属库"},scopedSlots:e._u([{key:"header",fn:function(a){return[t("filter-t-b-header",{attrs:{label:"所属库",filter:e.options,value:e.formInline.db_name},on:{"update:value":function(t){return e.$set(e.formInline,"db_name",t)},comfirm:e.do_search}})]}}])}),t("el-table-column",{attrs:{fixed:"recycle"===e.type,prop:"projectName","show-overflow-tooltip":"",label:"已关联项目"}}),t("el-table-column",{attrs:{fixed:"recycle"===e.type,prop:"roleNames","show-overflow-tooltip":"",label:"已授权角色"}}),"recycle"===e.type?t("el-table-column",{attrs:{fixed:"recycle"===e.type,label:"权限是否已被回收",width:"180px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n        "+e._s(4===a.applyStatus?"是":"否")+"\n      ")]}}],null,!1,1996413822)}):e._e(),"recycle"===e.type?t("el-table-column",{attrs:{prop:"createPerName",label:"创建人"}}):e._e(),"recycle"===e.type?t("el-table-column",{attrs:{label:"权限回收意见","show-overflow-tooltip":"",width:"130px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n        "+e._s(a.rollbackReason||"--")+"\n      ")]}}],null,!1,2370179437)}):e._e(),"auth"!==e.type?t("el-table-column",{attrs:{width:"120","header-align":"center",align:"center",prop:"columnProp",label:"权限是否过期"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n        "+e._s(5===a.applyStatus?"是":"否")+"\n      ")]}}],null,!1,1094160959)}):e._e(),t("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"权限刷新状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.refreshFlag?"已刷新":"未刷新")+"\n      ")]}}])}),t("el-table-column",{attrs:{prop:"desc","show-overflow-tooltip":"",label:"描述"}}),"approve"===e.type?t("el-table-column",{attrs:{prop:"applyUser",label:"申请人"}}):e._e(),"auth"===e.type?t("el-table-column",{attrs:{prop:"createPerName",label:"创建人"}}):e._e(),t("el-table-column",{attrs:{fixed:"right","header-align":"right",align:"right",width:"220",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"dataFactory_edit",expression:"'dataFactory_edit'"}],attrs:{type:"text",size:"small"},on:{click:function(t){return e.tableAddOrEditHandle(a.row.id,1)}}},[e._v("修改")]),t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"dataFactory_delete",expression:"'dataFactory_delete'"}],attrs:{type:"text",size:"small",loading:a.row.delLoading,disabled:a.row.delLoading},on:{click:function(t){return e.deleteHandle(a.row)}}},[e._v("删除")]),t("el-dropdown",[t("span",{staticClass:"el-dropdown-link"},[e._v("\n            更多"),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{staticStyle:{"padding-left":"5px","padding-right":"5px"},attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{attrs:{disabled:2==a.row.storeEngine}},[t("div",{directives:[{name:"permission",rawName:"v-permission",value:"warehouse_clear",expression:"'warehouse_clear'"}],staticClass:"truncate",staticStyle:{width:"100%","text-align":"left"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.truncateHandle(a.row.id)}}},[e._v("清空\n              ")])]),t("el-dropdown-item",[t("div",{directives:[{name:"permission",rawName:"v-permission",value:"warehouse_copy",expression:"'warehouse_copy'"}],staticStyle:{width:"100%","text-align":"left"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.tableAddOrEditHandle(a.row.id,2)}}},[e._v("复制")])]),t("el-dropdown-item",{attrs:{disabled:1==a.row.refreshFlag}},[t("div",{staticStyle:{width:"100%"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.refreshRanger(a.row.id)}}},[e._v("刷新ranger策略")])])],1)],1)]}}])})],1),t("el-pagination",{attrs:{"current-page":e.pageIndex,"page-sizes":[10,20,50,100],"page-size":e.pageSize,total:e.totalPage,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.sizeChangeHandle,"current-change":e.currentChangeHandle}}),t("TableAddOrEdit",{ref:"tableAddOrEdit",on:{refreshDataList:e.getDataTableListAll}})],1)}),[],!1,null,"408814da",null).exports}},m=(a("be31"),Object(f.a)(h,(function(){var e=this._self._c;return e("div",[e("div",{staticClass:"zt-head noBorder"},[this._v("离线数仓")]),e("div",{staticClass:"warehouse-page"},[e("Content",{ref:"auth",attrs:{type:"auth"}})],1)])}),[],!1,null,null,null));t.default=m.exports},ed62:function(e,t,a){(e.exports=a("2350")(!1)).push([e.i,".primary-color{color:#1740dc}.success-color{color:#52c41a}.warning-color{color:#faad14}.error-color{color:#f5222d}.info-color{color:#909399}.border-color{border:1px solid #e5e6e9}.warehouse-page{padding:20px 20px 0 15px}",""])},f30a:function(e,t,a){"use strict";a("a942")}}]);