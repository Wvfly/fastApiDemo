(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-538e052c"],{"0a49":function(e,t,i){var r=i("9b43"),l=i("626a"),a=i("4bf8"),o=i("9def"),n=i("cd1c");e.exports=function(e,t){var i=1==e,s=2==e,c=3==e,u=4==e,d=6==e,f=5==e||d,p=t||n;return function(t,n,m){for(var b,h,g=a(t),y=l(g),v=r(n,m,3),x=o(y.length),w=0,F=i?p(t,x):s?p(t,0):void 0;x>w;w++)if((f||w in y)&&(h=v(b=y[w],w,g),e))if(i)F[w]=h;else if(h)switch(e){case 3:return!0;case 5:return b;case 6:return w;case 2:F.push(b)}else if(u)return!1;return d?-1:c||u?u:F}}},1308:function(e,t,i){var r=i("3b7c");r.__esModule&&(r=r.default),"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);(0,i("499e").default)("5bdfde69",r,!0,{sourceMap:!1,shadowMode:!1})},1619:function(e,t,i){"use strict";i("3b2b")},"20d6":function(e,t,i){"use strict";var r=i("5ca1"),l=i("0a49")(6),a="findIndex",o=!0;a in[]&&Array(1)[a]((function(){o=!1})),r(r.P+r.F*o,"Array",{findIndex:function(e){return l(this,e,arguments.length>1?arguments[1]:void 0)}}),i("9c6c")(a)},"28a0":function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}},3022:function(e,t,i){(function(e){var r=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),i={},r=0;r<t.length;r++)i[t[r]]=Object.getOwnPropertyDescriptor(e,t[r]);return i},l=/%[sdj%]/g;t.format=function(e){if(!g(e)){for(var t=[],i=0;i<arguments.length;i++)t.push(n(arguments[i]));return t.join(" ")}i=1;for(var r=arguments,a=r.length,o=String(e).replace(l,(function(e){if("%%"===e)return"%";if(i>=a)return e;switch(e){case"%s":return String(r[i++]);case"%d":return Number(r[i++]);case"%j":try{return JSON.stringify(r[i++])}catch(e){return"[Circular]"}default:return e}})),s=r[i];i<a;s=r[++i])b(s)||!x(s)?o+=" "+s:o+=" "+n(s);return o},t.deprecate=function(i,r){if(void 0!==e&&!0===e.noDeprecation)return i;if(void 0===e)return function(){return t.deprecate(i,r).apply(this,arguments)};var l=!1;return function(){if(!l){if(e.throwDeprecation)throw new Error(r);e.traceDeprecation,l=!0}return i.apply(this,arguments)}};var a,o={};function n(e,i){var r={seen:[],stylize:c};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),m(i)?r.showHidden=i:i&&t._extend(r,i),y(r.showHidden)&&(r.showHidden=!1),y(r.depth)&&(r.depth=2),y(r.colors)&&(r.colors=!1),y(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=s),u(r,e,r.depth)}function s(e,t){var i=n.styles[t];return i?"["+n.colors[i][0]+"m"+e+"["+n.colors[i][1]+"m":e}function c(e,t){return e}function u(e,i,r){if(e.customInspect&&i&&_(i.inspect)&&i.inspect!==t.inspect&&(!i.constructor||i.constructor.prototype!==i)){var l=i.inspect(r,e);return g(l)||(l=u(e,l,r)),l}var a=function(e,t){if(y(t))return e.stylize("undefined","undefined");if(g(t)){var i="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(i,"string")}if(h(t))return e.stylize(""+t,"number");if(m(t))return e.stylize(""+t,"boolean");if(b(t))return e.stylize("null","null")}(e,i);if(a)return a;var o=Object.keys(i),n=function(e){var t={};return e.forEach((function(e,i){t[e]=!0})),t}(o);if(e.showHidden&&(o=Object.getOwnPropertyNames(i)),F(i)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return d(i);if(0===o.length){if(_(i)){var s=i.name?": "+i.name:"";return e.stylize("[Function"+s+"]","special")}if(v(i))return e.stylize(RegExp.prototype.toString.call(i),"regexp");if(w(i))return e.stylize(Date.prototype.toString.call(i),"date");if(F(i))return d(i)}var c,x="",$=!1,T=["{","}"];(p(i)&&($=!0,T=["[","]"]),_(i))&&(x=" [Function"+(i.name?": "+i.name:"")+"]");return v(i)&&(x=" "+RegExp.prototype.toString.call(i)),w(i)&&(x=" "+Date.prototype.toUTCString.call(i)),F(i)&&(x=" "+d(i)),0!==o.length||$&&0!=i.length?r<0?v(i)?e.stylize(RegExp.prototype.toString.call(i),"regexp"):e.stylize("[Object]","special"):(e.seen.push(i),c=$?function(e,t,i,r,l){for(var a=[],o=0,n=t.length;o<n;++o)I(t,String(o))?a.push(f(e,t,i,r,String(o),!0)):a.push("");return l.forEach((function(l){l.match(/^\d+$/)||a.push(f(e,t,i,r,l,!0))})),a}(e,i,r,n,o):o.map((function(t){return f(e,i,r,n,t,$)})),e.seen.pop(),function(e,t,i){if(e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return i[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+i[1];return i[0]+t+" "+e.join(", ")+" "+i[1]}(c,x,T)):T[0]+x+T[1]}function d(e){return"["+Error.prototype.toString.call(e)+"]"}function f(e,t,i,r,l,a){var o,n,s;if((s=Object.getOwnPropertyDescriptor(t,l)||{value:t[l]}).get?n=s.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):s.set&&(n=e.stylize("[Setter]","special")),I(r,l)||(o="["+l+"]"),n||(e.seen.indexOf(s.value)<0?(n=b(i)?u(e,s.value,null):u(e,s.value,i-1)).indexOf("\n")>-1&&(n=a?n.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+n.split("\n").map((function(e){return"   "+e})).join("\n")):n=e.stylize("[Circular]","special")),y(o)){if(a&&l.match(/^\d+$/))return n;(o=JSON.stringify(""+l)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=e.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=e.stylize(o,"string"))}return o+": "+n}function p(e){return Array.isArray(e)}function m(e){return"boolean"==typeof e}function b(e){return null===e}function h(e){return"number"==typeof e}function g(e){return"string"==typeof e}function y(e){return void 0===e}function v(e){return x(e)&&"[object RegExp]"===$(e)}function x(e){return"object"==typeof e&&null!==e}function w(e){return x(e)&&"[object Date]"===$(e)}function F(e){return x(e)&&("[object Error]"===$(e)||e instanceof Error)}function _(e){return"function"==typeof e}function $(e){return Object.prototype.toString.call(e)}t.debuglog=function(i){if(y(a)&&(a=Object({NODE_ENV:"production",BASE_URL:"/"}).NODE_DEBUG||""),i=i.toUpperCase(),!o[i])if(new RegExp("\\b"+i+"\\b","i").test(a)){e.pid;o[i]=function(){t.format.apply(t,arguments)}}else o[i]=function(){};return o[i]},t.inspect=n,n.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},n.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=p,t.isBoolean=m,t.isNull=b,t.isNullOrUndefined=function(e){return null==e},t.isNumber=h,t.isString=g,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=y,t.isRegExp=v,t.isObject=x,t.isDate=w,t.isError=F,t.isFunction=_,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=i("d60a");function I(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){},t.inherits=i("28a0"),t._extend=function(e,t){if(!t||!x(t))return e;for(var i=Object.keys(t),r=i.length;r--;)e[i[r]]=t[i[r]];return e};var T="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function k(e,t){if(!e){var i=new Error("Promise was rejected with a falsy value");i.reason=e,e=i}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(T&&e[T]){var t;if("function"!=typeof(t=e[T]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,T,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,i,r=new Promise((function(e,r){t=e,i=r})),l=[],a=0;a<arguments.length;a++)l.push(arguments[a]);l.push((function(e,r){e?i(e):t(r)}));try{e.apply(this,l)}catch(e){i(e)}return r}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),T&&Object.defineProperty(t,T,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,r(e))},t.promisify.custom=T,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function i(){for(var i=[],r=0;r<arguments.length;r++)i.push(arguments[r]);var l=i.pop();if("function"!=typeof l)throw new TypeError("The last argument must be of type Function");var a=this,o=function(){return l.apply(a,arguments)};t.apply(this,i).then((function(t){e.nextTick(o,null,t)}),(function(t){e.nextTick(k,t,o)}))}return Object.setPrototypeOf(i,Object.getPrototypeOf(t)),Object.defineProperties(i,r(t)),i}}).call(this,i("f28c"))},3908:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var r=function(){return this.$loading({lock:!0,text:"请稍等...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"})}},"3b7c":function(e,t,i){(e.exports=i("2350")(!1)).push([e.i,".primary-color{color:#1740dc}.success-color{color:#52c41a}.warning-color{color:#faad14}.error-color{color:#f5222d}.info-color{color:#909399}.border-color{border:1px solid #e5e6e9}.searchList{width:140px;padding:0 5px}.searchList .title{margin-bottom:5px}.searchList .list{width:100%;height:150px;overflow:auto;margin:10px 0}.searchList .list .el-tree-node__expand-icon{display:none}.searchList .list .el-tree-node__label{width:100%;line-height:20px;padding:0 10px 0 0;cursor:pointer}.searchList .list li:hover{background:#f2f2f2}",""])},"5bea":function(e,t,i){(e.exports=i("2350")(!1)).push([e.i,'.primary-color{color:#1740dc}.success-color{color:#52c41a}.warning-color{color:#faad14}.error-color{color:#f5222d}.info-color{color:#909399}.border-color{border:1px solid #e5e6e9}/deep/ .el-form-item__content{display:-webkit-box!important;display:-ms-flexbox!important;display:flex!important}.createTable-search-list .list-content{min-width:140px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.createTable{position:relative;background-color:#f0f2f5;height:100%}.createTable .customWidth{width:80%;max-width:1000px}.createTable .top{background-color:#fff;height:48px;line-height:48px;border:1px solid #e5e6e9;position:relative}.createTable .top .title{padding:0 20px;font-weight:500;color:#040c2c;font-size:16px}.createTable .content{background-color:#fff;height:calc(100% - 96px);overflow-y:auto;padding:0 20px 15px}.createTable .content .sub-title{line-height:40px}.createTable .content .sub-title .btns{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.createTable .content .sub-title .btns .file{font-size:12px}.createTable .content .sub-title:before{width:2px;height:14px;display:inline-block;content:"";background-color:#1740dc;margin-right:5px;vertical-align:middle}.createTable .content .el-form{width:100%}.createTable .content .el-form .item{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}.createTable .content .el-form .item .el-form-item{width:37.5%;position:relative}.createTable .content .el-form .item .el-form-item.last-child{width:75%}.createTable .content .el-form .el-form-item.is-error .taglist{border-color:#f5222d}.createTable .content .el-form .taglist{min-height:30px;line-height:28px;background-color:#fff;border-radius:4px;border:1px solid #dcdfe6;-webkit-box-sizing:border-box;box-sizing:border-box;color:#606266;padding:0 15px;width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-wrap:wrap;flex-wrap:wrap}.createTable .content .el-form .taglist .tips{line-height:28px;color:#c0c4cc;font-size:12px}.createTable .content .el-form .taglist .tags-item{padding-right:15px;max-width:100px;margin:5px 0 5px 6px;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;background:#f0f2f5;position:relative}.createTable .content .el-form .taglist .tags-item .el-tag__close{position:absolute;top:2px;right:0}.createTable .content .addNew{width:100%;margin-top:10px;height:30px;line-height:30px;color:#040c2c;text-align:center;font-size:12px;border:1px dashed #cdced5}.createTable .content .addNew:hover{color:#1740dc;border-color:#1740dc}.createTable .content .addNew .file{display:inline-block;cursor:pointer}.createTable .content .addNew .clearfix{padding-left:10px;padding-right:10px}.createTable .content .el-table .delete{color:#f5222d}.createTable .content .el-table .primary{color:#1740dc}.createTable .content .el-table .el-form-item .el-form-item__content{margin-left:0!important}.createTable .isCollapse.bottom{width:calc(100% - 64px)}.createTable .bottom{position:fixed;bottom:0;right:0;width:100%;background-color:#fff;text-align:right;height:48px;padding-right:20px;line-height:48px;width:calc(100% - 207px)}',""])},"676d":function(e,t,i){"use strict";i("e297")},"693b":function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"c",(function(){return o})),i.d(t,"d",(function(){return n})),i.d(t,"b",(function(){return s}));var r=i("2b0e"),l=i("fedb"),a=function(e){return r.default.http.post(l.a.addAndEditRealTimeTable,e)},o=function(e){return r.default.http.get(l.a.getRealTimeDetail+"/"+e)},n=function(e){return r.default.http.post(l.a.getTopicInfoList,e)},s=function(e){return r.default.http.post(l.a.getNotInWarehouseSearch,e)}},"6b38":function(e,t,i){"use strict";i("1308")},b056:function(e,t,i){"use strict";i.d(t,"c",(function(){return a})),i.d(t,"d",(function(){return o})),i.d(t,"e",(function(){return n})),i.d(t,"b",(function(){return s})),i.d(t,"a",(function(){return c}));var r=i("fedb"),l=i("83fe"),a=function(e){return l.a.post(r.a.getLevelList,e)},o=function(){return l.a.get(r.a.getRoleSelectNew)},n=function(e){return l.a.post(r.a.sqlSearchLimitSave,e)},s=function(){return l.a.get(r.a.getExploreDownLoadLimit)},c=function(e){var t=e.id;return l.a.get(r.a.getConnExtInfo+"?id=".concat(t))}},b0fc:function(e,t,i){"use strict";i.r(t);i("7f7f"),i("8e6e");var r=i("2909"),l=i("ade3"),a=(i("20d6"),i("96cf"),i("1da1")),o=(i("456d"),i("ac6a"),i("6762"),i("2fdb"),i("3b2b"),i("693b")),n={components:{},props:{itemProps:{type:Object}},data:function(){return{defaultProps:{children:"children",label:"name"},loading:!1,filterText:""}},computed:{},watch:{filterText:function(e){this.$refs.tree.filter(e)}},methods:{chooseItem:function(e){this.$emit("chooseItem",{item:e,key:this.itemProps.key})},filterNode:function(e,t){return!e||-1!==t.name.indexOf(e)}},created:function(){},mounted:function(){}},s=(i("6b38"),i("2877")),c=Object(s.a)(n,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"searchList"},["resource"!=e.itemProps.key?t("div",{staticClass:"title"},[e._v(e._s(e.itemProps.title))]):t("div",{staticClass:"title"},[e._v("\n        "+e._s(e.itemProps.title)+"\n        "),t("el-tooltip",{staticClass:"item",staticStyle:{"font-size":"14px"},attrs:{effect:"dark",content:"支持的数据源类型：Mysql、Oracle、SQLserver、Postgresql、Hive、默认hive、默认impala、默认kafka、其他数据源",placement:"top-start"}},[t("i",{staticClass:"icon icon-ic_remind"})])],1),t("el-input",{attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),t("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"tree",staticClass:"filter-tree list zt-scrollbar",attrs:{data:e.itemProps.list,props:e.defaultProps,"default-expand-all":"","highlight-current":!0,"filter-node-method":e.filterNode},on:{"node-click":e.chooseItem}})],1)}),[],!1,null,null,null).exports,u=(i("1c46"),i("1619"),i("b056"));i("3908"),i("3022");function d(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function f(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?d(Object(i),!0).forEach((function(t){Object(l.a)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):d(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var p,m,b,h={components:{searchList:c},data:function(){return{lazyTableLength:10,filterName:"",filterTableData:[],dropOptions:[],sliceNum:10,loadCount:20,lazyTableBool:!1,curType:"add",tableLoading:!1,isSubmit:!1,isAdd:!1,loadingPage:!1,submitLoading:!1,defaultProps:{children:"children",label:"name"},themeList:[],categoryList:[],itemProps:{resource:{searchKey:"",key:"resource",title:"数据源",list:[]},database:{searchKey:"",key:"database",title:"数据库",list:[]},table:{searchKey:"",key:"table",title:"表",list:[]},field:{searchKey:"",key:"field",title:"字段",list:[]}},curIndex:0,type:1,roleList:[],ruleForm:{id:0,dbName:"",tableName:"",tableAlias:"",format:"",cateGoryIdsList:[],delimitId:1,storeEngine:"",categoryIds:"",subjectIds:"",longLifeFlag:0,lifeCycle:"",roleId:"",desc:"",createPer:"",createPerName:"",createTime:"",tableFieldInfos:[]},file:"",fileList:[],limitNum:2,optionsOne:[],optionsTwo:[],optionsThree:[],engineList:[{value:1,label:"hive引擎"},{value:2,label:"kudu引擎"}],options01:[],options02:[{value:1,label:"是"},{value:0,label:"否"}],rules:{cateGoryIdsList:[{required:!0,message:"请选择资产类目",trigger:"change"}],dbName:[{required:!0,message:"请选择类型",trigger:"change"}],tableName:[{required:!0,message:"请输入表名",trigger:"blur"},{validator:function(e,t,i){""!=t&&(!RegExp("^[a-zA-Z][a-zA-Z0-9_]*$").test(t)||t.length<2||t.length>100)?i(new Error("必须以英文开头，数字，下划线组合，2-100字符以内")):i()},trigger:"blur"}],format:[{required:!0,message:"请选择格式",trigger:"change"}],delimitId:[{required:!0,message:"请选择格式",trigger:"change"}],storeEngine:[{required:!0,message:"请选择存储引擎",trigger:"change"}],roleId:[{required:!0,message:"请选择角色授权",trigger:"change"}],tableAlias:[{required:!0,message:"请填写表别名",trigger:"blur"},{validator:function(e,t,i){RegExp('^[一-龥A-Za-z][^/、"]*$').test(t)?t.includes(" ")||t.includes("\t")?i(new Error("不允许带有空格")):i():i(new Error("格式错误"))},trigger:"blur"}],desc:[{required:!0,message:"请填写表描述",trigger:"blur"}],fieldName:[{required:!0,message:"请输入字段名",trigger:"blur"},{validator:function(e,t,i){""!=t&&(!RegExp("^[a-zA-Z`][-_/.a-zA-Z0-9`]*$").test(t)||t.length<2||t.length>50)?i(new Error("必须以英文或`开头，数字，下划线或.或-或`组合，2-50字符以内")):i()},trigger:"blur"}],lifeCycle:[{validator:function(e,t,i){null!=t&&""!=t&&(!RegExp("^[0-9]*$").test(t)||t>99999||t<=0)?i(new Error("请输入99999以内正整数")):i()},message:"请输入1~99999以内正整数",trigger:"change"}]},dialogVisible:!1,form:{dataSource:"",database:"",table:""},dataSourceList:[],tableList:[],databaseList:[]}},watch:{$route:{handler:function(e,t){this.init(this.$route.query.id,this.$route.query.type)},deep:!0}},computed:{isToStringDisabled:function(){return this.ruleForm.tableFieldInfos.every((function(e){return"STRING"===e.fieldType}))},title:function(){var e="";return this.$route.query.id?2==this.$route.query.type?(e="复制离线表",this.curType="copy"):(e=this.$route.query.isLake?"新建离线表":"修改离线表",this.curType="edit"):(e="新建离线表",this.curType="add"),e},isCollapse:function(){return this.$store.state.old.isCollapse}},mounted:function(){document.querySelector(".createTable .el-table__body-wrapper").addEventListener("scroll",this.tableScroll)},beforeDestroy:function(){document.querySelector(".createTable .el-table__body-wrapper").removeEventListener("scroll",this.tableScroll)},methods:{tableScroll:function(){var e=document.querySelector(".createTable .el-table__body-wrapper");e.scrollHeight-(e.scrollTop+e.clientHeight)<1&&(this.lazyTableLength+=20)},filterData:function(e){this.filterName=e,this.filterTableData=this.tableList.filter((function(t){return t.tableName.indexOf(e)>-1})),this.dropOptions=this.filterTableData.slice(0,this.sliceNum)},isSelectLazy:function(e){var t=this;this.sliceNum=10,this.filterName="",this.dropOptions=this.tableList.slice(0,this.sliceNum),e&&(this.selectDom=document.querySelectorAll(".el-scrollbar__wrap"),Array.prototype.forEach.call(this.selectDom,(function(e){e.addEventListener("scroll",(function(){e.scrollHeight-(e.scrollTop+e.clientHeight)<1&&(t.sliceNum+=20,t.filterName?t.dropOptions=t.filterTableData.slice(0,t.sliceNum):t.dropOptions=t.tableList.slice(0,t.sliceNum))}))})))},handleToString:function(){this.ruleForm.tableFieldInfos.forEach((function(e){e.fieldType="STRING"})),this.$message.success("修改字段类型成功")},clearInput:function(e){var t=this;Object.keys(this.itemProps).forEach((function(i){t.$refs[i][e].filterText=""}))},bdpDataThemeList:(b=Object(a.a)(regeneratorRuntime.mark((function e(){var t,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(o.b)({type:"my",permissionType:17});case 2:t=e.sent,0==(i=t.data).code&&i.data?(this.themeList=i.data.list.children,this.themeList.map((function(e){"1"!=e.id&&"2"!=e.id||(e.disabled=!0)})),this.themeList=this.themeList.filter((function(e){return!(("1"==e.id||"2"==e.id)&&0==e.children.length)}))):this.$message.error(i.msg);case 5:case"end":return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)}),bdpDataCategoryList:function(){var e=this;this.$API.get(this.$URL.bdpDataCategoryList,{},(function(t){0==t.code?t.data&&(e.categoryList=t.data):e.$message.error(t.msg)}))},numChange:function(){this.ruleForm.lifeCycle>99999&&(this.ruleForm.lifeCycle=99999)},validityChange:function(){this.ruleForm.longLifeFlag&&this.$refs.lifeCycle.resetField()},chooseItem:function(e,t,i){var r={searchKey:"",list:[]},l=this.itemProps;if("resource"==e.key)this.itemProps.resource.searchKey=e.item.id,this.$refs.database[t].filterText="",this.$refs.table[t].filterText="",this.$refs.field[t].filterText="",this.getDataBase("single",e.item.id),Object.assign(l.database,r),Object.assign(l.table,r),Object.assign(l.field,r);else if("database"==e.key)this.itemProps.database.searchKey=e.item.name,this.$refs.table[t].filterText="",this.$refs.field[t].filterText="",this.getTable("single",l.resource.searchKey,l.database.searchKey),Object.assign(l.table,r),Object.assign(l.field,r);else if("table"==e.key)this.itemProps.table.searchKey=e.item.id,this.$refs.field[t].filterText="",this.getField("single",l.resource.searchKey,l.database.searchKey,l.table.searchKey),Object.assign(l.field,r);else if("field"==e.key){if(this.itemProps.field.searchKey=e.item.name,-1!==this.ruleForm.tableFieldInfos[this.curIndex].relationshipes.findIndex((function(e){return e.relationCollTableId+e.relationFieldName==l.table.searchKey+l.field.searchKey})))return void this.$message.error("字段血缘不可重复选择，请确认！");this.ruleForm.tableFieldInfos[this.curIndex].relationshipes.push(e.item.relationshipes[0])}},resourceList:function(e){this.curIndex=e,this.itemProps={resource:{searchKey:"",key:"resource",title:"数据源",list:[]},database:{searchKey:"",key:"database",title:"数据库",list:[]},table:{searchKey:"",key:"table",title:"表",list:[]},field:{searchKey:"",key:"field",title:"字段",list:[]}},this.getResource("single")},getResource:function(e){var t=this;this.$refs.resource.length&&"single"==e&&(this.$refs.resource[this.curIndex].loading=!0),this.dataSourceList=[],this.form.dataSource="",this.databaseList=[],this.form.database="",this.$API.post(this.$URL.getlistMetaCon,{page:1,limit:99999,enable:1},(function(i){0==i.code?(t.dataSourceList=i.data,"single"!=e?t.dialogVisible=!0:(t.itemProps.resource.list=t.dataSourceList,t.$refs.resource[t.curIndex].loading=!1)):(t.$refs.resource.length&&"single"==e&&(t.$refs.resource[t.curIndex].loading=!1),t.$message.error(i.msg))}))},getDataBase:function(e,t){var i=this;this.$refs.database.length&&"single"==e&&(this.$refs.database[this.curIndex].loading=!0),this.databaseList=[],this.form.database="",this.form.table="",this.$API.get(this.$URL.getMetaDbNames+"/"+t,{},(function(t){if(0==t.code){if(i.databaseList=t.data||[],"single"==e){var r=[];i.databaseList.forEach((function(e){r.push({name:e})})),i.itemProps.database.list=r}i.$refs.database.length&&"single"==e&&(i.$refs.database[i.curIndex].loading=!1)}else i.$refs.database.length&&"single"==e&&(i.$refs.database[i.curIndex].loading=!1),i.$message.error(t.msg)}))},getTable:function(e,t,i){var r=this;this.tableLoading=!0,this.$refs.table.length&&"single"==e&&(this.$refs.table[this.curIndex].loading=!0),this.form.table="",this.tableList=[];var l={currentTableId:this.$route.query.id,dbName:i||this.form.database,sourceId:"single"==e?t:this.form.dataSource};this.$API.post(this.$URL.getTableInfoField,l,(function(t){0==t.code?(r.tableList=t.data,"single"==e&&(r.tableList.forEach((function(e){e.name=e.tableName})),r.itemProps.table.list=r.tableList),r.tableLoading=!1,r.tableList=r.tableList.map((function(e){return f(f({},e),{},{uuid:Math.random()})})),r.dropOptions=r.tableList.slice(0,r.sliceNum),r.$refs.table.length&&"single"==e&&(r.$refs.table[r.curIndex].loading=!1)):(r.tableLoading=!1,r.$refs.table.length&&"single"==e&&(r.$refs.table[r.curIndex].loading=!1),r.$message.error(t.msg))}))},getField:function(e,t,i,l){var a=this;this.$refs.field.length&&"single"==e&&(this.$refs.field[this.curIndex].loading=!0);var o={collTableId:l||this.form.table};this.$API.post(this.$URL.getTableInfoFieldRelation,o,(function(t){if(0==t.code){var i;if(t.data.tableFieldInfos.forEach((function(e){e.name=e.fieldName})),"single"==e)a.itemProps.field.list=t.data.tableFieldInfos,a.$refs.field[a.curIndex].loading=!1;else a.handlerFilter(),(i=a.ruleForm.tableFieldInfos).push.apply(i,Object(r.a)(t.data.tableFieldInfos));a.isAdd=!1}else a.isAdd=!1,a.$refs.field.length&&"single"==e&&(a.$refs.field[a.curIndex].loading=!1),a.$message.error(t.msg)}))},handlerFilter:function(){this.dialogVisible=!1,this.ruleForm.tableFieldInfos=this.ruleForm.tableFieldInfos.length?this.ruleForm.tableFieldInfos.filter((function(e){return e.relationshipes&&0!=e.relationshipes.length||""!=e.fieldAlias||""!=e.fieldType||""!=e.fieldName})):[],this.loadCount=20,this.lazyTable()},submitForm:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return!1;e.isAdd||(e.isAdd=!0,e.getField())}))},close:function(){this.$refs.ruleForm.resetFields(),this.dialogVisible=!1,this.form={dataSource:"",database:"",table:""},this.dataSourceList=[],this.databaseList=[],this.tableList=[]},delTags:function(e,t){this.ruleForm.tableFieldInfos[t].relationshipes.splice(e,1)},handleClose:function(e){this.$confirm("确认关闭？").then((function(t){e()})).catch((function(e){}))},tableNameEn:function(e){new RegExp("^[a-zA-Z][-_0-9a-zA-Z]*$").test(e.target.value)||(e.target.value="")},addNew:function(){this.lazyTableLength+=1,this.ruleForm.tableFieldInfos.unshift({fieldName:"",fieldType:"",fieldAlias:"",isPartition:0,primaryKey:0,fieldOrder:"",relationshipes:[]})},deleteCur:function(e){this.ruleForm.tableFieldInfos.splice(e,1)},addNext:function(e){var t=this.ruleForm.tableFieldInfos[e].fieldType,i=this.ruleForm.tableFieldInfos[e].isPartition;this.ruleForm.tableFieldInfos.splice(e+1,0,{fieldName:"",fieldType:t,fieldAlias:"",isPartition:i,fieldOrder:"",relationshipes:[]})},exceedFile:function(e,t){this.$notify.warning({title:"警告",message:"只能选择 ".concat(this.limitNum," 个文件，当前共选择了 ").concat(e.length+t.length," 个")})},fileChange:function(e,t){t.length>1&&t.splice(0,1),this.fileList=t,this.file=e.raw,this.uploadFile()},handleRemove:function(e,t){this.fileList=t},beforeUploadFile:function(e){var t=e.name.substring(e.name.lastIndexOf(".")+1),i=e.size/1024/1024;"csv"!==t&&this.$message({message:"只能上传csv的文件",type:"警告"}),i>10&&this.$message({message:"文件大小不得超过10M",type:"警告"})},handleSuccess:function(e,t,i){this.$message({message:"上传成功！",type:"success"})},handleError:function(e,t,i){this.$message.error("文件上传失败")},uploadFile:function(){var e=this;if(0==this.fileList.length)return this.$message.error("请选择要上传的文件！"),!1;var t=new FormData;t.append("file",this.file);var i=t;this.$API.file(this.$URL.getTableInfoUploadField,i,(function(t){var i;0==t.code?(e.file="",e.$refs.uploadFile.clearFiles(),e.handlerFilter(),(i=e.ruleForm.tableFieldInfos).push.apply(i,Object(r.a)(t.data)),e.ruleForm.tableFieldInfos.forEach((function(e){e.relationshipes||(e.relationshipes=[])})),e.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){}})):(e.file="",e.$refs.uploadFile.clearFiles(),e.$message.error(t.msg))}))},downloadFile:function(){var e=this;this.$API.downLoad(this.$URL.getTableInfoDownloadField,{},(function(t){e.download(t.data,t.headers.filename)}))},download:function(e,t){if(e){var i=window.URL.createObjectURL(new Blob([e])),r=document.createElement("a");r.style.display="none",r.href=i,r.setAttribute("download",t),document.body.appendChild(r),r.click()}},getlistDbs:function(){var e=this;this.$API.get(this.$URL.getTableInfoListDbs,{},(function(t){if(0==t.code){e.optionsOne=[];for(var i=0;i<t.data.length;i++)e.optionsOne.push({value:t.data[i],name:t.data[i]})}else e.$message.error(t.msg)}))},getlistFormat:function(){var e=this;this.$API.get(this.$URL.getTableInfoListDataFormats,{},(function(t){if(0==t.code){e.optionsTwo=[];for(var i=0;i<t.data.length;i++)e.optionsTwo.push({value:t.data[i],name:t.data[i]})}else e.$message.error(t.msg)}))},getlistDelimit:function(){var e=this;this.$API.get(this.$URL.getTableInfoListDelimitFormats,{},(function(t){0==t.code?(e.optionsThree=[],e.optionsThree=t.data):e.$message.error(t.msg)}))},changeStoreEngine:function(){this.listDataTypes()},listDataTypes:function(){var e=this,t={type:2==this.ruleForm.storeEngine?2:1};this.$API.get(this.$URL.getTableInfoListDataTypes,t,(function(t){if(0==t.code){e.options01=[];for(var i=0;i<t.data.length;i++)e.options01.push({value:t.data[i],name:t.data[i]});e.options01=e.options01.filter((function(e){return"SQLINJECT"!=e.value}))}else e.$message.error(t.msg)}))},lazyTable:function(){var e=this;this.lazyTableBool=!1,setTimeout((function(){e.loadCount+=20,e.loadCount>=e.ruleForm.tableFieldInfos.length?(e.lazyTableBool=!0,e.loadingPage=!1):e.lazyTable()}),200)},getTableDetail:function(e){var t=this;this.loadingPage=!0,this.$API.get(this.$URL.getTableInfoInfo+e,{page:1,limit:999},(function(e){0===e.code?(t.ruleForm=e.data,t.listDataTypes(),"copy"==t.curType&&(t.ruleForm.categoryIds=[],t.ruleForm.subjectIds=[]),setTimeout((function(){t.ruleForm.cateGoryIdsList=t.$refs.cascader.getCheckedNodes().map((function(e){return e.value}))}),1e3),t.ruleForm.tableFieldInfos.forEach((function(e){e.relationshipes||(e.relationshipes=[])})),t.lazyTable()):t.$message.error(e.msg),t.loadingPage=!1}))},sure:function(){var e=this;this.$refs.ruleForm.validate((function(t){if(t){if(e.isSubmit)return;e.isSubmit=!0;for(var i=0;i<e.ruleForm.tableFieldInfos.length;i++)e.ruleForm.tableFieldInfos[i].fieldOrder=i+1;var r={};"text"==e.ruleForm.format&&(r={delimitId:e.ruleForm.delimitId});var l=f(f({id:e.ruleForm.id?e.ruleForm.id:null,dbName:e.ruleForm.dbName,tableName:e.ruleForm.tableName,format:e.ruleForm.format},r),{},{roleId:e.ruleForm.roleId,tableAlias:e.ruleForm.tableAlias,longLifeFlag:e.ruleForm.longLifeFlag,storeEngine:e.ruleForm.storeEngine,categoryIds:e.ruleForm.categoryIds,subjectIds:e.ruleForm.subjectIds,cateGoryIdsList:e.ruleForm.cateGoryIdsList,lifeCycle:e.ruleForm.longLifeFlag?null:e.ruleForm.lifeCycle,desc:e.ruleForm.desc,tableFieldInfos:e.ruleForm.tableFieldInfos,collectionTableId:e.$route.query.isLake?e.$route.query.id:null});e.submitLoading=!0,e.loadingPage=!0,e.$API.post("".concat(!e.ruleForm.id||2==e.type||e.$route.query.isLake?e.$URL.getTableInfoSave:e.$URL.getTableInfoUpdate),l,(function(t){e.loadingPage=!1,0===t.code?(e.isSubmit=!1,e.$refs.ruleForm.resetFields(),e.ruleForm.tableFieldInfos=[{fieldName:"",fieldType:"",fieldAlias:"",isPartition:0,primaryKey:0,fieldOrder:"",relationshipes:[]}],e.$emit("refreshDataList"),e.$message({message:"操作成功！",type:"success"}),e.$router.go(-1)):(e.isSubmit=!1,e.$message.error(t.msg)),e.submitLoading=!1}))}}))},getRoleList:(m=Object(a.a)(regeneratorRuntime.mark((function e(){var t,i,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(u.d)();case 2:t=e.sent,i=t.data.data,r=void 0===i?[]:i,this.roleList=r;case 6:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)}),init:(p=Object(a.a)(regeneratorRuntime.mark((function e(t,i){var l,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.type=i,e.next=3,this.bdpDataThemeList();case 3:this.getlistDbs(),this.getlistFormat(),this.getlistDelimit(),this.getRoleList(),this.ruleForm.id=t||0,t?this.$route.query.isLake?(l={collTableId:this.$route.query.id},this.$API.post(this.$URL.getTableInfoFieldRelation,l,(function(e){var t;0==e.code?(e.data.tableFieldInfos.forEach((function(e){e.name=e.fieldName})),"single"==i?(a.itemProps.field.list=e.data.tableFieldInfos,a.$refs.field[a.curIndex].loading=!1):((t=a.ruleForm.tableFieldInfos).push.apply(t,Object(r.a)(e.data.tableFieldInfos)),a.close()),a.isAdd=!1):(a.isAdd=!1,a.$refs.field.length&&"single"==i&&(a.$refs.field[a.curIndex].loading=!1),a.$message.error(e.msg))}))):this.$nextTick((function(){this.getTableDetail(t)})):this.$nextTick((function(){this.lazyTableBool=!0,this.$refs.ruleForm.resetFields(),this.ruleForm.tableFieldInfos=[{roleId:"",fieldName:"",fieldType:"",fieldAlias:"",isPartition:0,primaryKey:0,fieldOrder:"",relationshipes:[]}]}));case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return p.apply(this,arguments)}),fixCascader:function(){for(var e=document.querySelectorAll(".el-cascader__search-input"),t=0;t<e.length;t++)e[t].setAttribute("placeholder","请选择")}},created:function(){this.init(this.$route.query.id,this.$route.query.type)},updated:function(){this.fixCascader()}},g=(i("676d"),Object(s.a)(h,(function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingPage,expression:"loadingPage"}],staticClass:"createTable"},[t("div",{staticClass:"top"},[t("span",{staticClass:"title"},[e._v(e._s(e.title))])]),t("div",{staticClass:"content zt-scrollbar"},[t("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{"label-position":"left",model:e.ruleForm,rules:e.rules,"label-width":"120px"}},[t("div",{staticClass:"sub-title"},[t("span",[e._v("基本信息")])]),t("div",{staticClass:"item"},[t("el-form-item",{staticClass:"topform",attrs:{label:"数据库",prop:"dbName"}},[t("el-select",{staticStyle:{width:"260px"},attrs:{placeholder:"请选择",disabled:0!=e.ruleForm.id&&2!=e.type},model:{value:e.ruleForm.dbName,callback:function(t){e.$set(e.ruleForm,"dbName",t)},expression:"ruleForm.dbName"}},e._l(e.optionsOne,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{staticClass:"topform",attrs:{label:"中文表名",prop:"tableAlias"}},[t("el-input",{staticStyle:{width:"240px"},attrs:{maxlength:"50",placeholder:"用简短中文描述表的业务含义"},model:{value:e.ruleForm.tableAlias,callback:function(t){e.$set(e.ruleForm,"tableAlias",t)},expression:"ruleForm.tableAlias"}}),t("el-tooltip",{staticStyle:{"margin-left":"6px"},attrs:{effect:"dark",content:"以中英文开头，支持数字，特殊字符（除空格、/外）等50个字符的组合",placement:"top-start"}},[t("i",{staticClass:"icon icon-ic_remind"})])],1),t("el-form-item",{staticClass:"topform",attrs:{label:"英文表名称",prop:"tableName"}},[t("el-input",{staticStyle:{width:"240px"},attrs:{placeholder:"请输入英文表名"},model:{value:e.ruleForm.tableName,callback:function(t){e.$set(e.ruleForm,"tableName",t)},expression:"ruleForm.tableName"}}),t("el-tooltip",{staticStyle:{"margin-left":"6px"},attrs:{effect:"dark",placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n            PRE/ODS表命名规范：ods.ods_{源系统名/库名}_{源系统表名}_[_单分区增量全量标识]_{刷新周期标识}"),t("br"),e._v("\n            Eg. 日刷增量：ods.ods_jthr_employee_icr_daily"),t("br"),e._v("\n            Eg. 日刷全量：ods.ods_jthr_employee_full_daily"),t("br"),e._v("\n\n            DWD层表命名：dwd.dwd_{业务BU缩写/pub}_{数据域缩写}_{业务过程缩写}[_{自定义表命名标签缩写}]_{刷新周期标识}_{单分区增量全量标识}。pub表示数据包括多个BU的数据"),t("br"),e._v("\n            Eg. dwd.dwd_pub_policy_icr_daily (日刷新增量)"),t("br"),e._v("\n\n            DWS层表名：dws.dws_{业务BU缩写/pub}_{数据域或主题缩写}_{数据粒度缩写}[_{自定义表命名标签缩写}]_{统计时间周期范围缩写}[_刷新周期标识][_单分区增量全量标识]。"),t("br"),e._v("\n            Eg.  dws.dws_pub_policy_1d_full_daily (最近一天保单统计，日刷全量)"),t("br"),e._v("\n\n            ADS层表名：ads.ads_{业务BU缩写/pub}_{数据域或主题缩写}_{数据粒度缩写}[_{自定义表命名标签缩写}]_{统计时间周期范围缩写}[_刷新周期标识][_单分区增量全量标识]。"),t("br"),e._v("\n            Eg.  ads.ads_pub_policy_1d_full_daily (最近一天保单统计，日刷全量)"),t("br"),e._v("\n\n            注："),t("br"),e._v("\n            1、icr表示增量；full表示全量；"),t("br"),e._v("\n            2、一次性导入：once（或缺省）；小时更新:hourly、h； 按天更新:daily、d；按周更新:weekly、w；按月更新:monthly、m；按年更新:yearly、y；季度:quarterly、q;实时:really、r；"),t("br"),e._v("\n            3、关于统计时间周期范围缩写，缺省情况下，离线计算应该包括最近一天（_1d）,最近N天（_nd）和历史截至当天(_td)三个表，如果出现_nd的表字段过多，需要拆分之时，"),t("br"),e._v("\n            只允许以一个统计周期单元作为原子拆分，也就是说一个统计周期拆分一个表，比如最近7天(_1w)拆分一个表；不允许拆分出来的一个表存储多个统计周期的；"),t("br"),e._v("\n            更多请查看命名手册..."),t("br")]),t("i",{staticClass:"icon icon-ic_remind"})])],1),t("el-form-item",{staticClass:"topformtwo",attrs:{label:"格式",prop:"format"}},[t("el-row",{attrs:{type:"flex"}},[t("el-select",{staticStyle:{width:"240px"},attrs:{placeholder:"请选择格式"},model:{value:e.ruleForm.format,callback:function(t){e.$set(e.ruleForm,"format",t)},expression:"ruleForm.format"}},e._l(e.optionsTwo,(function(e){return t("el-option",{key:e.value,attrs:{filterable:"",label:e.label,value:e.value}})})),1),t("el-tooltip",{staticClass:"item",staticStyle:{"margin-left":"6px"},attrs:{effect:"dark",content:"请注意：修改数据表格式后历史数据可能无法显示",placement:"right-start"}},[t("i",{staticClass:"icon icon-ic_remind",staticStyle:{width:"20px"}})])],1)],1),"text"==e.ruleForm.format?t("el-form-item",{staticClass:"topformtwo",attrs:{label:"分隔符",prop:"delimitId"}},[t("el-select",{staticStyle:{width:"260px"},attrs:{placeholder:"请选择分隔符"},model:{value:e.ruleForm.delimitId,callback:function(t){e.$set(e.ruleForm,"delimitId",t)},expression:"ruleForm.delimitId"}},e._l(e.optionsThree,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),t("el-form-item",{staticClass:"storeEngine",attrs:{label:"存储引擎",prop:"storeEngine"}},[t("el-select",{staticStyle:{width:"260px"},attrs:{disabled:0!=e.ruleForm.id&&2!=e.type,placeholder:"请选择存储引擎"},on:{change:e.changeStoreEngine},model:{value:e.ruleForm.storeEngine,callback:function(t){e.$set(e.ruleForm,"storeEngine",t)},expression:"ruleForm.storeEngine"}},e._l(e.engineList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),1!=e.$route.query.type?t("el-form-item",{attrs:{label:"初始角色授权",prop:"roleId"}},[t("el-row",{attrs:{type:"flex"}},[t("el-select",{staticStyle:{width:"240px"},attrs:{filterable:"",placeholder:"请选择初始角色授权"},model:{value:e.ruleForm.roleId,callback:function(t){e.$set(e.ruleForm,"roleId",t)},expression:"ruleForm.roleId"}},e._l(e.roleList,(function(e){return t("el-option",{key:e.roleId,staticStyle:{width:"240px"},attrs:{label:e.roleName,value:e.roleId}})})),1),t("el-tooltip",{staticClass:"item",staticStyle:{"margin-left":"6px"},attrs:{effect:"dark",content:"新建表需要初始角色默认授权，后期权限修改请前往权限管理中进行修改",placement:"right-start"}},[t("i",{staticClass:"icon icon-ic_remind",staticStyle:{width:"20px"}})])],1)],1):e._e(),t("el-form-item",{staticClass:"textarea last-child",attrs:{label:"表描述",prop:"desc"}},[t("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",rows:"3",placeholder:"填写表描述"},model:{value:e.ruleForm.desc,callback:function(t){e.$set(e.ruleForm,"desc",t)},expression:"ruleForm.desc"}})],1)],1),t("div",{staticClass:"sub-title"},[t("span",[e._v("物理模型设计")])]),t("div",{staticClass:"item"},[t("el-form-item",{staticClass:"topform",attrs:{label:"资产类目",prop:"cateGoryIdsList",rules:{required:!0,message:"请选择资产类目",trigger:"change"}}},[t("el-cascader",{ref:"cascader",staticStyle:{width:"260px !important"},attrs:{options:e.themeList,placeholder:"",props:{emitPath:!1,checkStrictly:!0,value:"id",multiple:!0},"show-all-levels":!0,clearable:"",filterable:""},model:{value:e.ruleForm.cateGoryIdsList,callback:function(t){e.$set(e.ruleForm,"cateGoryIdsList",t)},expression:"ruleForm.cateGoryIdsList"}})],1),t("el-form-item",{ref:"lifeCycle",staticClass:"topform",attrs:{label:"生命周期",prop:"lifeCycle"}},[t("el-input",{staticStyle:{width:"120px"},attrs:{type:"number",min:1,max:99999,disabled:!!e.ruleForm.longLifeFlag},on:{blur:e.numChange},model:{value:e.ruleForm.lifeCycle,callback:function(t){e.$set(e.ruleForm,"lifeCycle",t)},expression:"ruleForm.lifeCycle"}}),e._v("\n               天  \n              "),t("el-checkbox",{attrs:{"true-label":1,"false-label":0},on:{change:e.validityChange},model:{value:e.ruleForm.longLifeFlag,callback:function(t){e.$set(e.ruleForm,"longLifeFlag",t)},expression:"ruleForm.longLifeFlag"}},[e._v("长期")])],1)],1),t("div",{staticClass:"sub-title"},[t("span",[e._v("字段信息")]),t("li",{staticClass:"fr btns"},[t("el-button",{staticStyle:{"margin-right":"0px"},attrs:{type:"text"},on:{click:e.getResource}},[e._v("通过元数据获取表结构")]),t("el-button",{staticStyle:{"margin-right":"10px"},attrs:{disabled:e.isToStringDisabled,type:"text"},on:{click:e.handleToString}},[e._v("一键修改字段类型为STRING")]),t("el-dropdown",[t("span",{staticClass:"el-dropdown-link",staticStyle:{color:"#1740DC"}},[e._v("\n              更多"),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",[t("el-upload",{ref:"uploadFile",staticStyle:{"margin-right":"10px"},attrs:{action:"null",limit:e.limitNum,"auto-upload":!1,accept:".csv","before-upload":e.beforeUploadFile,"on-change":e.fileChange,"on-remove":e.handleRemove,"on-exceed":e.exceedFile,"on-success":e.handleSuccess,"on-error":e.handleError,"file-list":e.fileList,"show-file-list":!1}},[t("div",{staticClass:"file",staticStyle:{color:"#000","font-size":"12px","font-family":"arial"},attrs:{size:"small",plain:""}},[t("i",{staticClass:"el-icon-upload2"}),e._v("上传字段")])])],1),t("el-dropdown-item",[t("el-button",{staticClass:"file",attrs:{type:"text"},on:{click:function(t){return e.downloadFile()}}},[t("i",{staticClass:"el-icon-download"}),e._v("下载模板")])],1)],1)],1)],1)]),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.ruleForm.tableFieldInfos.slice(0,e.lazyTableLength),height:"300"}},[t("el-table-column",{attrs:{label:"序号",type:"index",width:"50",align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",{staticStyle:{position:"relative",top:"-7px"}},[e._v("\n                "+e._s(i.$index+1)+"\n              ")])]}}])}),t("el-table-column",{attrs:{label:"字段名",width:"340"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-form-item",{attrs:{prop:"tableFieldInfos."+i.$index+".fieldName",rules:e.rules.fieldName}},[t("el-input",{attrs:{placeholder:"必须以英文或`开头，数字，下划线或.或-或`组合，2-50字符以内"},model:{value:i.row.fieldName,callback:function(t){e.$set(i.row,"fieldName",t)},expression:"scope.row.fieldName"}})],1)]}}])}),t("el-table-column",{attrs:{width:"150",label:"类型"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-form-item",{attrs:{prop:"tableFieldInfos."+i.$index+".fieldType",rules:{required:!0,message:"类型不能为空",trigger:"change"}}},[t("el-select",{attrs:{"allow-create":"",filterable:"","default-first-option":"",placeholder:"请选择"},model:{value:i.row.fieldType,callback:function(t){e.$set(i.row,"fieldType",t)},expression:"scope.row.fieldType"}},e._l(e.options01,(function(e,i){return t("el-option",{key:i,attrs:{label:e.label,value:e.value}})})),1)],1)]}}])}),t("el-table-column",{attrs:{width:"80",label:"分区"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-form-item",{attrs:{prop:"tableFieldInfos."+i.$index+".isPartition",rules:{required:!0,message:"分区不能为空",trigger:"change"}}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:i.row.isPartition,callback:function(t){e.$set(i.row,"isPartition",t)},expression:"scope.row.isPartition"}},e._l(e.options02,(function(e,i){return t("el-option",{key:i,attrs:{label:e.label,value:e.value}})})),1)],1)]}}])}),t("el-table-column",{attrs:{width:"150",label:"业务含义"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-form-item",{attrs:{prop:"tableFieldInfos."+i.$index+".fieldAlias",rules:[{required:!0,message:"业务含义不能为空",trigger:"blur"},{min:2,max:1024,message:"请输入2-1024个字符！",trigger:"change"}]}},[t("el-input",{attrs:{placeholder:"请输入业务含义"},model:{value:i.row.fieldAlias,callback:function(t){e.$set(i.row,"fieldAlias",t)},expression:"scope.row.fieldAlias"}})],1)]}}])}),2==e.ruleForm.storeEngine?t("el-table-column",{attrs:{width:"80",label:"主键"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-form-item",{attrs:{prop:"tableFieldInfos."+i.$index+".primaryKey"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:i.row.primaryKey,callback:function(t){e.$set(i.row,"primaryKey",t)},expression:"scope.row.primaryKey"}},e._l(e.options02,(function(e,i){return t("el-option",{key:i,attrs:{label:e.label,value:e.value}})})),1)],1)]}}],null,!1,101464876)}):e._e(),t("el-table-column",{attrs:{label:"字段血缘"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-form-item",{attrs:{prop:"tableFieldInfos."+i.$index+".relationshipes"}},[t("el-popover",{attrs:{placement:"bottom-start","popper-class":"createTable-search-list",width:"600",trigger:"click"},on:{hide:function(t){return e.clearInput(i.$index)}}},[t("div",{staticClass:"list-content"},e._l(e.itemProps,(function(r,l,a){return t("search-list",{key:a,ref:l,refInFor:!0,attrs:{itemProps:r},on:{chooseItem:function(t){return e.chooseItem(t,i.$index,a)}}})})),1),t("div",{staticClass:"taglist",attrs:{slot:"reference"},on:{click:function(t){return e.resourceList(i.$index)}},slot:"reference"},[i.row.relationshipes.length?e._e():t("span",{staticClass:"tips"},[e._v("请选择字段血缘")]),e._l(i.row.relationshipes,(function(r,l){return t("el-tooltip",{key:l,staticClass:"tags-item",attrs:{effect:"dark",content:"".concat(r.relationSourceName,"/").concat(r.relationDbname,"/").concat(r.relationTableName,"/").concat(r.relationFieldName),placement:"top"}},[t("el-tag",{attrs:{closable:"",size:"mini",type:"info"},on:{close:function(t){return e.delTags(l,i.$index)}}},[e._v("\n                    "+e._s(r.relationFieldName)+"\n                  ")])],1)}))],2)])],1)]}}])}),t("el-table-column",{attrs:{label:"操作","header-align":"right",align:"right",width:"100"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("div",{staticStyle:{position:"relative",top:"-7px"}},[t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){return e.deleteCur(i.$index)}}},[e._v("删除")]),t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){return e.addNext(i.$index)}}},[e._v("插入")])],1)]}}])})],1)],1),t("ul",{staticClass:"addNew clearfix"},[t("li",{staticClass:"file",on:{click:function(t){return e.addNew()}}},[t("i",{staticClass:"el-icon-plus"}),e._v("添加新字段")])])],1),t("div",{staticClass:"bottom",class:{isCollapse:e.isCollapse}},[t("el-button",{on:{click:function(t){return e.$router.go(-1)}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary",loading:e.submitLoading},on:{click:function(t){return e.sure()}}},[e._v("确定")])],1),t("el-dialog",{staticStyle:{"text-align":"left"},attrs:{title:"选择表结构",width:"640px",visible:e.dialogVisible,"close-on-click-modal":!1,"show-close":!1},on:{"update:visible":function(t){e.dialogVisible=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[t("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确定")]),t("el-button",{on:{click:e.close}},[e._v("取消")])]},proxy:!0}])},[t("div",[t("el-form",{ref:"form",staticClass:"form",attrs:{model:e.form,"label-width":"100px"}},[t("el-form-item",{key:"dataSource",attrs:{label:"数据源",prop:"dataSource",rules:{required:!0,message:"请选择数据源",trigger:"change"}}},[t("div",{staticStyle:{display:"flex"}},[t("el-select",{staticStyle:{flex:"1"},attrs:{filterable:"",placeholder:"请选择数据源"},on:{change:function(t){return e.getDataBase("",t)}},model:{value:e.form.dataSource,callback:function(t){e.$set(e.form,"dataSource",t)},expression:"form.dataSource"}},e._l(e.dataSourceList,(function(e,i){return t("el-option",{key:i,attrs:{label:e.name,value:e.id}})})),1),t("el-tooltip",{staticClass:"item",staticStyle:{"margin-left":"10px","line-height":"32px"},attrs:{effect:"dark",content:"支持的数据源类型：默认hive、Mysql、Oracle、SQLserver、Postgresql、Hive、默认impala、默认kafka、其他数据源",placement:"top-start"}},[t("i",{staticClass:"icon icon-ic_remind"})])],1)]),t("el-form-item",{key:"database",attrs:{label:"数据库",prop:"database",rules:{required:!0,message:"请选择数据库",trigger:"change"}}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"请选择数据库"},on:{change:function(t){return e.getTable("")}},model:{value:e.form.database,callback:function(t){e.$set(e.form,"database",t)},expression:"form.database"}},e._l(e.databaseList,(function(e,i){return t("el-option",{key:i,attrs:{label:e,value:e}})})),1)],1),t("el-form-item",{key:"table",attrs:{label:"表",prop:"table",rules:{required:!0,message:"请选择表",trigger:"change"}}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"","filter-method":e.filterData,placeholder:"请选择表",loading:e.tableLoading},on:{"visible-change":e.isSelectLazy},model:{value:e.form.table,callback:function(t){e.$set(e.form,"table",t)},expression:"form.table"}},e._l(e.dropOptions,(function(e){return t("el-option",{key:e.uuid,attrs:{label:e.tableName,value:e.id}})})),1)],1)],1)],1)])],1)}),[],!1,null,null,null));t.default=g.exports},cd1c:function(e,t,i){var r=i("e853");e.exports=function(e,t){return new(r(e))(t)}},d60a:function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},e297:function(e,t,i){var r=i("5bea");r.__esModule&&(r=r.default),"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);(0,i("499e").default)("637d8ab6",r,!0,{sourceMap:!1,shadowMode:!1})},e853:function(e,t,i){var r=i("d3f4"),l=i("1169"),a=i("2b4c")("species");e.exports=function(e){var t;return l(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!l(t.prototype)||(t=void 0),r(t)&&null===(t=t[a])&&(t=void 0)),void 0===t?Array:t}}}]);