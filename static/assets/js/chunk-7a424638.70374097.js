(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7a424638"],{"07a2":function(t,e,a){(t.exports=a("2350")(!1)).push([t.i,".primary-color[data-v-137d75b6]{color:#1740dc}.success-color[data-v-137d75b6]{color:#52c41a}.warning-color[data-v-137d75b6]{color:#faad14}.error-color[data-v-137d75b6]{color:#f5222d}.info-color[data-v-137d75b6]{color:#909399}.border-color[data-v-137d75b6]{border:1px solid #e5e6e9}.content-header[data-v-137d75b6]{font-size:16px;font-weight:500;line-height:24px;border-bottom:1px solid #e5e6e9;padding:12px 20px;color:#040c2c}",""])},"1c8f":function(t,e,a){var i=a("07a2");i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("499e").default)("a2330a22",i,!0,{sourceMap:!1,shadowMode:!1})},3190:function(t,e,a){"use strict";a.r(e);a("7f7f"),a("6762"),a("2fdb");var i={data:function(){var t=function(t){return function(e,a,i){return a&&a.trim()?a.includes(" ")||a.includes("\t")?i(new Error("".concat(t,"不允许带有空格"))):void i():i(new Error("请输入".concat(t)))}};return{pickerOptions:{disabledDate:function(t){return t.getTime()<Date.now()-864e5}},loading:!1,dialogVisible:!1,tenantTypeList:[],queueListList:[],tenantUsersList:[],tenantReceiversList:[],industryList:[],ruleForm:{id:null,company:"",industry:"",name:"",userNum:"",tenantType:"",tenantAdminIdList:"",queueList:[],validity_time:"",receiverList:[],state:!0},rules:{company:[{required:!0,validator:t("公司名称"),trigger:"blur"},{min:2,max:20,message:"长度在2-20字符",trigger:"blur"}],industry:[{required:!0,message:"请选择行业",trigger:"change"}],name:[{required:!0,validator:t("租户名称"),trigger:"blur"},{min:2,max:20,message:"长度在2-20字符",trigger:"blur"}],tenantType:[{required:!0,message:"请选择租户类型",trigger:"change"}],queueList:[{required:!0,message:"请选择调度队列",trigger:"change"}],validity_time:[{required:!0,message:"请选择有效期",trigger:"change"}],receiverList:[{required:!0,message:"请选择过期提醒收件人",trigger:"change"}],tenantAdminIdList:[{required:!0,message:"请选择租户管理员",trigger:"change"}],userNum:[{required:!0,validator:function(t,e,a){return e?e<1||e>99999999?a(new Error("请输入1～99999999之间的数字")):void a():a(new Error("请输入用户数量限制"))},trigger:"blur"}]}}},mounted:function(){},methods:{init:function(t){this.dialogVisible=!0,this.getTenantType(),this.getTenantQueue(),this.getTenantUsers(),this.getTenantReceivers(),this.getTenantIndustrys(),this.ruleForm.id=t||null,t&&this.getTenantList(t)},sure:function(){var t=this;this.$refs.ruleForm.validate((function(e){if(e){var a=t.ruleForm,i=a.id,n=a.company,r=a.industry,s=a.name,o=a.tenantType,l=a.tenantAdminIdList,u=a.queueList,c=a.validity_time,d=a.receiverList,m=a.state,p=a.userNum,g={id:i,company:n,industry:r,name:s,tenantType:o,tenantAdminIdList:l,queueList:u,validityStart:c[0],validityEnd:c[1],receiverList:d,state:m?1:0,userNum:p};i?t.eidtSure(g):t.addSure(g)}}))},addSure:function(t){var e=this;this.$API.post(this.$URL.getTenantAdd,t,(function(t){0===t.code?(e.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){}}),e.$emit("refreshDataList"),e.dialogVisible=!1):e.$message.error(t.msg)}))},eidtSure:function(t){var e=this;this.$API.post(this.$URL.getTenantUpdate,t,(function(t){0===t.code?(e.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){}}),e.$emit("refreshDataList"),e.dialogVisible=!1):e.$message.error(t.msg)}))},getTenantList:function(t){var e=this;this.loading=!0;var a={current:1,size:99999,id:t};this.$API.post(this.$URL.getTenantList,a,(function(t){if(0==t.code){var a=t.page.records[0];e.ruleForm.company=a.company,e.ruleForm.industry=a.industry,e.ruleForm.name=a.name,e.ruleForm.userNum=a.userNum,e.ruleForm.tenantType=a.tenantType,e.ruleForm.tenantAdminIdList=a.tenantAdminList.map((function(t){return t.userId})),a.queueList.map((function(t){e.ruleForm.queueList.push(t.queueId)})),e.ruleForm.validity_time=[a.validityStart,a.validityEnd],a.receiverList.map((function(t){e.ruleForm.receiverList.push(t.userId)})),e.ruleForm.state=1==a.state,e.loading=!1}else e.$message.error(t.msg),e.loading=!1}))},getTenantType:function(){var t=this;this.$API.get(this.$URL.getTenantType,{},(function(e){0==e.code?t.tenantTypeList=e.data:t.$message.error(e.msg)}))},getTenantQueue:function(){var t=this;this.$API.get(this.$URL.getTenantQueue,{},(function(e){0==e.code?t.queueListList=e.data:t.$message.error(e.msg)}))},getTenantUsers:function(){var t=this;this.$API.get(this.$URL.getTenantUsers,{},(function(e){0==e.code?t.tenantUsersList=e.data:t.$message.error(e.msg)}))},getTenantReceivers:function(){var t=this;this.$API.get(this.$URL.getTenantReceivers,{},(function(e){0==e.code?t.tenantReceiversList=e.data:t.$message.error(e.msg)}))},getTenantIndustrys:function(){var t=this;this.$API.get(this.$URL.getTenantIndustrys,{},(function(e){0==e.code?t.industryList=e.data:t.$message.error(e.msg)}))},diaClose:function(){this.$nextTick((function(){this.$refs.ruleForm.clearValidate()})),this.ruleForm={id:0,company:"",industry:"",name:"",userNum:"",tenantType:"",tenantAdminIdList:"",queueList:[],validity_time:"",receiverList:[],state:!0}}}},n=a("2877"),r={components:{addOrEdeitTenantManage:Object(n.a)(i,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"addOrEdeitTenantManage"},[e("el-dialog",{attrs:{title:t.ruleForm.id?"编辑租户":"添加租户",visible:t.dialogVisible,customClass:"customWidth",width:"60% !important"},on:{close:t.diaClose,"update:visible":function(e){t.dialogVisible=e}}},[e("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"110px","label-position":"left"}},[e("el-form-item",{staticClass:"textarea",attrs:{label:"公司名称",prop:"company"}},[e("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入2-20字符，支持中英文，数字或符号（除空格）"},model:{value:t.ruleForm.company,callback:function(e){t.$set(t.ruleForm,"company",e)},expression:"ruleForm.company"}})],1),e("el-form-item",{attrs:{label:"行业",prop:"industry"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:t.ruleForm.industry,callback:function(e){t.$set(t.ruleForm,"industry",e)},expression:"ruleForm.industry"}},t._l(t.industryList,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),e("el-form-item",{staticClass:"textarea",attrs:{label:"租户名称",prop:"name"}},[e("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入2-20字符，支持中英文，数字或符号（除空格）"},model:{value:t.ruleForm.name,callback:function(e){t.$set(t.ruleForm,"name",e)},expression:"ruleForm.name"}})],1),e("el-form-item",{attrs:{label:"租户类型",prop:"tenantType"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:t.ruleForm.tenantType,callback:function(e){t.$set(t.ruleForm,"tenantType",e)},expression:"ruleForm.tenantType"}},t._l(t.tenantTypeList,(function(t){return e("el-option",{key:t.id,attrs:{label:t.tenantType,value:t.tenantType}})})),1)],1),e("el-form-item",{attrs:{label:"租户管理员",prop:"tenantAdminIdList"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",multiple:"",placeholder:"请选择"},model:{value:t.ruleForm.tenantAdminIdList,callback:function(e){t.$set(t.ruleForm,"tenantAdminIdList",e)},expression:"ruleForm.tenantAdminIdList"}},t._l(t.tenantUsersList,(function(t){return e("el-option",{key:t.userId,attrs:{label:t.userName,value:t.userId}})})),1)],1),e("el-form-item",{attrs:{label:"有效期",prop:"validity_time"}},[e("el-date-picker",{staticStyle:{width:"100%"},attrs:{"value-format":"yyyy-MM-dd",type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",placeholder:"选择有效期","picker-options":t.pickerOptions},model:{value:t.ruleForm.validity_time,callback:function(e){t.$set(t.ruleForm,"validity_time",e)},expression:"ruleForm.validity_time"}})],1),e("el-form-item",{staticClass:"textarea",attrs:{label:"用户数量限制",prop:"userNum"}},[e("el-input",{staticStyle:{width:"100%"},attrs:{oninput:"value=value.replace(/[^\\d]/g,'')",placeholder:"请输入1～99999999之间的数字"},model:{value:t.ruleForm.userNum,callback:function(e){t.$set(t.ruleForm,"userNum",e)},expression:"ruleForm.userNum"}})],1),e("el-form-item",{attrs:{label:"调度队列",prop:"queueList"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",multiple:"",placeholder:"请选择"},model:{value:t.ruleForm.queueList,callback:function(e){t.$set(t.ruleForm,"queueList",e)},expression:"ruleForm.queueList"}},t._l(t.queueListList,(function(t){return e("el-option",{key:t.queueId,attrs:{label:t.queueName,value:t.queueId}})})),1)],1),e("el-form-item",{staticClass:"textarea",attrs:{label:"过期提醒收件人",prop:"receiverList"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",multiple:"",placeholder:"请选择"},model:{value:t.ruleForm.receiverList,callback:function(e){t.$set(t.ruleForm,"receiverList",e)},expression:"ruleForm.receiverList"}},t._l(t.tenantReceiversList,(function(t){return e("el-option",{key:t.userId,attrs:{label:t.userName,value:t.userId}})})),1)],1),e("el-form-item",{attrs:{label:"是否启用"}},[e("el-switch",{model:{value:t.ruleForm.state,callback:function(e){t.$set(t.ruleForm,"state",e)},expression:"ruleForm.state"}})],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取消")]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.sure()}}},[t._v("保存")])],1)],1)],1)}),[],!1,null,null,null).exports},data:function(){return{loading:!1,formList:{name:"",company:""},dataList:[],pageOptions:{page:1,limit:10,total:0}}},mounted:function(){this.getTenantList()},methods:{toPayForConfiguration:function(t){this.$router.push({path:"payForConfiguration",query:{tenantId:t}})},getTenantList:function(){var t=this;this.loading=!0;var e=this.formList,a=e.name,i=e.company,n=this.pageOptions,r={current:n.page,size:n.limit,name:a,company:i};this.$API.post(this.$URL.getTenantList,r,(function(e){0==e.code?(t.loading=!1,t.dataList=e.page.records,t.pageOptions.total=e.page.total):(t.$message.error(e.msg),t.loading=!1,t.dataList=[],t.pageOptions.total=0)}))},getTenantState:function(t,e){var a=this,i={id:t,state:e};this.$API.post(this.$URL.getTenantState,i,(function(t){0==t.code?(a.$message({message:"操作成功！",type:"success"}),a.getTenantList()):a.$message.error({message:t.msg})}))},delete_dict:function(t){var e=this;this.$confirm("确定进行删除操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$API.post(e.$URL.getTenantDelete,{id:t},(function(t){0==t.code?(e.$message({message:"删除成功！",type:"success"}),e.getTenantList()):e.$message.error({message:t.msg})}))})).catch((function(){}))},reset:function(){this.pageOptions.page=1,this.formList.name="",this.formList.company="",this.getTenantList()},do_search:function(){this.pageOptions.page=1,this.getTenantList()},addtenant:function(t){var e=this;this.$nextTick((function(){return[e.$refs.addOrEdeitTenantManage.init(t)]}))},sizeChangeHandle:function(t){this.pageOptions.limit=t,this.pageOptions.page=1,this.getTenantList()},currentChangeHandle:function(t){this.pageOptions.page=t,this.getTenantList()}}},s=(a("7f7a3"),Object(n.a)(r,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"tenantManage"},[e("div",{staticClass:"content-header"},[t._v("\n    租户管理\n  ")]),e("div",{staticStyle:{padding:"20px"}},[e("el-form",{staticClass:"form",attrs:{inline:!0}},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addtenant()}}},[t._v("添加租户")]),e("el-form-item",{staticStyle:{float:"right","margin-right":"0"}},[e("el-button",{on:{click:function(e){return t.reset()}}},[t._v("重置")])],1),e("el-form-item",{staticStyle:{float:"right"}},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.do_search()}}},[t._v("查询")])],1),e("el-form-item",{staticStyle:{float:"right"},attrs:{label:""}},[e("el-input",{attrs:{placeholder:"请输入租户名称"},model:{value:t.formList.name,callback:function(e){t.$set(t.formList,"name",e)},expression:"formList.name"}})],1),e("el-form-item",{staticStyle:{float:"right"},attrs:{label:""}},[e("el-input",{attrs:{placeholder:"请输入公司名称"},model:{value:t.formList.company,callback:function(e){t.$set(t.formList,"company",e)},expression:"formList.company"}})],1)],1),[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.dataList}},[e("el-table-column",{attrs:{prop:"id",label:"租户ID",width:"80"}}),e("el-table-column",{attrs:{prop:"name",label:"租户名称","show-overflow-tooltip":!0,width:"180"}}),e("el-table-column",{attrs:{prop:"company",label:"公司名称","show-overflow-tooltip":!0,width:"180"}}),e("el-table-column",{attrs:{prop:"industry",label:"行业",width:"180"}}),e("el-table-column",{attrs:{prop:"tenantType","show-overflow-tooltip":!0,label:"租户类型",width:"180"}}),e("el-table-column",{attrs:{prop:"createTime","show-overflow-tooltip":!0,label:"创建时间",width:"180"}}),e("el-table-column",{attrs:{prop:"createUserName","show-overflow-tooltip":!0,label:"租户管理员姓名",width:"180"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.tenantAdminList&&a.row.tenantAdminList[0]&&a.row.tenantAdminList[0].userName))])]}}])}),e("el-table-column",{attrs:{prop:"email","show-overflow-tooltip":!0,label:"邮箱",width:"180"}}),e("el-table-column",{attrs:{prop:"phone","show-overflow-tooltip":!0,label:"管理员手机号码",width:"180"}}),e("el-table-column",{attrs:{"header-align":"right",fixed:"right",align:"right",label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(a){return[0==a.row.state?e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.getTenantState(a.row.id,1)}}},[t._v("启用")]):t._e(),1==a.row.state?e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.getTenantState(a.row.id,0)}}},[t._v("禁用")]):t._e(),e("el-dropdown",{staticStyle:{"margin-left":"20px",cursor:"pointer"},attrs:{placement:"bottom-start"}},[e("span",{staticClass:"el-dropdown-link"},[t._v("更多"),e("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-dropdown-item",[e("el-button",{staticStyle:{width:"100%","text-align":"left"},attrs:{type:"text"},on:{click:function(e){return t.addtenant(a.row.id)}}},[t._v("编辑")])],1),e("el-dropdown-item",[e("el-button",{staticStyle:{width:"100%","text-align":"left"},attrs:{type:"text"},on:{click:function(e){return t.toPayForConfiguration(a.row.id)}}},[t._v("付费配置")])],1),e("el-dropdown-item",[e("el-button",{staticClass:"delete",staticStyle:{width:"100%","text-align":"left"},attrs:{type:"text"},on:{click:function(e){return t.delete_dict(a.row.id)}}},[t._v("删除")])],1)],1)],1)]}}])})],1),e("el-pagination",{attrs:{"current-page":t.pageOptions.page,"page-sizes":[10,20,50,100],"page-size":t.pageOptions.limit,total:t.pageOptions.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":t.sizeChangeHandle,"current-change":t.currentChangeHandle}})],e("addOrEdeitTenantManage",{ref:"addOrEdeitTenantManage",on:{refreshDataList:t.do_search}})],2)])}),[],!1,null,"137d75b6",null));e.default=s.exports},"7f7a3":function(t,e,a){"use strict";a("1c8f")}}]);