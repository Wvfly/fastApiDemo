(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-db8fd4b0"],{"0892":function(e,t,r){"use strict";r("b694")},"0a49":function(e,t,r){var a=r("9b43"),i=r("626a"),o=r("4bf8"),s=r("9def"),n=r("cd1c");e.exports=function(e,t){var r=1==e,l=2==e,c=3==e,d=4==e,u=6==e,m=5==e||u,p=t||n;return function(t,n,f){for(var h,b,g=o(t),v=i(g),y=a(n,f,3),x=s(v.length),k=0,_=r?p(t,x):l?p(t,0):void 0;x>k;k++)if((m||k in v)&&(b=y(h=v[k],k,g),e))if(r)_[k]=b;else if(b)switch(e){case 3:return!0;case 5:return h;case 6:return k;case 2:_.push(h)}else if(d)return!1;return u?-1:c||d?d:_}}},"18ad":function(e,t,r){(e.exports=r("2350")(!1)).push([e.i,".primary-color{color:#1740dc}.success-color{color:#52c41a}.warning-color{color:#faad14}.error-color{color:#f5222d}.info-color{color:#909399}.border-color{border:1px solid #e5e6e9}.realtimeTaskAlarms .el-table .el-button--text.is-disabled,.realtimeTaskAlarms .el-table .el-button--text.is-disabled:hover{color:rgba(4,12,44,.25)}.realtimeTaskAlarms .el-table .el-button--text{color:#040c2c}.realtimeTaskAlarms .el-table .el-button--text:hover{color:#1740dc}.realtimeTaskAlarms .el-switch .el-switch__label{position:absolute;z-index:1;color:#fff!important;display:none}.realtimeTaskAlarms .el-switch .is-active{display:block}.realtimeTaskAlarms .el-switch .el-switch__label--left span{margin-left:20px}.realtimeTaskAlarms .el-switch .el-switch__label--right span{margin-left:0}",""])},"1ea5":function(e,t,r){"use strict";r("bc2a")},"20d6":function(e,t,r){"use strict";var a=r("5ca1"),i=r("0a49")(6),o="findIndex",s=!0;o in[]&&Array(1)[o]((function(){s=!1})),a(a.P+a.F*s,"Array",{findIndex:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),r("9c6c")(o)},3835:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var a=r("06c5");function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,i,o=[],s=!0,n=!1;try{for(r=r.call(e);!(s=(a=r.next()).done)&&(o.push(a.value),!t||o.length!==t);s=!0);}catch(e){n=!0,i=e}finally{try{s||null==r.return||r.return()}finally{if(n)throw i}}return o}}(e,t)||Object(a.a)(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},3903:function(e,t,r){"use strict";r("5a16")},5089:function(e,t,r){var a=r("d9ed");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,r("499e").default)("1f356424",a,!0,{sourceMap:!1,shadowMode:!1})},"5a16":function(e,t,r){var a=r("c657");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,r("499e").default)("4e24c354",a,!0,{sourceMap:!1,shadowMode:!1})},"79b2":function(e,t,r){"use strict";r("386d"),r("7f7f"),r("ac6a"),r("20d6"),r("96cf");var a,i=r("1da1"),o=(r("6762"),r("2fdb"),r("c5f6"),r("ca00")),s={username:"ChooseCon",props:{selectData02:{type:Array,default:function(){return[]}},confirmClose:{type:Boolean,default:!0},disableUids:{type:Array,default:function(){return[]}},receivedType:{type:Number,default:function(){return 1}},isOwer:{type:Boolean,default:function(){return!0}},isEdit:{type:Boolean,default:function(){return!1}}},data:function(){return{loading:!1,searchDept:[],filterText:"",procId:"",orgOptions:[],emptyText:"请选择",chooseList:[],removeList:[],userId:"userId",label:"username",isActive:!1,username:"",tableData:[],currentPage:1,pageSize:20,total:0,options:[{id:"",name:"全部"}],chooseNode:[{}],departmentList:[]}},mounted:function(){this.loadTreeData()},watch:{selectData02:{handler:function(e){this.chooseList=[],e&&e.length&&(this.chooseList=Object(o.b)(e)||[])},immediate:!0},receivedType:{handler:function(e,t){},immediate:!0}},methods:{checkboxSelect:function(e,t){return!this.disableUids.includes(e.id)},search:function(){this.currentPage=1,this.loadData()},reset:function(){this.currentPage=1,this.searchDept="",this.procId="",this.username="",this.loadData()},isLeafFun:function(e){return e.leaf},nodeClick:function(e){this.chooseNode=[e],this.searchDept=e.id,this.$refs.selectRef.blur()},loadTreeData:function(e,t,r){var a=this;this.$API.get(this.$URL.getDepartmentListByCondition,{name:e},(function(e){0==e.code?e.data&&e.data.length&&(a.departmentList=e.data):a.$message.error(e.msg)}))},confirm:function(){var e=this;return new Promise((function(t,r){e.$confirm("此操作将删除该选项, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(r){t(r),e.$message({type:"success",message:"删除成功!"})})).catch((function(){r(),e.$message({type:"info",message:"已取消删除"})}))}))},handleTagClose:(a=Object(i.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.confirmClose){e.next=7;break}return e.next=3,this.confirm();case 3:e.sent&&this.removeData(t),e.next=8;break;case 7:this.removeData(t);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)}),removeData:function(e){var t=this.chooseList.findIndex((function(t){return t.userId==e.userId}));this.chooseList.splice(t,1),this.$emit("confirm02",this.chooseList)},choose:function(){this.isEdit||(this.chooseList=[]),this.isOwer&&(this.isActive=!0,this.searchDept="",this.username="",this.procId="",this.chooseList=this.selectData02,this.loadData(),2==this.receivedType&&this.getFactoryList())},getFactoryList:function(){var e=this;this.$API.get(this.$URL.getProcInfoList,{page:1,limit:999},(function(t){if(0==t.code){if(e.options=[{id:"",name:"全部"}],t.page.list.length>0)for(var r=0;r<t.page.list.length;r++)e.options.push({id:t.page.list[r].id,name:t.page.list[r].name})}else e.$message.error(t.msg)}))},loadData:function(){1==this.receivedType?this.loadData01():2==this.receivedType&&this.loadData02()},loadData01:function(){var e,t=this;this.loading=!0,this.searchDept.length&&(e=this.searchDept.pop());var r={page:this.currentPage,limit:this.pageSize,username:this.username,departmentId:e||Number(-3)};this.$API.post(this.$URL.getUserListByTask,r,(function(e){if(0==e.code){t.total=e.page.totalCount,t.tableData=e.page.list;var r=t.chooseList.map((function(e){return e.userId}));t.$nextTick((function(){t.tableData.forEach((function(e){if(r.includes(e.userId)&&t.$refs.tableRef.toggleRowSelection(e,!0),t.removeList.includes(e.userId)){t.$refs.tableRef.toggleRowSelection(e,!1);var a=t.removeList.findIndex((function(t){return t.userId==e.userId}));t.removeList.splice(a,1)}}))})),t.loading=!1}else t.$message.error(e.msg),t.loading=!1}))},loadData02:function(){var e=this;this.loading=!0;var t={page:this.currentPage,limit:this.pageSize,departmentId:this.searchDept?this.searchDept:0,procId:this.procId,username:this.username};this.$API.get(this.$URL.getUserUserWithDeptPage,t,(function(t){if(0==t.code){e.total=t.page.totalCount,e.tableData=t.page.list;var r=e.chooseList.map((function(e){return e.userId}));e.$nextTick((function(){e.tableData.forEach((function(t){if(r.includes(t.userId)&&e.$refs.tableRef.toggleRowSelection(t,!0),e.removeList.includes(t.userId)){e.$refs.tableRef.toggleRowSelection(t,!1);var a=e.removeList.findIndex((function(e){return e.userId==t.userId}));e.removeList.splice(a,1)}}))})),e.loading=!1}else e.$message.error(t.msg),e.loading=!1}))},removeChoose:function(e){var t=this.chooseList.findIndex((function(t){return t.userId==e}));this.chooseList.splice(t,1);var r=this.tableData.findIndex((function(t){return t.userId==e}));r>-1?this.$refs.tableRef.toggleRowSelection(this.tableData[r],!1):this.removeList.push(e)},currentPageRemove:function(e){var t=[],r=e.map((function(e){return e.userId}));return this.tableData.forEach((function(e){r.includes(e.userId)||t.push(e.userId)})),t},selectChange:function(e){var t=this,r=this.chooseList.map((function(e){return e.userId}));e.forEach((function(e){r.includes(e.userId)||t.chooseList.push(e)})),this.currentPageRemove(e).forEach((function(e){r.includes(e)&&t.removeChoose(e)}))},handleSizeChange:function(e){this.pageSize=e,this.loadData()},handleCurrentChange:function(e){this.currentPage=e,this.loadData()},confirmChoose:function(){this.isActive=!1,this.$emit("confirm02",this.chooseList),this.$emit("update:selectData02",this.chooseList)}}},n=(r("e677"),r("2877")),l=Object(n.a)(s,(function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"choose-items-con",on:{click:e.choose}},[e.selectData02&&e.selectData02.length?t("div",{staticClass:"tags"},e._l(e.chooseList,(function(r){return t("el-tag",{key:r[e.userId],staticStyle:{"margin-right":"10px"},attrs:{type:"info",closable:e.isOwer,size:"mini"},on:{close:function(t){return e.handleTagClose(r)}}},[e._v("\n        "+e._s(r[e.label]||"".concat(r[e.userId]," (已删除)"))+"\n      ")])})),1):t("div",{staticClass:"tags"},[t("span",{staticClass:"empty"},[e._v(e._s(e.emptyText))])])]),t("el-dialog",{attrs:{title:"选择接收人",visible:e.isActive,modal:!1,"destroy-on-close":!0,"close-on-click-modal":!1,width:"80% !important"},on:{"update:visible":function(t){e.isActive=t}}},[t("el-form",{attrs:{inline:!0}},[1==e.receivedType?t("el-form-item",{attrs:{label:"部门"}},[t("el-cascader",{attrs:{options:e.departmentList,props:{label:"name",value:"id",children:"children",checkStrictly:!0},filterable:"",clearable:""},model:{value:e.searchDept,callback:function(t){e.searchDept=t},expression:"searchDept"}})],1):e._e(),2==e.receivedType?t("el-form-item",{attrs:{label:"项目"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.procId,callback:function(t){e.procId=t},expression:"procId"}},e._l(e.options,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),t("el-form-item",{attrs:{label:"用户名"}},[t("el-input",{attrs:{clearable:"",placeholder:"输入用户名"},model:{value:e.username,callback:function(t){e.username="string"==typeof t?t.trim():t},expression:"username"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary",clearable:""},on:{click:e.search}},[e._v("\n          搜索\n        ")])],1),t("el-form-item",[t("el-button",{on:{click:e.reset}},[e._v("\n          重置\n        ")])],1)],1),t("div",{staticClass:"table-wrapper"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"tableRef",staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-class-name":"cus-table tabHeader",height:"340"},on:{select:e.selectChange,"select-all":e.selectChange}},[t("el-table-column",{attrs:{type:"selection",selectable:e.checkboxSelect,width:"55"}}),t("el-table-column",{attrs:{prop:"userId",label:"用户编号"}}),t("el-table-column",{attrs:{prop:"username",label:"用户名"}})],1)],1),t("div",{staticClass:"page",staticStyle:{"padding-bottom":"0"}},[t("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,20,30,50],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("div",{staticClass:"dialog-footer",staticStyle:{display:"flex","align-items":"center"},attrs:{slot:"footer"},slot:"footer"},[t("div",{staticStyle:{width:"70px"}},[t("span",[e._v("已选择("+e._s(e.chooseList.length)+")")])]),t("div",{staticClass:"modal-footer-scroll"},e._l(e.chooseList,(function(r){return t("el-tag",{key:r.userId,staticStyle:{"margin-right":"10px"},attrs:{closable:"",size:"mini"},on:{close:function(t){return e.removeChoose(r.userId)}}},[e._v("\n          "+e._s(r.username||"".concat(r.userId," (已删除)"))+"\n        ")])})),1),t("el-button",{attrs:{type:"primary"},on:{click:e.confirmChoose}},[e._v("\n        确 定\n      ")])],1)],1)],1)}),[],!1,null,"c117d4ea",null);t.a=l.exports},"86fe":function(e,t,r){(e.exports=r("2350")(!1)).push([e.i,'.primary-color{color:#1740dc}.success-color{color:#52c41a}.warning-color{color:#faad14}.error-color{color:#f5222d}.info-color{color:#909399}.border-color{border:1px solid #e5e6e9}.form-title{font-size:14px;font-weight:500;margin-bottom:20px}.form-title:before{content:"";height:14px;width:3px;background-color:#00f;display:inline-block;vertical-align:-3px;margin-right:10px;padding-top:2px}.table-content .right .tabs-tab{margin-top:-13px}.table-content .right .table-tab .el-checkbox__input{white-space:nowrap;cursor:pointer;outline:none;display:inline-block;line-height:1;position:relative;vertical-align:middle;top:-8px}.addOrEdeitTaskAlarms{text-align:left}.addOrEdeitTaskAlarms .el-table__body .el-form-item__content{margin-left:0!important}.addOrEdeitTaskAlarms .tit{font-size:16px;line-height:40px;color:#303133}.addOrEdeitTaskAlarms .table-content{display:-webkit-box;display:-ms-flexbox;display:flex}.addOrEdeitTaskAlarms .table-content .sub-title{text-align:left;width:120px;font-size:12px;color:#606266}.addOrEdeitTaskAlarms .table-content .sub-title .icon{margin-left:4px;font-size:12px;color:#f5222d}.addOrEdeitTaskAlarms .table-content .right{-webkit-box-flex:1;-ms-flex:1;flex:1}.addOrEdeitTaskAlarms .table-content .right .params_table .cell{line-height:normal!important}.addOrEdeitTaskAlarms .table-content .right .params_table .cell .el-form-item__content{margin-left:0!important}.addOrEdeitTaskAlarms .table-content .right .params_table .delete-btn{color:#040c2c}.addOrEdeitTaskAlarms .table-content .right .params_table .delete-btn:hover{color:#1740dc}.addOrEdeitTaskAlarms .table-content .right .addNew{width:100%;height:32px;line-height:32px;text-align:center;margin-bottom:5px;border:1px dashed #d9d9d9;cursor:pointer;color:#040c2c}.addOrEdeitTaskAlarms .table-content .right .addNew:hover{color:#1740dc}.addOrEdeitTaskAlarms .el-range-editor.el-input__inner{width:100%}.addOrEdeitTaskAlarms .cur_el-dialog__wrapper .el-dialog__wrapper{width:100%;height:100%;background-color:rgba(0,0,0,.5)}',""])},"966c":function(e,t,r){(e.exports=r("2350")(!1)).push([e.i,".primary-color[data-v-465795d7]{color:#1740dc}.success-color[data-v-465795d7]{color:#52c41a}.warning-color[data-v-465795d7]{color:#faad14}.error-color[data-v-465795d7]{color:#f5222d}.info-color[data-v-465795d7]{color:#909399}.border-color[data-v-465795d7]{border:1px solid #e5e6e9}.tit[data-v-465795d7]{font-size:16px;line-height:40px;color:#303133}.btn[data-v-465795d7]{text-align:right}",""])},b39a:function(e,t,r){var a=r("d3f4");e.exports=function(e,t){if(!a(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},b694:function(e,t,r){var a=r("18ad");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,r("499e").default)("93da2540",a,!0,{sourceMap:!1,shadowMode:!1})},bc2a:function(e,t,r){var a=r("966c");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,r("499e").default)("56f78374",a,!0,{sourceMap:!1,shadowMode:!1})},c26b:function(e,t,r){"use strict";var a=r("86cc").f,i=r("2aeb"),o=r("dcbc"),s=r("9b43"),n=r("f605"),l=r("4a59"),c=r("01f9"),d=r("d53b"),u=r("7a56"),m=r("9e1e"),p=r("67ab").fastKey,f=r("b39a"),h=m?"_s":"size",b=function(e,t){var r,a=p(t);if("F"!==a)return e._i[a];for(r=e._f;r;r=r.n)if(r.k==t)return r};e.exports={getConstructor:function(e,t,r,c){var d=e((function(e,a){n(e,d,t,"_i"),e._t=t,e._i=i(null),e._f=void 0,e._l=void 0,e[h]=0,null!=a&&l(a,r,e[c],e)}));return o(d.prototype,{clear:function(){for(var e=f(this,t),r=e._i,a=e._f;a;a=a.n)a.r=!0,a.p&&(a.p=a.p.n=void 0),delete r[a.i];e._f=e._l=void 0,e[h]=0},delete:function(e){var r=f(this,t),a=b(r,e);if(a){var i=a.n,o=a.p;delete r._i[a.i],a.r=!0,o&&(o.n=i),i&&(i.p=o),r._f==a&&(r._f=i),r._l==a&&(r._l=o),r[h]--}return!!a},forEach:function(e){f(this,t);for(var r,a=s(e,arguments.length>1?arguments[1]:void 0,3);r=r?r.n:this._f;)for(a(r.v,r.k,this);r&&r.r;)r=r.p},has:function(e){return!!b(f(this,t),e)}}),m&&a(d.prototype,"size",{get:function(){return f(this,t)[h]}}),d},def:function(e,t,r){var a,i,o=b(e,t);return o?o.v=r:(e._l=o={i:i=p(t,!0),k:t,v:r,p:a=e._l,n:void 0,r:!1},e._f||(e._f=o),a&&(a.n=o),e[h]++,"F"!==i&&(e._i[i]=o)),e},getEntry:b,setStrong:function(e,t,r){c(e,t,(function(e,r){this._t=f(e,t),this._k=r,this._l=void 0}),(function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?d(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,d(1))}),r?"entries":"values",!r,!0),u(t)}}},c657:function(e,t,r){(e.exports=r("2350")(!1)).push([e.i,".primary-color[data-v-c369403c]{color:#1740dc}.success-color[data-v-c369403c]{color:#52c41a}.warning-color[data-v-c369403c]{color:#faad14}.error-color[data-v-c369403c]{color:#f5222d}.info-color[data-v-c369403c]{color:#909399}.border-color[data-v-c369403c]{border:1px solid #e5e6e9}.realtimeTaskAlarms[data-v-c369403c]{margin:15px 20px}.realtimeTaskAlarms .search-header[data-v-c369403c]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}",""])},cb95:function(e,t,r){"use strict";r("d16b")},cd1c:function(e,t,r){var a=r("e853");e.exports=function(e,t){return new(a(e))(t)}},d16b:function(e,t,r){var a=r("86fe");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,r("499e").default)("51059308",a,!0,{sourceMap:!1,shadowMode:!1})},d9ed:function(e,t,r){(e.exports=r("2350")(!1)).push([e.i,".primary-color[data-v-c117d4ea]{color:#1740dc}.success-color[data-v-c117d4ea]{color:#52c41a}.warning-color[data-v-c117d4ea]{color:#faad14}.error-color[data-v-c117d4ea]{color:#f5222d}.info-color[data-v-c117d4ea]{color:#909399}.border-color[data-v-c117d4ea]{border:1px solid #e5e6e9}.choose-items-con[data-v-c117d4ea]{border:1px solid #dededf;border-radius:4px;-webkit-box-sizing:border-box;box-sizing:border-box;color:#606266;-webkit-transition:border-color .2s;transition:border-color .2s;display:-webkit-box;display:-ms-flexbox;display:flex;width:100%;cursor:pointer}.choose-items-con[data-v-c117d4ea]:hover{border-color:#c0c4cc}.choose-items-con .tags[data-v-c117d4ea]{width:calc(100% - 25px);max-height:160px;min-height:36px;overflow-y:auto;padding-left:15px}.choose-items-con .empty[data-v-c117d4ea]{opacity:1;color:#c0c4cc}.choose-items-con .icon[data-v-c117d4ea]{width:25px;cursor:pointer;-webkit-transition:-webkit-transform .3s;transition:-webkit-transform .3s;transition:transform .3s;transition:transform .3s,-webkit-transform .3s;text-align:center}.choose-items-con .icon.active[data-v-c117d4ea]{-webkit-transform:rotate(180deg);transform:rotate(180deg)}.modal-footer-scroll[data-v-c117d4ea]{width:calc(100% - 182px);text-align:left;overflow-x:auto;overflow-y:hidden;white-space:nowrap;margin:0 16px;padding:6px 0}.select-down .el-select-dropdown__item[data-v-c117d4ea]{padding:0}",""])},e09d:function(e,t,r){"use strict";r.r(t);r("386d"),r("7f7f"),r("8e6e"),r("456d");var a=r("ade3"),i=r("3835"),o=(r("96cf"),r("1da1")),s=(r("ac6a"),r("5df3"),r("f400"),r("a481"),r("fedb")),n=r("83fe"),l=function(e){return n.a.post(s.a.bdpRealTaskAlarm,e)},c=function(e){return n.a.get(s.a.listByProcId,{params:e})},d=function(e){return n.a.get(s.a.realTaskInfo.replace(":id",e))},u=function(e){var t=e.id,r=e.stateFlage;return n.a.get(s.a.startUsing.replace(":id/:state","".concat(t,"/").concat(r)))},m=(r("20d6"),r("28a5"),r("2909")),p=(r("3b2b"),r("79b2"));function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){Object(a.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var b,g,v,y=function(e,t,r){if(!t)return r(new Error("不能为空"));if(!/^1[3|4|5|7|8][0-9]\d{8}$/.test(t)&&!/^([0-9]{3,4}-)?[0-9]{7,8}$/.test(t))return r(new Error("请输入正确的手机号或座机号"));r()},x=function(e,t,r){if(!t)return r(new Error("不能为空"));if(!/^1[3|4|5|7|8][0-9]\d{8}$/.test(t))return r(new Error("请输入正确的手机号"));r()},k={components:{ChooseCon02:p.a},data:function(){return{activeName:"邮箱",validateTel:y,validatePhone:x,ruleForm:{id:0,name:"",objectProject:[],objectType:"",objectName:[],mineStatus:[],alarmObjects:"",triggerCondition:"",start_end_time:"",alarmModes:[1],receivedType:1,maxAlarmCount:1,minAlarmInterval:10,recipient:[],receivedList:[],jemail:[{notificationMode:"邮箱",alarmMode:1,email:""}],jphone:[{notificationMode:"电话",alarmMode:3,phone:"",cheackState:!1}],jletter:[{notificationMode:"短信",alarmMode:4,shortLetter:"",cheackState:!1}],jTletter:[{notificationMode:"T信",alarmMode:2,tletter:""}]},selectUserList1:[],selectUserList2:[],dialogVisible:!1,addLoading:!1,isOwner:!0,users:[],options_objectType:[{value:1,label:"作业流"},{value:2,label:"作业流依赖"}],refreshKey02:0,jobStreams:[],mineStatusValue:[],treeData02:[],options_alarmModes:[],options_triggerCondition:[],allTaskTypeLists:[],taskMenu:[],allReceivedTypeLists:[],taskMenuList:[],data:[],data02:[],rules:{name:[{required:!0,validator:function(e,t,r){!RegExp("^[-_a-zA-Z0-9一-龥]*$").test(t)||""==t||t.length>20?r(new Error("仅支持中文、英文、数字、下划线组合20位字符")):r()},trigger:"blur"}],dbName:[{required:!0,message:"请选择数据库名",trigger:"change"}],triggerCondition:[{required:!0,message:"请选择触发条件",trigger:"change"}],objectProject:[{required:!0,message:"请选择项目",trigger:"blur"}],objectType:[{required:!0,message:"请选择任务类型",trigger:"change"}],alarmObjects:[{required:!0,message:"请选择任务名称",trigger:"blur"}],alarmModes:[{required:!0,message:"请选择报警方式",trigger:"change"}],receivedType:[{required:!0,message:"请选择接收人类型",trigger:"change"}],receivedList:[{required:!0,message:"请选择接收人",trigger:"change"}]}}},methods:{open:(v=Object(o.a)(regeneratorRuntime.mark((function e(t){var r,a,i,o,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.dialogVisible=!0,e.next=3,n.a.get(s.a.getRealTaskInfo);case 3:r=e.sent.data.data,a=r.allProcInfoLists,i=r.allTaskTypeLists,o=r.allConditionLists,r.allAlarmModeLists,l=r.allReceivedTypeLists,this.options_objectType=a,this.allTaskTypeLists=i,this.options_triggerCondition=o,this.options_alarmModes=[{id:1,name:"邮件"},{id:3,name:"电话"},{id:4,name:"短信"},{id:2,name:"T信"}],this.allReceivedTypeLists=l,t?this.getAlarmInfo(t):(this.ruleForm.jemail=[{notificationMode:"邮箱",alarmMode:1,email:""}],this.ruleForm.jphone=[{notificationMode:"电话",alarmMode:3,phone:"",cheackState:!1}],this.ruleForm.jletter=[{notificationMode:"短信",alarmMode:4,shortLetter:"",cheackState:!1}],this.ruleForm.jTletter=[{notificationMode:"T信",alarmMode:2,tletter:""}]);case 15:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)}),changeRadio:function(e){this.users=[],this.ruleForm.receivedList=[],1==e?this.users=this.selectUserList1:2==e&&(this.users=this.selectUserList2),this.confirmChoose02(this.users)},confirmChoose02:function(e){for(var t=[],r=0;r<e.length;r++)t.push({receivedId:e[r].userId,receivedName:e[r].username});1==this.ruleForm.receivedType?this.users=this.selectUserList1=e:2==this.ruleForm.receivedType&&(this.users=this.selectUserList2=e),this.ruleForm.receivedList=t},close:function(){this.$refs.ruleForm.resetFields(),this.isOwner=!0,this.ruleForm.id=0,this.ruleForm.alarmObjects=[],this.ruleForm.start_end_time="",this.jobStreams=[],this.users=[]},handleClose:function(e){this.$confirm("确认关闭？").then((function(t){e()})).catch((function(e){}))},getAlarmInfo:(g=Object(o.a)(regeneratorRuntime.mark((function e(t){var r,a,i,o,s,n,l,u,m,p,f,b,g,v,y=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.addLoading=!0,e.next=3,d(t);case 3:return r=e.sent.data.data,a=r.name,i=r.procId,o=r.taskType,s=r.cheackObjectLists,n=r.triggerCondition,l=r.alarmModes,u=r.receivedType,m=r.cheackReceivedLists,p=r.noDisturbingStartTime,f=r.noDisturbingEntTime,b={procId:i,taskType:o},e.next=17,c(b);case 17:if(this.taskMenuList=e.sent.data.data,this.ruleForm=h(h({},this.ruleForm),{},{id:t,name:a,objectProject:i,objectType:o,alarmObjects:s.map((function(e){return e.objectId})),triggerCondition:n,alarmModes:l,receivedType:u,jemail:[],jphone:[],jletter:[],jTletter:[],start_end_time:p&&f?[p,f]:""}),4==u&&m.length)m.forEach((function(e){1==e.alarmMode?y.ruleForm.jemail.push({notificationMode:"邮箱",alarmMode:e.alarmMode,email:e.receivedName}):3==e.alarmMode?y.ruleForm.jphone.push({notificationMode:"电话",alarmMode:e.alarmMode,phone:e.receivedName,cheackState:3==e.alarmModeEx}):4==e.alarmMode?y.ruleForm.jletter.push({notificationMode:"短信",alarmMode:e.alarmMode,shortLetter:e.receivedName,cheackState:2==e.alarmModeEx}):y.ruleForm.jTletter.push({notificationMode:"T信",alarmMode:e.alarmMode,tletter:e.receivedName})}));else{if(g=[],m.length>0)for(v=0;v<m.length;v++)g.push({userId:m[v].receivedId,username:m[v].receivedName});1==this.ruleForm.receivedType?this.users=this.selectUserList1=g:2==this.ruleForm.receivedType&&(this.users=this.selectUserList2=g),this.ruleForm.receivedList=m,this.ruleForm.jemail=[{notificationMode:"邮箱",alarmMode:1,email:""}],this.ruleForm.jphone=[{notificationMode:"电话",alarmMode:3,phone:""}],this.ruleForm.jletter=[{notificationMode:"短信",alarmMode:4,shortLetter:""}],this.ruleForm.jTletter=[{notificationMode:"T信",alarmMode:2,tletter:""}]}this.addLoading=!1;case 21:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)}),sure:function(){var e=this;this.$refs.ruleForm.validate(function(){var t=Object(o.a)(regeneratorRuntime.mark((function t(r,a){var i,o,l,c,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r){t.next=16;break}if(4==e.ruleForm.receivedType&&((i=[].concat(Object(m.a)(e.ruleForm.jemail),Object(m.a)(e.ruleForm.jphone),Object(m.a)(e.ruleForm.jletter),Object(m.a)(e.ruleForm.jTletter))).forEach((function(e){1==e.alarmMode?e.receivedName=e.email:3==e.alarmMode?(e.receivedName=e.phone,e.cheackState&&(e.alarmModeEx=3)):4==e.alarmMode?(e.receivedName=e.shortLetter,e.cheackState&&(e.alarmModeEx=2)):e.receivedName=e.tletter})),e.ruleForm.receivedList=i),o={id:e.ruleForm.id?e.ruleForm.id:null,procId:e.ruleForm.objectProject,taskType:e.ruleForm.objectType,alarmObjects:e.ruleForm.alarmObjects,triggerCondition:e.ruleForm.triggerCondition,alarmModes:e.ruleForm.alarmModes,receivedType:e.ruleForm.receivedType,receivedList:e.ruleForm.receivedList,name:e.ruleForm.name,noDisturbingStartTime:e.ruleForm.start_end_time[0],noDisturbingEntTime:e.ruleForm.start_end_time[1]},e.addLoading=!0,!e.ruleForm.id){t.next=12;break}return t.next=7,u=o,n.a.post(s.a.realTaskUpdate,u);case 7:e.$message({message:"操作成功",type:"success",duration:1500}),e.$emit("refreshDataList"),e.dialogVisible=!1,t.next=13;break;case 12:e.$API.post(e.$URL.saveRealTask,o,(function(t){0===t.code?(e.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){}}),e.$emit("refreshDataList"),e.dialogVisible=!1):e.$message.error(t.msg)}));case 13:e.addLoading=!1,t.next=26;break;case 16:t.t0=regeneratorRuntime.keys(a);case 17:if((t.t1=t.t0()).done){t.next=26;break}if(l=t.t1.value,c={jletter:"短信",jphone:"电话",jemail:"邮箱",jTletter:"T信"},d=null==l?void 0:l.split(".")[0],!Object.hasOwnProperty.call(c,d)){t.next=24;break}return e.activeName=c[d],t.abrupt("break",26);case 24:t.next=17;break;case 26:case"end":return t.stop()}var u}),t)})));return function(e,r){return t.apply(this,arguments)}}())},onChange:(b=Object(o.a)(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.ruleForm.objectProject||!this.ruleForm.objectType){e.next=7;break}return t={procId:this.ruleForm.objectProject,taskType:this.ruleForm.objectType},e.next=4,c(t);case 4:r=e.sent,this.taskMenuList=r.data.data,this.ruleForm.alarmObjects=[];case 7:case"end":return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)}),checkListHandle:function(e,t,r){if(!e){var a=this.ruleForm.alarmModes[0],i="邮箱"==this.activeName?1:"T信"==this.activeName?2:"电话"==this.activeName?3:4;switch(r.id==i&&(this.activeName=1==a?"邮箱":2==a?"T信":3==a?"电话":"短信"),t){case 0:this.ruleForm.jemail=[{notificationMode:"邮箱",alarmMode:1}];break;case 1:this.ruleForm.jphone=[{notificationMode:"电话",alarmMode:3}];break;case 2:this.ruleForm.jletter=[{notificationMode:"短信",alarmMode:4}];break;default:this.ruleForm.jTletter=[{notificationMode:"T信",alarmMode:2}]}}},deleteCur:function(e){switch(this.activeName){case"邮箱":if(this.ruleForm.jemail.length<2)return this.$message.error("不能删除所有配置...");this.ruleForm.jemail.splice(e,1);break;case"电话":if(this.ruleForm.jphone.length<2)return this.$message.error("不能删除所有配置...");this.ruleForm.jphone.splice(e,1);break;case"短信":if(this.ruleForm.jletter.length<2)return this.$message.error("不能删除所有配置...");this.ruleForm.jletter.splice(e,1);break;default:if(this.ruleForm.jTletter.length<2)return this.$message.error("不能删除所有配置...");this.ruleForm.jTletter.splice(e,1)}},addNew:function(){switch(this.activeName){case"邮箱":this.ruleForm.jemail.push({notificationMode:"邮箱",alarmMode:1,email:""});break;case"电话":this.ruleForm.jphone.push({notificationMode:"电话",alarmMode:3,phone:""});break;case"短信":this.ruleForm.jletter.push({notificationMode:"短信",alarmMode:4,shortLetter:""});break;case"T信":this.ruleForm.jTletter.push({notificationMode:"T信",alarmMode:2,tletter:""})}}}},_=(r("cb95"),r("2877")),w=Object(_.a)(k,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"addOrEdeitTaskAlarms"},[t("el-dialog",{attrs:{title:e.ruleForm.id?"编辑任务告警":"新建任务告警",visible:e.dialogVisible,customClass:"customWidth",width:"700px!important"},on:{close:e.close,"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.addLoading,expression:"addLoading"}],ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px","label-position":"left"}},[t("div",{staticClass:"form-title"},[e._v("基本信息")]),t("el-form-item",{staticClass:"textarea",attrs:{label:"告警名称",prop:"name"}},[t("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"支持中文、英文、数字、下划线组合20位字符",disabled:!e.isOwner},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),t("el-form-item",{attrs:{label:"选择项目",prop:"objectProject"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",disabled:!e.isOwner||e.ruleForm.id>0,filterable:""},on:{change:function(t){return e.onChange("options_objectType")}},model:{value:e.ruleForm.objectProject,callback:function(t){e.$set(e.ruleForm,"objectProject",t)},expression:"ruleForm.objectProject"}},e._l(e.options_objectType,(function(e,r){return t("el-option",{key:r,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"任务类型",prop:"objectType"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",disabled:!e.isOwner||e.ruleForm.id>0},on:{change:function(t){return e.onChange("allTaskTypeLists")}},model:{value:e.ruleForm.objectType,callback:function(t){e.$set(e.ruleForm,"objectType",t)},expression:"ruleForm.objectType"}},e._l(e.allTaskTypeLists,(function(e,r){return t("el-option",{key:r,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"任务名称",prop:"alarmObjects"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",multiple:"",disabled:!e.isOwner},model:{value:e.ruleForm.alarmObjects,callback:function(t){e.$set(e.ruleForm,"alarmObjects",t)},expression:"ruleForm.alarmObjects"}},e._l(e.taskMenuList,(function(e,r){return t("el-option",{key:r,attrs:{label:e.name,value:e.id}})})),1)],1),t("div",{staticClass:"form-title"},[e._v("触发方式")]),t("el-form-item",{attrs:{label:"触发条件",prop:"triggerCondition"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择规则类型",disabled:!e.isOwner},model:{value:e.ruleForm.triggerCondition,callback:function(t){e.$set(e.ruleForm,"triggerCondition",t)},expression:"ruleForm.triggerCondition"}},e._l(e.options_triggerCondition,(function(e,r){return t("el-option",{key:r,attrs:{label:e.name,value:e.id}})})),1)],1),t("div",{staticClass:"form-title"},[e._v("告警接收")]),t("el-form-item",{attrs:{label:"报警方式",prop:"alarmModes"}},[t("el-tooltip",{staticStyle:{position:"absolute",left:"-40px",top:"10px"},attrs:{placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n              1、邮件仅支持集团内部邮件"),t("br"),e._v("\n              2、使用电话和短信需确保接收人手机正确，才能正常的接收告警信息"),t("br"),e._v("\n              3、使用T信需确保接收人已接入T信，才能正常的接收告警信息\n            ")]),t("i",{staticClass:"el-icon-question"})]),t("el-checkbox-group",{attrs:{disabled:!e.isOwner},model:{value:e.ruleForm.alarmModes,callback:function(t){e.$set(e.ruleForm,"alarmModes",t)},expression:"ruleForm.alarmModes"}},e._l(e.options_alarmModes,(function(r,a){return t("el-checkbox",{key:a+"check",attrs:{label:r.id,disabled:1==e.ruleForm.alarmModes.length&&e.options_alarmModes.findIndex((function(t){return t.id==e.ruleForm.alarmModes[0]}))==a},on:{change:function(t){return e.checkListHandle(t,a,r)}}},[e._v("\n            "+e._s(r.name)+"\n          ")])})),1)],1),t("el-form-item",{attrs:{label:"接收人类型",prop:"receivedType"}},[t("el-radio-group",{attrs:{disabled:!e.isOwner},on:{change:e.changeRadio},model:{value:e.ruleForm.receivedType,callback:function(t){e.$set(e.ruleForm,"receivedType",t)},expression:"ruleForm.receivedType"}},e._l(e.allReceivedTypeLists,(function(r){var a=r.name,i=r.id;return t("el-radio",{key:i,attrs:{label:i}},[e._v(e._s(a))])})),1),t("el-tooltip",{staticStyle:{position:"relative",left:"0px"},attrs:{placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n              当选择平台外用户时，根据选择的告警方式自定义"),t("br"),e._v("邮箱、电话、短信和T信号\n            ")]),t("i",{staticClass:"el-icon-question"})])],1),1==e.ruleForm.receivedType||2==e.ruleForm.receivedType?t("el-form-item",{staticClass:"cur_el-dialog__wrapper",attrs:{label:"接收人",prop:"receivedList"}},[t("choose-con02",{key:e.refreshKey02,attrs:{receivedType:e.ruleForm.receivedType,isOwer:e.isOwner,"select-data02":e.users},on:{"update:selectData02":function(t){e.users=t},"update:select-data02":function(t){e.users=t},confirm02:e.confirmChoose02}})],1):e._e(),4==e.ruleForm.receivedType?t("div",{staticClass:"table-content"},[t("div",{staticClass:"sub-title"},[e._v(" 接收人"),t("span",{staticClass:"icon"},[e._v("*")])]),t("div",{staticClass:"right"},[t("el-tabs",{staticClass:"tabs-tab",model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[e._l(e.ruleForm.alarmModes,(function(r){return t("el-tab-pane",{key:r+"tab-active",attrs:{label:1==r?"邮箱":2==r?"T信":3==r?"电话":"短信",name:1==r?"邮箱":2==r?"T信":3==r?"电话":"短信"}},[t("el-table",{ref:"tabTable",refInFor:!0,staticClass:"params_table rule-table",staticStyle:{width:"100%"},attrs:{data:"1"==r?e.ruleForm.jemail:"2"==r?e.ruleForm.jTletter:"3"==r?e.ruleForm.jphone:e.ruleForm.jletter}},[t("el-table-column",{attrs:{"min-width":"100",label:"输入对象"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"table-tab",style:"3"==r||"4"==r?"display:flex;justify-content: space-between;":""},["1"==r?t("el-form-item",{attrs:{prop:"jemail."+a.$index+".email",rules:[{required:!0,message:"不能为空",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"change"}]}},[t("el-input",{attrs:{placeholder:"请输入邮箱"},model:{value:a.row.email,callback:function(t){e.$set(a.row,"email",t)},expression:"scope.row.email"}})],1):"3"==r?t("el-form-item",{attrs:{prop:"jphone."+a.$index+".phone",rules:[{required:!0,message:"不能为空",trigger:"blur"},{validator:e.validateTel,trigger:"change"}]}},[t("el-input",{staticStyle:{width:"260px"},attrs:{placeholder:"请输入手机号或座机，座机不支持发短信"},model:{value:a.row.phone,callback:function(t){e.$set(a.row,"phone",t)},expression:"scope.row.phone"}})],1):"4"==r?t("el-form-item",{attrs:{prop:"jletter."+a.$index+".shortLetter",rules:[{required:!0,message:"不能为空",trigger:"blur"},{validator:e.validatePhone,trigger:"change"}]}},[t("el-input",{staticStyle:{width:"260px"},attrs:{placeholder:"请输入手机号"},model:{value:a.row.shortLetter,callback:function(t){e.$set(a.row,"shortLetter",t)},expression:"scope.row.shortLetter"}})],1):"2"==r?t("el-form-item",{attrs:{prop:"jTletter."+a.$index+".tletter",rules:[{required:!0,message:"不能为空",trigger:"blur"},{message:"请输入2-30字符，支持中英文开头，数字，下划线_,小圆点.组合",trigger:"blur",pattern:"^[一-龥a-zA-Z][一-龥a-zA-Z0-9_.]{1,29}$"}]}},[t("el-input",{attrs:{placeholder:"请输入T信账号"},model:{value:a.row.tletter,callback:function(t){e.$set(a.row,"tletter",t)},expression:"scope.row.tletter"}})],1):e._e(),"3"==r||"4"==r?t("el-form-item",{staticStyle:{flex:"0.5"},attrs:{prop:"".concat("电话"==r?"jphone.":"jletter").concat(a.$index,".cheackState")}},[t("el-checkbox",{model:{value:a.row.cheackState,callback:function(t){e.$set(a.row,"cheackState",t)},expression:"scope.row.cheackState"}},[e._v("同"+e._s("3"==r?"短信":"电话")+"接收，勾选后无"),t("br"),e._v("需重复配置"+e._s("3"==r?"短信":"电话")+"接收")])],1):e._e()],1)]}}],null,!0)}),t("el-table-column",{attrs:{label:"操作","header-align":"left",width:"80px",align:"left"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("div",{staticStyle:{position:"relative",height:"100%"}},[t("el-button",{staticClass:"delete-btn",staticStyle:{display:"inline-block","margin-bottom":"10px"},attrs:{size:"mini",type:"text"},on:{click:function(t){return e.deleteCur(r.$index)}}},[e._v("删除")])],1)]}}],null,!0)})],1)],1)})),t("div",{staticClass:"addNew",on:{click:function(t){return e.addNew()}}},[e._v("按通知方式添加+")])],2)],1)]):e._e(),t("div",{staticClass:"form-title"},[e._v("告警控制")]),t("el-form-item",{attrs:{label:"免打扰时间",prop:"start_end_time"}},[t("el-time-picker",{attrs:{"arrow-control":"","is-range":"","value-format":"HH:mm:ss",disabled:!e.isOwner,"range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",placeholder:"选择时间范围"},model:{value:e.ruleForm.start_end_time,callback:function(t){e.$set(e.ruleForm,"start_end_time",t)},expression:"ruleForm.start_end_time"}})],1),t("el-form-item",{key:"notificationsNumber",attrs:{label:"通知次数"}},[t("el-tooltip",{staticStyle:{position:"absolute",left:"-50px",top:"10px"},attrs:{placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n              1、告警次数默认发一次，设置后按设置的次数发"),t("br"),e._v("\n              2、当告警次数>1时，设置的告警间隔时间才生效\n            ")]),t("i",{staticClass:"el-icon-question"})]),t("el-input-number",{attrs:{min:1,"controls-position":"right"},model:{value:e.ruleForm.maxAlarmCount,callback:function(t){e.$set(e.ruleForm,"maxAlarmCount",t)},expression:"ruleForm.maxAlarmCount"}})],1),t("el-form-item",{key:"notificationInterval",attrs:{label:"通知间隔(min)"}},[t("el-input-number",{attrs:{min:10,"controls-position":"right"},model:{value:e.ruleForm.minAlarmInterval,callback:function(t){e.$set(e.ruleForm,"minAlarmInterval",t)},expression:"ruleForm.minAlarmInterval"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary",disabled:!e.isOwner,loading:e.addLoading},on:{click:function(t){return e.sure()}}},[e._v("保存")])],1)],1)],1)}),[],!1,null,null,null).exports,T={data:function(){return{ruleForm:{},dialogVisible:!1}},methods:{diaClose:function(){},open:function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d(t);case 2:this.ruleForm=e.sent.data.data,this.dialogVisible=!0;case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}},j=(r("1ea5"),Object(_.a)(T,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"ruleDetail"},[t("el-dialog",{attrs:{title:"任务告警详情",visible:e.dialogVisible,customClass:"customWidth",width:"60% !important"},on:{close:e.diaClose,"update:visible":function(t){e.dialogVisible=t}}},[e.ruleForm?t("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,"label-width":"100px"}},[t("div",{staticClass:"tit"},[e._v("基本信息:")]),t("el-form-item",{attrs:{label:"告警名称："}},[t("span",[e._v(e._s(e.ruleForm.name))])]),t("el-form-item",{attrs:{label:"选择项目："}},[t("span",[e._v(e._s(e.ruleForm.procName))])]),t("el-form-item",{attrs:{label:"任务类型："}},[t("span",[e._v(e._s(e.ruleForm.taskTypeTatil))])]),t("el-form-item",{attrs:{label:"任务名称："}},[t("span",[e._v(e._s(e.ruleForm.objectNames))])]),t("div",{staticClass:"tit"},[e._v("触发方式:")]),t("el-form-item",{attrs:{label:"触发条件："}},[t("span",[e._v(e._s(e.ruleForm.triggerConditionTatil))])]),t("div",{staticClass:"tit"},[e._v("报警行为:")]),t("el-form-item",{attrs:{label:"免打扰时间："}},[t("span",[e._v(e._s(e.ruleForm.noDisturbingStartTime)+" - "+e._s(e.ruleForm.noDisturbingEntTime))])]),t("el-form-item",{attrs:{label:"报警方式："}},[t("span",[e._v(e._s(e.ruleForm.alarmModeTatil))])]),t("el-form-item",{attrs:{label:"接收人："}},[t("span",[e._v(e._s(e.ruleForm.receivedNames))])])],1):e._e(),t("div",{staticClass:"btn",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")])],1)],1)],1)}),[],!1,null,"465795d7",null).exports);function F(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?F(Object(r),!0).forEach((function(t){Object(a.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var O,M,C,I=new Map([[1,"FLINK API"],[2,"FLINK SQL"],[3,"FLINK SQL DAG"],[4,"实时采集"]]),$=new Map([["1","邮件"]]),S={data:function(){return{formInline:{name:"",createUserId:"",receiveUserId:"",alarmModeTitle:""},userList:[],receiverList:[],list:[],loading:!1,pageOptions:{page:1,limit:10,total:0},mapTaskType:I,mapAlarmMode:$,alarmModeTitleList:[{label:"邮件",value:1},{label:"T信",value:2},{label:"电话",value:3},{label:"短信",value:4}]}},components:{CreateOrEdit:w,Detail:j},mounted:(C=Object(o.a)(regeneratorRuntime.mark((function e(){var t,r,a,o,c,d,u,m,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.a.get(s.a.getCreater),n.a.get(s.a.getReceiver),l({page:1,limit:10})]);case 2:t=e.sent,r=Object(i.a)(t,3),a=r[0],o=r[1],c=r[2].data.page,d=c.list,u=c.currPage,m=c.pageSize,p=c.totalCount,this.list=d,this.pageOptions={page:u,limit:m,total:p},this.userList=a.data.data,this.receiverList=o.data.data,this.$route.query.status&&this.$route.query.id&&this.toDetail(this.$route.query.id);case 16:case"end":return e.stop()}}),e,this)}))),function(){return C.apply(this,arguments)}),methods:{permission:function(e){return this.$store.state.old.admin_info.userId!=e},search:function(){this.pageOptions.page=1,this.getList()},getList:(M=Object(o.a)(regeneratorRuntime.mark((function e(){var t,r,a,i,o,s,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=L(L({},this.formInline),this.pageOptions),this.loading=!0,e.next=4,l(t);case 4:r=e.sent,a=r.data.page,i=a.list,o=a.currPage,s=a.pageSize,n=a.totalCount,this.pageOptions={page:o,limit:s,total:n},this.list=i,this.loading=!1;case 13:case"end":return e.stop()}}),e,this)}))),function(){return M.apply(this,arguments)}),sizeChangeHandle:function(e){this.pageOptions.limit=e,this.pageOptions.page=1,this.getList()},currentChangeHandle:function(e){this.pageOptions.page=e,this.getList()},create:function(e){e&&(this.$refs.create.addLoading=!0),this.$refs.create.open(e)},stateChange:(O=Object(o.a)(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.id,a=t.stateFlage,e.next=3,u({id:r,stateFlage:a});case 3:this.$message.success("".concat(a?"启用":"禁用","成功")),this.getList();case 5:case"end":return e.stop()}}),e,this)}))),function(e){return O.apply(this,arguments)}),deleteTask:function(e){var t=this;(function(e){return n.a.get(s.a.deleteRealTask.replace(":id",e))})(e).then((function(){t.$message.success("删除成功"),t.getList()}))},toDetail:function(e){this.$refs.detail.open(e)},formatTaskType:function(e,t){return this[t].get(e)},reset:function(){this.$refs.formInline.resetFields(),this.pageOptions={page:1,limit:10,total:0},this.getList()}}},D=(r("3903"),r("0892"),Object(_.a)(S,(function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"zt-head noBorder"},[e._v("实时任务告警")]),t("div",{staticClass:"realtimeTaskAlarms"},[t("div",{staticClass:"search-header"},[t("div",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.create("")}}},[e._v("新建实时任务告警")])],1),t("div",[t("el-form",{ref:"formInline",attrs:{inline:"",model:e.formInline,size:"small"}},[t("el-form-item",{attrs:{prop:"alarmModeTitle"}},[t("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择告警方式"},model:{value:e.formInline.alarmModeTitle,callback:function(t){e.$set(e.formInline,"alarmModeTitle",t)},expression:"formInline.alarmModeTitle"}},e._l(e.alarmModeTitleList,(function(e,r){return t("el-option",{key:r,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{prop:"createUserId"}},[t("el-select",{attrs:{placeholder:"请选择创建人",clearable:"",filterable:""},model:{value:e.formInline.createUserId,callback:function(t){e.$set(e.formInline,"createUserId",t)},expression:"formInline.createUserId"}},e._l(e.userList,(function(e){var r=e.userName,a=e.userId;return t("el-option",{key:a,attrs:{label:r,value:a}})})),1)],1),t("el-form-item",{attrs:{prop:"receiveUserId"}},[t("el-select",{attrs:{placeholder:"请选择接收人",clearable:"",filterable:""},model:{value:e.formInline.receiveUserId,callback:function(t){e.$set(e.formInline,"receiveUserId",t)},expression:"formInline.receiveUserId"}},e._l(e.receiverList,(function(e){var r=e.userName,a=e.userId;return t("el-option",{key:a,attrs:{label:r,value:a}})})),1)],1),t("el-form-item",{attrs:{prop:"name"}},[t("el-input",{attrs:{placeholder:"请输入告警名称"},model:{value:e.formInline.name,callback:function(t){e.$set(e.formInline,"name","string"==typeof t?t.trim():t)},expression:"formInline.name"}})],1),t("el-form-item",{staticStyle:{"margin-right":"0"}},[t("el-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("查询")]),t("el-button",{on:{click:e.reset}},[e._v("重置")])],1)],1)],1)]),t("div",[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.list,"row-key":"id"}},[t("el-table-column",{attrs:{label:"告警ID",prop:"id"}}),t("el-table-column",{attrs:{label:"告警名称",prop:"name","show-overflow-tooltip":!0}}),t("el-table-column",{attrs:{label:"任务类型",prop:"taskType"},scopedSlots:e._u([{key:"default",fn:function(r){var a=r.row;return[t("span",[e._v(e._s(e.formatTaskType(a.taskType,"mapTaskType")))])]}}])}),t("el-table-column",{attrs:{label:"触发条件",prop:"triggerConditionTatil"}}),t("el-table-column",{attrs:{label:"报警方式",prop:"alarmModeTatil",width:"150"}}),t("el-table-column",{attrs:{label:"接收人",prop:"receivedNames","show-overflow-tooltip":!0}}),t("el-table-column",{attrs:{label:"创建人",prop:"createPerName"}}),t("el-table-column",{attrs:{label:"创建时间",prop:"createTime","min-width":"120px"}}),t("el-table-column",{attrs:{label:"状态",prop:"createTime"},scopedSlots:e._u([{key:"default",fn:function(r){var a=r.row;return[t("el-switch",{attrs:{"active-text":"启用","inactive-text":"禁用",width:60,"active-color":"#13ce66","inactive-color":"#ff4949",disabled:e.permission(a.createPer)},on:{change:function(t){return e.stateChange(a)}},model:{value:a.stateFlage,callback:function(t){e.$set(a,"stateFlage",t)},expression:"row.stateFlage"}})]}}])}),t("el-table-column",{attrs:{label:"操作","min-width":"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(r){var a=r.row;return[t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"taskAlarms_info",expression:"'taskAlarms_info'"}],attrs:{type:"text"},on:{click:function(t){return e.toDetail(a.id)}}},[e._v("详情")]),t("el-button",{attrs:{type:"text",disabled:e.permission(a.createPer)},on:{click:function(t){return e.create(a.id)}}},[e._v("编辑")]),t("el-popconfirm",{staticStyle:{"margin-left":"10px"},attrs:{title:"确定删除吗？"},on:{onConfirm:function(t){return e.deleteTask(a.id)}}},[t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"taskAlarms_delete",expression:"'taskAlarms_delete'"}],attrs:{slot:"reference",type:"text",disabled:e.permission(a.createPer)},slot:"reference"},[e._v("删除")])],1)]}}])})],1),t("el-pagination",{attrs:{"current-page":e.pageOptions.page,"page-sizes":[10,20,50,100],"page-size":e.pageOptions.limit,total:e.pageOptions.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.sizeChangeHandle,"current-change":e.currentChangeHandle}})],1),t("CreateOrEdit",{ref:"create",on:{refreshDataList:e.getList}}),t("Detail",{ref:"detail"})],1)])}),[],!1,null,"c369403c",null));t.default=D.exports},e0b8:function(e,t,r){"use strict";var a=r("7726"),i=r("5ca1"),o=r("2aba"),s=r("dcbc"),n=r("67ab"),l=r("4a59"),c=r("f605"),d=r("d3f4"),u=r("79e5"),m=r("5cc5"),p=r("7f20"),f=r("5dbc");e.exports=function(e,t,r,h,b,g){var v=a[e],y=v,x=b?"set":"add",k=y&&y.prototype,_={},w=function(e){var t=k[e];o(k,e,"delete"==e||"has"==e?function(e){return!(g&&!d(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return g&&!d(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,r){return t.call(this,0===e?0:e,r),this})};if("function"==typeof y&&(g||k.forEach&&!u((function(){(new y).entries().next()})))){var T=new y,j=T[x](g?{}:-0,1)!=T,F=u((function(){T.has(1)})),L=m((function(e){new y(e)})),O=!g&&u((function(){for(var e=new y,t=5;t--;)e[x](t,t);return!e.has(-0)}));L||((y=t((function(t,r){c(t,y,e);var a=f(new v,t,y);return null!=r&&l(r,b,a[x],a),a}))).prototype=k,k.constructor=y),(F||O)&&(w("delete"),w("has"),b&&w("get")),(O||j)&&w(x),g&&k.clear&&delete k.clear}else y=h.getConstructor(t,e,b,x),s(y.prototype,r),n.NEED=!0;return p(y,e),_[e]=y,i(i.G+i.W+i.F*(y!=v),_),g||h.setStrong(y,e,b),y}},e677:function(e,t,r){"use strict";r("5089")},e853:function(e,t,r){var a=r("d3f4"),i=r("1169"),o=r("2b4c")("species");e.exports=function(e){var t;return i(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!i(t.prototype)||(t=void 0),a(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},f400:function(e,t,r){"use strict";var a=r("c26b"),i=r("b39a");e.exports=r("e0b8")("Map",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(e){var t=a.getEntry(i(this,"Map"),e);return t&&t.v},set:function(e,t){return a.def(i(this,"Map"),0===e?0:e,t)}},a,!0)}}]);