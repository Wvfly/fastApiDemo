(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-46db4080"],{3606:function(e,t,r){(e.exports=r("2350")(!1)).push([e.i,".primary-color{color:#1740dc}.success-color{color:#52c41a}.warning-color{color:#faad14}.error-color{color:#f5222d}.info-color{color:#909399}.border-color{border:1px solid #e5e6e9}.secretContent{padding:20px}.secretContent .title{font-size:16px;font-weight:700}.secretContent .action_content{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;margin:20px 0}.secretContent .action_content,.secretContent .flex{display:-webkit-box;display:-ms-flexbox;display:flex;justify-items:center}.secretContent .flex{-webkit-box-align:center;-ms-flex-align:center;align-items:center}",""])},"3c43":function(e,t){t.endianness=function(){return"LE"},t.hostname=function(){return"undefined"!=typeof location?location.hostname:""},t.loadavg=function(){return[]},t.uptime=function(){return 0},t.freemem=function(){return Number.MAX_VALUE},t.totalmem=function(){return Number.MAX_VALUE},t.cpus=function(){return[]},t.type=function(){return"Browser"},t.release=function(){return"undefined"!=typeof navigator?navigator.appVersion:""},t.networkInterfaces=t.getNetworkInterfaces=function(){return{}},t.arch=function(){return"javascript"},t.platform=function(){return"browser"},t.tmpdir=t.tmpDir=function(){return"/tmp"},t.EOL="\n",t.homedir=function(){return"/"}},"8b74":function(e,t,r){var a=r("3606");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,r("499e").default)("062adb47",a,!0,{sourceMap:!1,shadowMode:!1})},add2:function(e,t,r){"use strict";r("8b74")},bbf4:function(e,t,r){"use strict";r.r(t);r("7f7f"),r("3b2b"),r("3c43");var a=r("2b0e"),l=r("fedb"),o={components:{},data:function(){return{type:1,page:1,limit:20,total:20,dialogTitle:"",options:[],row:"",creatRoleOptions:[],roleSelectOptions:[],searchValue:"",tableData:[],dialogVisible:!1,ruleForm:{name:"",secretWay:"",publicKey:"",roleId:"",desc:"",secretKey1:"",secretKey2:"",secretKey3:"",secretKey4:""},rules:{name:[{required:!0,validator:function(e,t,r){var a=new RegExp("^[-_a-zA-Z0-9][-_a-zA-Z0-9_一-龥]+$");return t?a.exec(t)?void r():r(new Error("请以英文，数字开头,支持 - _ ,不包含￥%&等特殊符号")):r(new Error("秘钥名称不能为空"))},trigger:"blur"}],publicKey:{required:!0,message:"请生成秘钥",trigger:"change"},roleId:[{required:!0,message:"请选择角色",trigger:"change"}],secretWay:[{required:!0,message:"请选择一个加密类型",trigger:"change"}],desc:[{required:!0,message:"描述不得多于50字符",max:50,trigger:"blur"}]}}},computed:{},watch:{},methods:{getWay:function(){var e=this;a.default.http.get(l.a.secretWayList).then((function(t){e.options=t.data.data}))},creatRoleSelectNew:function(){var e=this;a.default.http.get(l.a.getcreatRoleSelectNew).then((function(t){e.creatRoleOptions=t.data.data}))},roleSelectNew:function(){var e=this;a.default.http.get(l.a.getRoleSelectNew).then((function(t){e.roleSelectOptions=t.data.data}))},getlist:function(){var e,t=this;(e={createPer:this.searchValue,limit:this.limit,page:this.page},a.default.http.post(l.a.getSecretList,e)).then((function(e){t.tableData=e.data.page.list,t.total=e.data.page.totalCount}))},clearkey:function(){this.ruleForm.secretKey1="",this.ruleForm.secretKey2="",this.ruleForm.secretKey3="",this.ruleForm.secretKey4="",this.ruleForm.publicKey=""},creatSecret:function(){var e,t=this;(e={secretWay:this.ruleForm.secretWay},a.default.http.get(l.a.generateSecret+"?secretWay="+e.secretWay)).then((function(e){29===t.ruleForm.secretWay||34===t.ruleForm.secretWay?(t.ruleForm.secretKey1=e.data.data.secretKey1,t.ruleForm.secretKey2=e.data.data.secretKey2,t.ruleForm.secretKey3=e.data.data.secretKey3,t.ruleForm.secretKey4=e.data.data.secretKey4):(t.ruleForm.secretKey1="",t.ruleForm.secretKey2="",t.ruleForm.secretKey3="",t.ruleForm.secretKey4=""),t.ruleForm.publicKey=e.data.data.publicKey}))},theSaveSecret:function(){var e,t=this;(e=this.ruleForm,a.default.http.post(l.a.saveSecret,e)).then((function(e){0===e.data.code?(t.$message({message:"添加成功",type:"success"}),t.resetForm("ruleForm"),t.getlist(),t.dialogVisible=!1):t.$message.error("操作失败！")}))},changepower:function(){var e,t=this;(e={id:this.row.id,roleId:this.ruleForm.roleId},a.default.http.get(l.a.updateRole+"?id="+e.id+"&roleId="+e.roleId)).then((function(e){0==e.data.code&&(t.$message({message:"操作成功",type:"success"}),t.dialogVisible=!1,t.getlist())}))},handleSizeChange:function(e){this.limit=e,this.getlist()},handleCurrentChange:function(e){this.page=e,this.getlist()},handleCreat:function(e,t){this.type=e,1===e?(this.cleardata(),this.dialogTitle="新建秘钥"):(this.dialogTitle="变更授权",this.row=t,this.ruleForm={name:t.name,secretWay:t.secretWay,publicKey:t.publicKey,roleId:t.roleId,desc:t.desc,secretKey1:t.secretKey1,secretKey2:t.secretKey2,secretKey3:t.secretKey3,secretKey4:t.secretKey4}),this.dialogVisible=!0},handleReset:function(){this.searchValue="",this.getlist()},cleardata:function(){this.ruleForm={name:"",secretWay:"",publicKey:"",roleId:"",desc:"",secretKey1:"",secretKey2:"",secretKey3:"",secretKey4:""}},handleSearch:function(){this.getlist()},handleClose:function(){this.dialogVisible=!1},handleDelete:function(e){var t=this,r=this.$createElement;this.$msgbox({title:"删除秘钥",type:"warning",showCancelButton:!0,confirmButtonText:"继续",cancelButtonText:"取消",message:r("p",null,[r("span",{style:"color: red"},"秘钥删除后不可恢复，确定删除该秘钥？")])}).then((function(){var r;(r={id:e.id},a.default.http.get(l.a.deleteSecre+"?id="+r.id)).then((function(e){0===e.data.code?(t.$message({type:"success",message:"删除成功!"}),t.getlist()):t.$message.error("操作失败！")}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;1===t.type?t.theSaveSecret():t.changepower()}))},resetForm:function(e){this.$refs[e].resetFields()}},created:function(){},mounted:function(){this.getWay(),this.getlist(),this.creatRoleSelectNew(),this.roleSelectNew()}},s=(r("add2"),r("2877")),n=Object(s.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"secretContent"},[t("div",{staticClass:"title"},[e._v("秘钥管理")]),t("div",{staticClass:"action_content"},[t("div",{staticClass:"action_creat"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleCreat(1)}}},[e._v("创建秘钥")])],1),t("div",{staticClass:"action_search_content"},[t("div",{staticClass:"action_select"}),t("div",{staticClass:"action_button"},[t("el-select",{attrs:{placeholder:"请选择创建人"},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}},e._l(e.creatRoleOptions,(function(e){return t("el-option",{key:e.userId,attrs:{label:e.username,value:e.userId}})})),1),t("el-button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("查询")]),t("el-button",{attrs:{type:"default"},on:{click:e.handleReset}},[e._v("重置")])],1)])]),t("div",{staticClass:"tabale_content"},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[t("el-table-column",{attrs:{prop:"id",label:"序号",width:"180"}}),t("el-table-column",{attrs:{prop:"name",label:"秘钥名称",width:"180"}}),t("el-table-column",{attrs:{prop:"createPerName",label:"创建人"}}),t("el-table-column",{attrs:{prop:"desc",label:"描述",placeholder:"请输入描述"}}),t("el-table-column",{attrs:{prop:"publicKey",label:"密钥","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"createTime",label:"创建时间"}}),t("el-table-column",{attrs:{prop:"action",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.handleDelete(r.row)}}},[e._v("删除")]),t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.handleCreat(2,r.row)}}},[e._v("变更授权")])]}}])})],1),t("el-pagination",{attrs:{"current-page":e.page,"page-sizes":[10,20,30,40],"page-size":e.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogVisible,width:"45%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"秘钥名称",prop:"name"}},[t("el-input",{attrs:{placeholder:"请输入秘钥名称，以英文，数字开头，支持 - _ ，50字符以内",maxlength:"50",disabled:1!==e.type},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),t("el-form-item",{attrs:{label:"加密类型",prop:"secretWay"}},[t("el-select",{attrs:{placeholder:"请选择加密方式",disabled:1!==e.type},on:{change:e.clearkey},model:{value:e.ruleForm.secretWay,callback:function(t){e.$set(e.ruleForm,"secretWay",t)},expression:"ruleForm.secretWay"}},e._l(e.options,(function(r,a){return a<4?t("el-option",{key:r.id,attrs:{label:r.key,value:r.id}}):e._e()})),1)],1),t("el-form-item",{attrs:{label:"生成秘钥"}},[t("el-button",{attrs:{disabled:1!==e.type},on:{click:e.creatSecret}},[e._v("点击生成秘钥")])],1),t("el-form-item",{attrs:{label:"秘钥",prop:"publicKey"}},[t("el-input",{attrs:{disabled:!0},model:{value:e.ruleForm.publicKey,callback:function(t){e.$set(e.ruleForm,"publicKey",t)},expression:"ruleForm.publicKey"}})],1),t("el-form-item",{attrs:{label:"授权角色",prop:"roleId"}},[t("el-select",{attrs:{placeholder:"请选择角色"},model:{value:e.ruleForm.roleId,callback:function(t){e.$set(e.ruleForm,"roleId",t)},expression:"ruleForm.roleId"}},e._l(e.roleSelectOptions,(function(e){return t("el-option",{key:e.roleId,attrs:{label:e.roleName,value:e.roleId}})})),1)],1),t("el-form-item",{attrs:{label:"描述",prop:"desc"}},[t("el-input",{attrs:{type:"textarea",disabled:1!==e.type},model:{value:e.ruleForm.desc,callback:function(t){e.$set(e.ruleForm,"desc",t)},expression:"ruleForm.desc"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("提 交")]),t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")])],1)],1)],1)}),[],!1,null,null,null);t.default=n.exports}}]);