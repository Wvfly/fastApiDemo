(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-72bf588d"],{1194:function(e,t,r){(e.exports=r("2350")(!1)).push([e.i,".primary-color{color:#1740dc}.success-color{color:#52c41a}.warning-color{color:#faad14}.error-color{color:#f5222d}.info-color{color:#909399}.border-color{border:1px solid #e5e6e9}.rule-table /deep/ .el-table__body .cell{padding-left:0}.rule-table:before{background-color:inherit}.rule-time{width:440px}.schedulerDialog .el-input-number.is-controls-right .el-input__inner{padding-left:15px;padding-right:50px;text-align:left}.schedulerDialog .sub-ctr,.schedulerDialog .table-content{display:-webkit-box;display:-ms-flexbox;display:flex}.schedulerDialog .table-content .sub-title{text-align:left;width:120px;font-size:12px;color:#606266}.schedulerDialog .table-content .sub-title .icon{margin-left:4px;font-size:12px;color:#f5222d}.schedulerDialog .table-content .right{-webkit-box-flex:1;-ms-flex:1;flex:1}.schedulerDialog .table-content .right .params_table .cell{line-height:normal!important}.schedulerDialog .table-content .right .params_table .cell .el-form-item{margin-bottom:3px!important}.schedulerDialog .table-content .right .params_table .cell .el-form-item__content{margin-left:0!important}.schedulerDialog .table-content .right .params_table .delete-btn{color:#040c2c}.schedulerDialog .table-content .right .params_table .delete-btn:hover{color:#1740dc}.schedulerDialog .table-content .right .addNew{width:100%;height:32px;line-height:32px;text-align:center;border:1px dashed #d9d9d9;cursor:pointer;color:#040c2c}.schedulerDialog .table-content .right .addNew:hover{color:#1740dc}",""])},"442e":function(e,t,r){"use strict";r("7f7f"),r("8e6e"),r("ac6a"),r("456d");var l,a=r("ade3"),i=(r("96cf"),r("1da1")),s=(r("c5f6"),r("8e5b"));function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,l)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){Object(a.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var n,u,p=(l={name:"Scheduling",components:{},props:{ctr:{type:Object},ruleIds:{type:Number}},data:function(){return{pickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}},isSubmit:!1,ruleList:[],runStyle:[],scheduleStyle:[],timeDateValue:[],cronTypeList:[{value:1,name:"手动配置"},{value:2,name:"crontab配置"}],weeks:[{label:"周一",value:1},{label:"周二",value:2},{label:"周三",value:3},{label:"周四",value:4},{label:"周五",value:5},{label:"周六",value:6},{label:"周日",value:7}],form:{scheduleType:1,scheduleCycle:1,scheduleTime:"",cycleHour:""},ruleForm:{dispatchType:null,dispatchRetryNum:"",dispatchRetryInterval:"",dispatchRetryEnable:0,dispatchExpression:"",dispatchCycleUnit:"H",dispatchCycleType:1,dispatchCycleStart:"",dispatchCycleEnd:"",dispatchCycle:0,dispatchConfType:1,cronType:1,loopType:1,crontab:"",dispatchCycleWeek:1,dispatchCycleDay:1,dispatchCycleHour:0,dispatchCycleMin:0,dispatchTime:null,isRetry:0,reTryInterval:"",isOpenTime:0},rules:{dispatchType:[{required:!0,message:"请选择调度方式",trigger:"change"}],dispatchConfType:[{required:!0,message:"请选择配置方式",trigger:"change"}],dispatchCycleUnit:[{required:!0,message:"请选择调度周期",trigger:"change"}],dispatchCycleType:[{required:!0,message:"请选择循环方式",trigger:"change"}],dispatchCycle:[{required:!0,message:"请选择",trigger:"change"}],scheduleTime:[{required:!0,message:"请选择调度时间",trigger:"change"}],cycleHour:[{required:!0,message:"请输入循环周期",trigger:"change"}],dispatchExpression:[{required:!0,message:"请输入crontab表达式",trigger:"blur"}],dispatchCycleWeek:[{required:!0,message:"请选择周",trigger:"change"}],dispatchCycleDay:[{required:!0,message:"请选择天",trigger:"change"}],dispatchCycleHour:[{required:!0,message:"请选择",trigger:"change"}],dispatchCycleMin:[{required:!0,message:"请输入",trigger:"change"}]}}},watch:{},mounted:function(){this.getRunStyle(),this.ruleIds&&this.getDispatchShow()},methods:{timeChange:function(){var e,t;this.ruleForm.dispatchCycleStart=(null===(e=this.timeDateValue)||void 0===e?void 0:e[0])||"",this.ruleForm.dispatchCycleEnd=(null===(t=this.timeDateValue)||void 0===t?void 0:t[1])||""},getDispatchShow:(u=Object(i.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(s.A)(this.ruleIds);case 2:t=e.sent,this.ruleForm=o({},t.data.data),this.timeDateValue[0]=t.data.data.dispatchCycleStart||"",this.timeDateValue[1]=t.data.data.dispatchCycleEnd||"";case 6:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)}),changePress:function(e,t){2==this.ruleForm.dispatchCycleType&&(2==t?sessionStorage.setItem("curExpression1",JSON.stringify({value:e,type:2})):sessionStorage.setItem("curExpression2",JSON.stringify({value:e,type:3})))},changeDiao:function(e){3==e&&(this.ruleForm.dispatchCycle="")},changeOption:function(e){this.ruleForm.dispatchCycleWeek=1,this.ruleForm.dispatchCycleDay=1},getRuleSheduleDetail:function(e){var t=this;this.$API.get(this.$URL.getRuleSheduleDetail+e,{},(function(e){0==e.code?e.data.ruleId&&(t.ruleForm=e.data,t.timeDateValue=[e.data.startTime||"",e.data.endTime||""]):t.$message.error(e.msg)}))},reguChange:function(){var e=this;this.ruleForm.dispatchCycleUnit="H",this.ruleForm.dispatchCycleWeek=1,this.ruleForm.dispatchCycleHour=0,this.ruleForm.dispatchCycleMin=0,1==this.ruleForm.dispatchConfType&&this.$nextTick((function(){var t=e.$refs.ruleForm;t&&t.clearValidate()}))},getRunStyle:function(){var e=this;this.$API.get(this.$URL.getJobNodeInfoListSchedules,{},(function(t){if(0==t.code){e.runStyle=[],e.scheduleStyle=[];for(var r=0;r<t.data.runStyle.length;r++)e.runStyle.push({value:t.data.runStyle[r].id,name:t.data.runStyle[r].name});for(var l=0;l<t.data.scheduleStyle.length;l++)e.scheduleStyle.push({value:t.data.scheduleStyle[l].id,name:t.data.scheduleStyle[l].name});e.listWorkFlowConfig()}else e.$message.error(t.msg)}))},save:(n=Object(i.a)(regeneratorRuntime.mark((function e(){var t,r,l,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isSubmit=!0,l=o(o({},this.ruleForm),{},{dispatchCycleStart:(null===(t=this.timeDateValue)||void 0===t?void 0:t[0])||"",dispatchCycleEnd:(null===(r=this.timeDateValue)||void 0===r?void 0:r[1])||""}),e.next=4,Object(s.z)(l);case 4:0==(a=e.sent).data.code?(this.$message.success("操作成功"),this.close(),this.$emit("refresh"),this.$parent.$parent.handle.diVisible3=!1):this.$message.error(a.data.msg),this.isSubmit=!1;case 7:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)}),submitForm:function(){var e=this;this.$refs.ruleForm.validate((function(t){t&&e.save()}))},close:function(){this.$refs.ruleForm.resetFields(),this.ruleForm={},sessionStorage.removeItem("curExpression1"),sessionStorage.removeItem("curExpression2")}}},Object(a.a)(l,"watch",{"ruleForm.dispatchCycleUnit":{handler:function(e){var t,r;if(2==this.ruleForm.dispatchCycleType)if(2==e){var l=sessionStorage.getItem("curExpression1");l?this.ruleForm.dispatchCycle=JSON.parse(l).value:(t={value:this.ruleForm.dispatchCycle,type:2},sessionStorage.setItem("curExpression1",JSON.stringify(t)))}else{var a=sessionStorage.getItem("curExpression2");a?this.ruleForm.dispatchCycle=JSON.parse(a).value:(r={value:this.ruleForm.dispatchCycle,type:3},sessionStorage.setItem("curExpression2",JSON.stringify(r)))}},deep:!0,immediate:!0}}),Object(a.a)(l,"created",(function(){})),l),d=(r("60eb"),r("2877")),h=Object(d.a)(p,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"schedulerDialog"},[t("el-form",{ref:"ruleForm",staticClass:"form",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"120px"}},[t("el-alert",{staticClass:"zt-alert",staticStyle:{"margin-bottom":"20px"},attrs:{title:"根据配置的调度周期，进行质量任务的检查，检查结果在任务监控中查看。",type:"info","show-icon":""}}),t("div",{staticClass:"section"},[t("el-form-item",{attrs:{label:"调度方式",prop:"dispatchType"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择"},model:{value:e.ruleForm.dispatchType,callback:function(t){e.$set(e.ruleForm,"dispatchType",t)},expression:"ruleForm.dispatchType"}},[t("el-option",{attrs:{label:"单次调度",value:1}}),t("el-option",{attrs:{label:"周期调度",value:2}})],1)],1),2==e.ruleForm.dispatchType?t("el-form-item",{attrs:{label:"调度周期范围"}},[t("el-date-picker",{staticStyle:{"margin-bottom":"18px",width:"100%"},attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions,"value-format":"yyyy-MM-dd HH:mm:ss"},on:{change:e.timeChange},model:{value:e.timeDateValue,callback:function(t){e.timeDateValue=t},expression:"timeDateValue"}})],1):e._e(),2==e.ruleForm.dispatchType?t("el-form-item",{attrs:{label:"配置方式",prop:"dispatchConfType"}},[t("el-radio-group",{on:{change:e.reguChange},model:{value:e.ruleForm.dispatchConfType,callback:function(t){e.$set(e.ruleForm,"dispatchConfType",t)},expression:"ruleForm.dispatchConfType"}},e._l(e.cronTypeList,(function(r,l){return t("el-radio",{key:l+1,attrs:{label:r.value}},[e._v(e._s(r.name)+"\n          ")])})),1)],1):e._e(),"2"==e.ruleForm.dispatchConfType&&2==e.ruleForm.dispatchType?t("el-form-item",{attrs:{label:"crontab表达式",prop:"dispatchExpression"}},[t("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"输入crontab表达式"},model:{value:e.ruleForm.dispatchExpression,callback:function(t){e.$set(e.ruleForm,"dispatchExpression",t)},expression:"ruleForm.dispatchExpression"}})],1):e._e(),"1"==e.ruleForm.dispatchConfType&&2==e.ruleForm.dispatchType?t("el-form-item",{attrs:{label:"循环方式",prop:"dispatchCycleType"}},[t("el-radio-group",{on:{change:e.reguChange},model:{value:e.ruleForm.dispatchCycleType,callback:function(t){e.$set(e.ruleForm,"dispatchCycleType",t)},expression:"ruleForm.dispatchCycleType"}},e._l(e.scheduleStyle,(function(r,l){return t("el-radio",{key:l+1,attrs:{label:r.value}},[e._v(e._s(r.name)+"\n          ")])})),1)],1):e._e(),"1"==e.ruleForm.dispatchConfType&&"2"==e.ruleForm.dispatchCycleType&&2==e.ruleForm.dispatchType?t("el-form-item",{attrs:{prop:"dispatchCycleUnit",label:"调度周期"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择调度周期"},on:{change:e.changeDiao},model:{value:e.ruleForm.dispatchCycleUnit,callback:function(t){e.$set(e.ruleForm,"dispatchCycleUnit",t)},expression:"ruleForm.dispatchCycleUnit"}},[t("el-option",{attrs:{label:"时",value:"H"}}),t("el-option",{attrs:{label:"日",value:"d"}})],1)],1):e._e(),"1"==e.ruleForm.dispatchConfType&&"1"==e.ruleForm.dispatchCycleType&&2==e.ruleForm.dispatchType?t("el-form-item",{attrs:{prop:"dispatchCycleUnit",label:"调度周期"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择运行规则"},on:{change:e.changeOption},model:{value:e.ruleForm.dispatchCycleUnit,callback:function(t){e.$set(e.ruleForm,"dispatchCycleUnit",t)},expression:"ruleForm.dispatchCycleUnit"}},[t("el-option",{attrs:{label:"每小时",value:"H"}}),t("el-option",{attrs:{label:"每日",value:"d"}}),t("el-option",{attrs:{label:"每周",value:"u"}}),t("el-option",{attrs:{label:"每月",value:"M"}})],1)],1):e._e(),"1"==e.ruleForm.dispatchConfType&&"u"==e.ruleForm.dispatchCycleUnit&&"1"==e.ruleForm.dispatchCycleType&&2==e.ruleForm.dispatchType?t("el-form-item",{attrs:{label:"周",prop:"week dispatchCycleWeek"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择周"},model:{value:e.ruleForm.week,callback:function(t){e.$set(e.ruleForm,"week",t)},expression:"ruleForm.week"}},e._l(e.weeks,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),"1"==e.ruleForm.dispatchConfType&&"M"==e.ruleForm.dispatchCycleUnit&&"1"==e.ruleForm.dispatchCycleType&&2==e.ruleForm.dispatchType?t("el-form-item",{attrs:{label:"天",prop:"dispatchCycleDay"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择天"},model:{value:e.ruleForm.dispatchCycleDay,callback:function(t){e.$set(e.ruleForm,"dispatchCycleDay",t)},expression:"ruleForm.dispatchCycleDay"}},e._l(31,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1):e._e(),"1"!=e.ruleForm.dispatchConfType||"d"!=e.ruleForm.dispatchCycleUnit&&"u"!=e.ruleForm.dispatchCycleUnit&&"M"!=e.ruleForm.dispatchCycleUnit||"1"!=e.ruleForm.dispatchCycleType||2!=e.ruleForm.dispatchType?e._e():t("el-form-item",{attrs:{label:"时",prop:"dispatchCycleHour"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择时"},model:{value:e.ruleForm.dispatchCycleHour,callback:function(t){e.$set(e.ruleForm,"dispatchCycleHour",t)},expression:"ruleForm.dispatchCycleHour"}},e._l(24,(function(e){return t("el-option",{key:e-1,attrs:{label:e-1,value:e-1}})})),1)],1),"1"==e.ruleForm.dispatchConfType&&"1"==e.ruleForm.dispatchCycleType&&2==e.ruleForm.dispatchType?t("el-form-item",{staticClass:"branch",attrs:{label:"分",prop:"dispatchCycleMin"}},[t("el-input-number",{staticStyle:{width:"100%"},attrs:{"controls-position":"right",min:0,max:59},model:{value:e.ruleForm.dispatchCycleMin,callback:function(t){e.$set(e.ruleForm,"dispatchCycleMin",t)},expression:"ruleForm.dispatchCycleMin"}})],1):e._e(),"1"==e.ruleForm.dispatchConfType&&"2"==e.ruleForm.dispatchCycleType&&"H"==e.ruleForm.dispatchCycleUnit&&2==e.ruleForm.dispatchType?t("el-form-item",{staticClass:"branch",attrs:{label:"每隔:",prop:"dispatchCycle"}},[t("el-input-number",{staticStyle:{width:"90%"},attrs:{"controls-position":"right",min:30,max:59},on:{change:function(t){e.changePress(t,2)}},model:{value:e.ruleForm.dispatchCycle,callback:function(t){e.$set(e.ruleForm,"dispatchCycle",t)},expression:"ruleForm.dispatchCycle"}}),t("span",{staticStyle:{"margin-left":"20px"}},[e._v("(分)")])],1):e._e(),"1"==e.ruleForm.dispatchConfType&&"2"==e.ruleForm.dispatchCycleType&&"d"==e.ruleForm.dispatchCycleUnit&&2==e.ruleForm.dispatchType?t("el-form-item",{attrs:{label:"每隔:",prop:"dispatchCycle"}},[t("el-select",{staticStyle:{width:"90%"},attrs:{placeholder:"请选择小时"},on:{change:function(t){e.changePress(t,3)}},model:{value:e.ruleForm.dispatchCycle,callback:function(t){e.$set(e.ruleForm,"dispatchCycle",t)},expression:"ruleForm.dispatchCycle"}},e._l(24,(function(e){return t("el-option",{key:e-1,attrs:{label:e-1,value:e-1}})})),1),t("span",{staticStyle:{"margin-left":"20px"}},[e._v("(时)")])],1):e._e(),t("el-form-item",{attrs:{label:"失败自动重跑"}},[t("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:e.ruleForm.dispatchRetryEnable,callback:function(t){e.$set(e.ruleForm,"dispatchRetryEnable",t)},expression:"ruleForm.dispatchRetryEnable"}})],1),1==e.ruleForm.dispatchRetryEnable?t("div",[t("el-form-item",{attrs:{label:"失败自动重跑次数："}},[t("el-input-number",{staticStyle:{width:"100%"},attrs:{"controls-position":"right",min:1,max:10},model:{value:e.ruleForm.dispatchRetryNum,callback:function(t){e.$set(e.ruleForm,"dispatchRetryNum",t)},expression:"ruleForm.dispatchRetryNum"}})],1),t("el-form-item",{attrs:{label:"失败自动重跑间隔："}},[t("el-input-number",{staticStyle:{width:"90%"},attrs:{"controls-position":"right",min:1,max:5},model:{value:e.ruleForm.dispatchRetryInterval,callback:function(t){e.$set(e.ruleForm,"dispatchRetryInterval",t)},expression:"ruleForm.dispatchRetryInterval"}}),t("span",{staticStyle:{"margin-left":"10px"}},[e._v("分钟")])],1)],1):e._e()],1)],1)],1)}),[],!1,null,null,null);t.a=h.exports},"60eb":function(e,t,r){"use strict";r("77c6")},"77c6":function(e,t,r){var l=r("1194");l.__esModule&&(l=l.default),"string"==typeof l&&(l=[[e.i,l,""]]),l.locals&&(e.exports=l.locals);(0,r("499e").default)("6055a1dd",l,!0,{sourceMap:!1,shadowMode:!1})}}]);