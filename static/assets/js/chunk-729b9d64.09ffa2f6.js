(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-729b9d64","chunk-74af32dc"],{"0a49":function(t,e,i){var a=i("9b43"),s=i("626a"),n=i("4bf8"),l=i("9def"),o=i("cd1c");t.exports=function(t,e){var i=1==t,r=2==t,d=3==t,c=4==t,u=6==t,f=5==t||u,p=e||o;return function(e,o,g){for(var v,b,h=n(e),m=s(h),k=a(o,g,3),y=l(m.length),x=0,w=i?p(e,y):r?p(e,0):void 0;y>x;x++)if((f||x in m)&&(b=k(v=m[x],x,h),t))if(i)w[x]=b;else if(b)switch(t){case 3:return!0;case 5:return v;case 6:return x;case 2:w.push(v)}else if(c)return!1;return u?-1:d||c?c:w}}},"1c24":function(t,e,i){"use strict";i("a636")},"1e61":function(t,e,i){(t.exports=i("2350")(!1)).push([t.i,".primary-color{color:#1740dc}.success-color{color:#52c41a}.warning-color{color:#faad14}.error-color{color:#f5222d}.info-color{color:#909399}.border-color{border:1px solid #e5e6e9}.desensitization_switch .inactive{color:#f5222d}.desensitization_switch .el-switch__label{position:absolute;display:none;font-size:12px;color:#fff}.desensitization_switch .el-switch__label--right{z-index:1;right:-8px;top:0}.desensitization_switch .el-switch__label--left{z-index:1;left:24px}.desensitization_switch .el-switch__label.is-active{display:block}.desensitization_switch.el-switch .el-switch__core,.el-switch .el-switch__label{width:70px!important}.desensiitization_input .el-input{width:160px}",""])},"20d6":function(t,e,i){"use strict";var a=i("5ca1"),s=i("0a49")(6),n="findIndex",l=!0;n in[]&&Array(1)[n]((function(){l=!1})),a(a.P+a.F*l,"Array",{findIndex:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}}),i("9c6c")(n)},"35e3":function(t,e,i){"use strict";i.r(e);i("7f7f"),i("8e6e"),i("ac6a"),i("456d"),i("ac4d"),i("8a81"),i("5df3"),i("1c4c"),i("96cf");var a=i("1da1"),s=(i("6b54"),i("20d6"),i("ade3")),n=(i("c5f6"),i("28a5"),i("7514"),i("b056")),l=i("2ef0"),o=i.n(l);function r(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function d(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?r(Object(i),!0).forEach((function(e){Object(s.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function c(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return u(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return u(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var a=0,s=function(){};return{s:s,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,l=!0,o=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return l=t.done,t},e:function(t){o=!0,n=t},f:function(){try{l||null==i.return||i.return()}finally{if(o)throw n}}}}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,a=new Array(e);i<e;i++)a[i]=t[i];return a}var f,p={data:function(){return{btnLoading:!1,tableId:"",isLoading:!1,tableMaskOpen:!1,tableLevelData:{levelIndex:["A","B","C","D","E"]},tableFieldMaskRulesVOS:[],dialogMaskingVisible:!1,notMaskingField:[],activeIndex:-1,maskingType:"",startVal:"",endVal:"",maskingTypeList:[],tableFieldId:"",isAdd:!1,ruleId:"",roleList:[]}},computed:{fieldMaskRulesVOS:function(){var t,e=this,i=JSON.parse(JSON.stringify(this.tableFieldMaskRulesVOS)),a=c(i);try{var s=function(){var i=t.value,a=e.maskingTypeList.find((function(t){return t.id==i.maskType}));if(a){if(8!=i.maskType&&9!=i.maskType||!i.maskValue)i.maskTypeName=a.name;else{var s=i.maskValue.split(",");i.maskTypeName="".concat(a.name,"(区间范围：").concat(s[0]," - ").concat(s[1],")")}i.mask=a,i.id=i.tableFieldId}};for(a.s();!(t=a.n()).done;)s()}catch(t){a.e(t)}finally{a.f()}return i},maskDesc:function(){var t=this,e=this.maskingTypeList.find((function(e){return e.id==t.maskingType}));if(e)return e.desc}},methods:{dataMasking:function(){var t=this;this.isLoading=!0,this.$API.get(this.$URL.dataMasking+"/".concat(this.$route.query.id),{},(function(e){if(t.isLoading=!1,0==e.code){var i=e.data;t.tableId=i.id;var a={tableMaskWhiteList:""!=i.tableMaskWhiteList?i.tableMaskWhiteList.split(",").map(Number):[],allTableLevel:i.allTableLevel};t.tableLevelData=d(d({},t.tableLevelData),a),t.tableMaskOpen=0!=i.tableMaskOpen,t.tableFieldMaskRulesVOS=i.tableFieldMaskRulesVOS}else t.$message.error(e.msg)}))},dataMaskingType:function(){var t=this;this.$API.get(this.$URL.dataMaskingType,{},(function(e){0==e.code?t.maskingTypeList=e.data:t.$message.error(e.msg)}))},notDataMaskingField:function(){var t=this;this.$API.get(this.$URL.notDataMaskingField+"/".concat(this.$route.query.id),{},(function(e){0==e.code?(t.notMaskingField=o.a.differenceBy(e.data,t.tableFieldMaskRulesVOS,"fieldName"),t.dialogMaskingVisible=!0):t.$message.error(e.msg)}))},deleteDataMaskingTableField:function(t){var e=t.row,i=this.fieldMaskRulesVOS.findIndex((function(t){return t.id==e.id}));this.tableFieldMaskRulesVOS.splice(i,1)},updateDataMaskingTableField:function(){var t=this;this.isLoading=!0;var e="";""!=this.startVal&&""!=this.endVal&&(e=this.startVal+","+this.endVal);var i={tableFieldId:this.tableFieldId,maskType:this.maskingType,id:this.ruleId,maskValue:e};this.$API.post(this.$URL.updateDataMaskingTableField,i,(function(e){t.isLoading=!1,0==e.code?(t.dataMasking(),t.dialogMaskingVisible=!1):t.$message.error(e.msg)}))},saveDataMaskingOpenInfo:function(){var t=this;this.btnLoading=!0;var e=this.tableLevelData.tableMaskWhiteList.toString(),i={id:this.tableId||this.$route.query.id,tableMaskOpen:this.tableMaskOpen?1:0,tableMaskWhiteList:e,tableFieldMaskListVO:this.fieldMaskRulesVOS.map((function(t){return{tableFieldId:t.id,maskType:t.mask.id,maskValue:t.maskValue}}))};this.$API.post(this.$URL.saveDataMaskingInfo,i,(function(e){t.isLoading=!1,0==e.code?(t.btnLoading=!1,t.$message.success("保存成功")):(t.btnLoading=!1,t.$message.error(e.msg))}))},saveDataMaskingTableField:function(t){var e,i=this,a=this.maskingTypeList.find((function(t){return i.maskingType==t.id}));if(""!=this.startVal&&""!=this.endVal&&(e=this.startVal+","+this.endVal),"add"==t){var s=this.notMaskingField.find((function(t){return t.id==i.tableFieldId}));this.tableFieldMaskRulesVOS.push(d(d({},s),{},{mask:a,maskValue:e}))}else{this.currentRow.mask=a,this.currentRow.maskType=this.maskingType,this.currentRow=d(d({},this.currentRow),{},{mask:a,maskType:this.maskingType,maskValue:e});var n=this.fieldMaskRulesVOS.findIndex((function(t){return t.id==i.currentRow.id}));this.tableFieldMaskRulesVOS.splice(n,1,this.currentRow)}this.dialogMaskingVisible=!1},editOrAddRule:function(t){if(t){if(this.isAdd=!1,this.tableFieldId=t.tableFieldId,this.maskingType=t.mask.id,this.ruleId=t.id,this.currentRow=t,t.maskValue){var e=t.maskValue.split(",");this.startVal=e[0],this.endVal=e[1]}this.dialogMaskingVisible=!0}else this.isAdd=!0,this.notDataMaskingField()},focusField:function(t,e){this.activeIndex=t,this.tableFieldId=e.id},comfirmAddOrEdi:function(){if(""!=this.maskingType)if(this.isAdd){if(""==this.tableFieldId)return void this.$message.error("未选择字段");this.saveDataMaskingTableField("add")}else this.saveDataMaskingTableField("edit");else this.$message.error("未选择脱敏方式")},dialogClose:function(){this.maskingType="",this.activeIndex=-1,this.tableFieldId="",this.ruleId="",this.startVal="",this.endVal=""},getRoleList:(f=Object(a.a)(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(n.d)();case 2:e=t.sent,this.roleList=e.data.data;case 4:case"end":return t.stop()}}),t,this)}))),function(){return f.apply(this,arguments)})},created:function(){this.dataMasking(),this.dataMaskingType(),this.getRoleList()},watch:{startVal:function(t){t<0&&(this.startVal=0)},endVal:function(t){t<0&&(this.endVal=0)}}},g=(i("1c24"),i("962a"),i("2877")),v=Object(g.a)(p,(function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"check-detail-top it"},[e("div",{staticClass:"top-right",on:{click:function(e){return t.$router.go(-1)}}},[e("i",{staticClass:"el-icon-back"}),t._v("\r\n      返回\r\n    ")]),e("div",{staticClass:"top-left"},[t._v("配置脱敏规则")])]),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],staticClass:"desensitization"},[e("div",[e("div",{staticClass:"titile",staticStyle:{"margin-top":"0"}},[t._v("开启脱敏")]),e("div",{staticStyle:{"padding-left":"12px"}},[e("div",{staticClass:"enable"},[e("el-switch",{staticClass:"desensitization_switch",staticStyle:{display:"block"},attrs:{"active-icon-class":"active","inactive-icon-class":"inactive","active-color":"#13ce66","active-text":"已启用","inactive-text":"已禁用"},model:{value:t.tableMaskOpen,callback:function(e){t.tableMaskOpen=e},expression:"tableMaskOpen"}})],1),e("div",{staticClass:"tips"},[t._v("开启脱敏后，用户在使用数据开发任务、数据预览、数据探索等功能时将按下方配置规则显示脱敏数据")])])]),e("div",[e("div",{staticClass:"titile"},[t._v("白名单")]),e("div",{staticStyle:{"padding-left":"12px"}},[e("div",{staticStyle:{display:"flex","line-height":"40px"}},[e("span",[t._v("角色:")]),e("el-select",{staticStyle:{"margin-left":"20px",width:"60%"},attrs:{multiple:"",clearable:""},model:{value:t.tableLevelData.tableMaskWhiteList,callback:function(e){t.$set(t.tableLevelData,"tableMaskWhiteList",e)},expression:"tableLevelData.tableMaskWhiteList"}},t._l(t.roleList,(function(t){return e("el-option",{key:t.roleId,attrs:{value:t.roleId,label:t.roleName}})})),1)],1),e("div",{staticClass:"tips"},[t._v("用户角色拥有勾选的表密级时，访问此表时显示原始数据。若不勾选，则对所有用户显示脱敏数据。")])])]),e("div",[e("div",{staticClass:"titile"},[t._v("脱敏规则")]),e("div",[e("el-table",{attrs:{"max-height":"350px",size:"mini",data:t.fieldMaskRulesVOS}},[e("el-table-column",{attrs:{label:"字段名",property:"fieldName"}}),e("el-table-column",{attrs:{label:"字段类型",property:"fieldType"}}),e("el-table-column",{attrs:{label:"业务含义",property:"fieldAlias"}}),e("el-table-column",{attrs:{label:"脱敏方式",property:"mask.name"}}),e("el-table-column",{attrs:{"header-align":"right",align:"right",width:"100",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("i",{staticClass:"el-icon-edit",attrs:{title:"编辑"},on:{click:function(e){return t.editOrAddRule(i.row)}}}),e("i",{staticClass:"el-icon-delete",attrs:{title:"删除"},on:{click:function(e){return t.deleteDataMaskingTableField(i)}}})]}}])})],1),e("div",{staticClass:"add_rule"},[e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.editOrAddRule()}}},[t._v("+ 添加脱敏规则")])],1)],1)]),e("div",{staticClass:"save_button"},[e("el-button",{attrs:{type:"primary",loading:t.btnLoading},on:{click:t.saveDataMaskingOpenInfo}},[t._v("保存")])],1),e("el-dialog",{attrs:{title:t.isAdd?"添加脱敏规则":"修改脱敏规则",visible:t.dialogMaskingVisible},on:{"update:visible":function(e){t.dialogMaskingVisible=e},close:t.dialogClose}},[e("div",[t.isAdd?e("div",{staticStyle:{display:"flex"}},[e("span",{staticClass:"tag_name"},[t._v("字段")]),e("ul",{staticClass:"field_box"},t._l(t.notMaskingField,(function(i,a){return e("li",{key:i.id,class:t.activeIndex==a?"active":"",on:{click:function(e){return t.focusField(a,i)}}},[t._v(t._s(i.fieldName))])})),0)]):t._e(),e("div",{staticStyle:{display:"flex","margin-top":"28px"}},[e("span",{staticClass:"tag_name"},[t._v("脱敏方式")]),e("div",{staticClass:"select_out"},[e("el-select",{attrs:{placeholder:"请选择"},model:{value:t.maskingType,callback:function(e){t.maskingType=e},expression:"maskingType"}},t._l(t.maskingTypeList,(function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1)]),e("div",{directives:[{name:"show",rawName:"v-show",value:8==t.maskingType||9==t.maskingType,expression:"maskingType==8||maskingType==9"}],staticStyle:{display:"flex","margin-top":"28px"}},[e("span",{staticClass:"tag_name"},[t._v("脱敏区间")]),e("div",{staticClass:"select_out desensiitization_input"},[e("el-input",{attrs:{type:"number",placeholder:"输入起始位置"},model:{value:t.startVal,callback:function(e){t.startVal=e},expression:"startVal"}}),e("span",{staticStyle:{color:"#dcdfe6",margin:"0 4px"}},[t._v("--")]),e("el-input",{attrs:{type:"number",placeholder:"输入结束位置"},model:{value:t.endVal,callback:function(e){t.endVal=e},expression:"endVal"}})],1)]),e("div"),e("div",{directives:[{name:"show",rawName:"v-show",value:t.maskDesc,expression:"maskDesc"}],staticClass:"mask_desc"},[e("span",{staticStyle:{color:"#f56c6c"}},[t._v("* ")]),t._v(t._s(t.maskDesc))])]),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{size:"mini"},on:{click:function(e){t.dialogMaskingVisible=!1}}},[t._v("取消")]),e("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.comfirmAddOrEdi}},[t._v(t._s(t.isAdd?"确认添加":"确认修改"))])],1)])],1)])}),[],!1,null,"186a09d6",null);e.default=v.exports},7514:function(t,e,i){"use strict";var a=i("5ca1"),s=i("0a49")(5),n=!0;"find"in[]&&Array(1).find((function(){n=!1})),a(a.P+a.F*n,"Array",{find:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}}),i("9c6c")("find")},"962a":function(t,e,i){"use strict";i("fd3f")},"9d29":function(t,e,i){(t.exports=i("2350")(!1)).push([t.i,".primary-color[data-v-186a09d6]{color:#1740dc}.success-color[data-v-186a09d6]{color:#52c41a}.warning-color[data-v-186a09d6]{color:#faad14}.error-color[data-v-186a09d6]{color:#f5222d}.info-color[data-v-186a09d6]{color:#909399}.border-color[data-v-186a09d6]{border:1px solid #e5e6e9}.check-detail-top[data-v-186a09d6]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center;font-size:16px;color:#000;padding:12px 20px;border-bottom:1px solid #e8e8ea;margin-bottom:20px}.check-detail-top .top-right[data-v-186a09d6]{color:#000;cursor:pointer;width:140px}.check-detail-top .top-left[data-v-186a09d6]{font-weight:700;-webkit-box-flex:1;-ms-flex:1;flex:1;text-align:center}.content-header[data-v-186a09d6]{font-size:16px;font-weight:500;line-height:24px;border-bottom:1px solid #e5e6e9;padding:12px 20px;color:#040c2c}.desensitization[data-v-186a09d6]{text-align:left;margin:16px 34px}.desensitization .titile[data-v-186a09d6]{font-weight:700;margin-bottom:14px;margin-top:18px;text-align:left}.desensitization .enable[data-v-186a09d6]{display:inline-block}.desensitization .tips[data-v-186a09d6]{font-size:12px;color:#999;margin-top:8px}.desensitization .add_rule[data-v-186a09d6]{text-align:center;background:#e9e9e9}.desensitization .el-icon-edit[data-v-186a09d6]{color:#1740dc;margin-right:12px;cursor:pointer}.desensitization .el-icon-delete[data-v-186a09d6]{color:#f56c6c;cursor:pointer}.desensitization .save_button[data-v-186a09d6]{text-align:left;margin:16px 0}.desensitization .tag_name[data-v-186a09d6]{width:80px;padding-top:8px}.desensitization .field_box[data-v-186a09d6]{border:1px solid #e9e9e9;height:170px;overflow:auto;background:#fff;-webkit-box-flex:1;-ms-flex:1;flex:1;padding:3px 5px}.desensitization .field_box li[data-v-186a09d6]{padding-bottom:2px;cursor:pointer}.desensitization .field_box li[data-v-186a09d6]:hover{background:#1740dc}.desensitization .field_box li.active[data-v-186a09d6]{background:#999}.desensitization .select_out[data-v-186a09d6]{-webkit-box-flex:1;-ms-flex:1;flex:1}.desensitization .mask_desc[data-v-186a09d6]{padding-left:80px;padding-top:12px;font-size:12px;color:#909399}",""])},a636:function(t,e,i){var a=i("9d29");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,i("499e").default)("64a31710",a,!0,{sourceMap:!1,shadowMode:!1})},b056:function(t,e,i){"use strict";i.d(e,"c",(function(){return n})),i.d(e,"d",(function(){return l})),i.d(e,"e",(function(){return o})),i.d(e,"b",(function(){return r})),i.d(e,"a",(function(){return d}));var a=i("fedb"),s=i("83fe"),n=function(t){return s.a.post(a.a.getLevelList,t)},l=function(){return s.a.get(a.a.getRoleSelectNew)},o=function(t){return s.a.post(a.a.sqlSearchLimitSave,t)},r=function(){return s.a.get(a.a.getExploreDownLoadLimit)},d=function(t){var e=t.id;return s.a.get(a.a.getConnExtInfo+"?id=".concat(e))}},cd1c:function(t,e,i){var a=i("e853");t.exports=function(t,e){return new(a(t))(e)}},e853:function(t,e,i){var a=i("d3f4"),s=i("1169"),n=i("2b4c")("species");t.exports=function(t){var e;return s(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!s(e.prototype)||(e=void 0),a(e)&&null===(e=e[n])&&(e=void 0)),void 0===e?Array:e}},fd3f:function(t,e,i){var a=i("1e61");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,i("499e").default)("1ba27846",a,!0,{sourceMap:!1,shadowMode:!1})}}]);